var Oi=Object.defineProperty;var ti=rt=>{throw TypeError(rt)};var Li=(rt,w,X)=>w in rt?Oi(rt,w,{enumerable:!0,configurable:!0,writable:!0,value:X}):rt[w]=X;var Oe=(rt,w,X)=>Li(rt,typeof w!="symbol"?w+"":w,X),bs=(rt,w,X)=>w.has(rt)||ti("Cannot "+X);var D=(rt,w,X)=>(bs(rt,w,"read from private field"),X?X.call(rt):w.get(rt)),Ht=(rt,w,X)=>w.has(rt)?ti("Cannot add the same private member more than once"):w instanceof WeakSet?w.add(rt):w.set(rt,X),Wt=(rt,w,X,F)=>(bs(rt,w,"write to private field"),F?F.call(rt,X):w.set(rt,X),X),Rt=(rt,w,X)=>(bs(rt,w,"access private method"),X);var Ye=(rt,w,X,F)=>({set _(U){Wt(rt,w,U,X)},get _(){return D(rt,w,F)}});(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const U of document.querySelectorAll('link[rel="modulepreload"]'))F(U);new MutationObserver(U=>{for(const yt of U)if(yt.type==="childList")for(const dt of yt.addedNodes)dt.tagName==="LINK"&&dt.rel==="modulepreload"&&F(dt)}).observe(document,{childList:!0,subtree:!0});function X(U){const yt={};return U.integrity&&(yt.integrity=U.integrity),U.referrerPolicy&&(yt.referrerPolicy=U.referrerPolicy),U.crossOrigin==="use-credentials"?yt.credentials="include":U.crossOrigin==="anonymous"?yt.credentials="omit":yt.credentials="same-origin",yt}function F(U){if(U.ep)return;U.ep=!0;const yt=X(U);fetch(U.href,yt)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$2=globalThis,e$4=t$2.ShadowRoot&&(t$2.ShadyCSS===void 0||t$2.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$2=Symbol(),o$4=new WeakMap;let n$3=class{constructor(w,X,F){if(this._$cssResult$=!0,F!==s$2)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=w,this.t=X}get styleSheet(){let w=this.o;const X=this.t;if(e$4&&w===void 0){const F=X!==void 0&&X.length===1;F&&(w=o$4.get(X)),w===void 0&&((this.o=w=new CSSStyleSheet).replaceSync(this.cssText),F&&o$4.set(X,w))}return w}toString(){return this.cssText}};const r$4=rt=>new n$3(typeof rt=="string"?rt:rt+"",void 0,s$2),i$3=(rt,...w)=>{const X=rt.length===1?rt[0]:w.reduce((F,U,yt)=>F+(dt=>{if(dt._$cssResult$===!0)return dt.cssText;if(typeof dt=="number")return dt;throw Error("Value passed to 'css' function must be a 'css' function result: "+dt+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(U)+rt[yt+1],rt[0]);return new n$3(X,rt,s$2)},S$1=(rt,w)=>{if(e$4)rt.adoptedStyleSheets=w.map(X=>X instanceof CSSStyleSheet?X:X.styleSheet);else for(const X of w){const F=document.createElement("style"),U=t$2.litNonce;U!==void 0&&F.setAttribute("nonce",U),F.textContent=X.cssText,rt.appendChild(F)}},c$2=e$4?rt=>rt:rt=>rt instanceof CSSStyleSheet?(w=>{let X="";for(const F of w.cssRules)X+=F.cssText;return r$4(X)})(rt):rt;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:i$2,defineProperty:e$3,getOwnPropertyDescriptor:h$1,getOwnPropertyNames:r$3,getOwnPropertySymbols:o$3,getPrototypeOf:n$2}=Object,a$1=globalThis,c$1=a$1.trustedTypes,l$1=c$1?c$1.emptyScript:"",p$1=a$1.reactiveElementPolyfillSupport,d$1=(rt,w)=>rt,u$1={toAttribute(rt,w){switch(w){case Boolean:rt=rt?l$1:null;break;case Object:case Array:rt=rt==null?rt:JSON.stringify(rt)}return rt},fromAttribute(rt,w){let X=rt;switch(w){case Boolean:X=rt!==null;break;case Number:X=rt===null?null:Number(rt);break;case Object:case Array:try{X=JSON.parse(rt)}catch{X=null}}return X}},f$1=(rt,w)=>!i$2(rt,w),b={attribute:!0,type:String,converter:u$1,reflect:!1,useDefault:!1,hasChanged:f$1};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),a$1.litPropertyMetadata??(a$1.litPropertyMetadata=new WeakMap);let y$1=class extends HTMLElement{static addInitializer(w){this._$Ei(),(this.l??(this.l=[])).push(w)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(w,X=b){if(X.state&&(X.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(w)&&((X=Object.create(X)).wrapped=!0),this.elementProperties.set(w,X),!X.noAccessor){const F=Symbol(),U=this.getPropertyDescriptor(w,F,X);U!==void 0&&e$3(this.prototype,w,U)}}static getPropertyDescriptor(w,X,F){const{get:U,set:yt}=h$1(this.prototype,w)??{get(){return this[X]},set(dt){this[X]=dt}};return{get:U,set(dt){const Yt=U?.call(this);yt?.call(this,dt),this.requestUpdate(w,Yt,F)},configurable:!0,enumerable:!0}}static getPropertyOptions(w){return this.elementProperties.get(w)??b}static _$Ei(){if(this.hasOwnProperty(d$1("elementProperties")))return;const w=n$2(this);w.finalize(),w.l!==void 0&&(this.l=[...w.l]),this.elementProperties=new Map(w.elementProperties)}static finalize(){if(this.hasOwnProperty(d$1("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d$1("properties"))){const X=this.properties,F=[...r$3(X),...o$3(X)];for(const U of F)this.createProperty(U,X[U])}const w=this[Symbol.metadata];if(w!==null){const X=litPropertyMetadata.get(w);if(X!==void 0)for(const[F,U]of X)this.elementProperties.set(F,U)}this._$Eh=new Map;for(const[X,F]of this.elementProperties){const U=this._$Eu(X,F);U!==void 0&&this._$Eh.set(U,X)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(w){const X=[];if(Array.isArray(w)){const F=new Set(w.flat(1/0).reverse());for(const U of F)X.unshift(c$2(U))}else w!==void 0&&X.push(c$2(w));return X}static _$Eu(w,X){const F=X.attribute;return F===!1?void 0:typeof F=="string"?F:typeof w=="string"?w.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(w=>this.enableUpdating=w),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(w=>w(this))}addController(w){(this._$EO??(this._$EO=new Set)).add(w),this.renderRoot!==void 0&&this.isConnected&&w.hostConnected?.()}removeController(w){this._$EO?.delete(w)}_$E_(){const w=new Map,X=this.constructor.elementProperties;for(const F of X.keys())this.hasOwnProperty(F)&&(w.set(F,this[F]),delete this[F]);w.size>0&&(this._$Ep=w)}createRenderRoot(){const w=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$1(w,this.constructor.elementStyles),w}connectedCallback(){this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),this._$EO?.forEach(w=>w.hostConnected?.())}enableUpdating(w){}disconnectedCallback(){this._$EO?.forEach(w=>w.hostDisconnected?.())}attributeChangedCallback(w,X,F){this._$AK(w,F)}_$ET(w,X){const F=this.constructor.elementProperties.get(w),U=this.constructor._$Eu(w,F);if(U!==void 0&&F.reflect===!0){const yt=(F.converter?.toAttribute!==void 0?F.converter:u$1).toAttribute(X,F.type);this._$Em=w,yt==null?this.removeAttribute(U):this.setAttribute(U,yt),this._$Em=null}}_$AK(w,X){const F=this.constructor,U=F._$Eh.get(w);if(U!==void 0&&this._$Em!==U){const yt=F.getPropertyOptions(U),dt=typeof yt.converter=="function"?{fromAttribute:yt.converter}:yt.converter?.fromAttribute!==void 0?yt.converter:u$1;this._$Em=U;const Yt=dt.fromAttribute(X,yt.type);this[U]=Yt??this._$Ej?.get(U)??Yt,this._$Em=null}}requestUpdate(w,X,F){if(w!==void 0){const U=this.constructor,yt=this[w];if(F??(F=U.getPropertyOptions(w)),!((F.hasChanged??f$1)(yt,X)||F.useDefault&&F.reflect&&yt===this._$Ej?.get(w)&&!this.hasAttribute(U._$Eu(w,F))))return;this.C(w,X,F)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(w,X,{useDefault:F,reflect:U,wrapped:yt},dt){F&&!(this._$Ej??(this._$Ej=new Map)).has(w)&&(this._$Ej.set(w,dt??X??this[w]),yt!==!0||dt!==void 0)||(this._$AL.has(w)||(this.hasUpdated||F||(X=void 0),this._$AL.set(w,X)),U===!0&&this._$Em!==w&&(this._$Eq??(this._$Eq=new Set)).add(w))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(X){Promise.reject(X)}const w=this.scheduleUpdate();return w!=null&&await w,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[U,yt]of this._$Ep)this[U]=yt;this._$Ep=void 0}const F=this.constructor.elementProperties;if(F.size>0)for(const[U,yt]of F){const{wrapped:dt}=yt,Yt=this[U];dt!==!0||this._$AL.has(U)||Yt===void 0||this.C(U,void 0,yt,Yt)}}let w=!1;const X=this._$AL;try{w=this.shouldUpdate(X),w?(this.willUpdate(X),this._$EO?.forEach(F=>F.hostUpdate?.()),this.update(X)):this._$EM()}catch(F){throw w=!1,this._$EM(),F}w&&this._$AE(X)}willUpdate(w){}_$AE(w){this._$EO?.forEach(X=>X.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(w)),this.updated(w)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(w){return!0}update(w){this._$Eq&&(this._$Eq=this._$Eq.forEach(X=>this._$ET(X,this[X]))),this._$EM()}updated(w){}firstUpdated(w){}};y$1.elementStyles=[],y$1.shadowRootOptions={mode:"open"},y$1[d$1("elementProperties")]=new Map,y$1[d$1("finalized")]=new Map,p$1?.({ReactiveElement:y$1}),(a$1.reactiveElementVersions??(a$1.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$1=globalThis,i$1=t$1.trustedTypes,s$1=i$1?i$1.createPolicy("lit-html",{createHTML:rt=>rt}):void 0,e$2="$lit$",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o$2="?"+h,n$1=`<${o$2}>`,r$2=document,l=()=>r$2.createComment(""),c=rt=>rt===null||typeof rt!="object"&&typeof rt!="function",a=Array.isArray,u=rt=>a(rt)||typeof rt?.[Symbol.iterator]=="function",d=`[ 	
\f\r]`,f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),p=/'/g,g=/"/g,$=/^(?:script|style|textarea|title)$/i,y=rt=>(w,...X)=>({_$litType$:rt,strings:w,values:X}),x=y(1),T=Symbol.for("lit-noChange"),E=Symbol.for("lit-nothing"),A=new WeakMap,C=r$2.createTreeWalker(r$2,129);function P(rt,w){if(!a(rt)||!rt.hasOwnProperty("raw"))throw Error("invalid template strings array");return s$1!==void 0?s$1.createHTML(w):w}const V=(rt,w)=>{const X=rt.length-1,F=[];let U,yt=w===2?"<svg>":w===3?"<math>":"",dt=f;for(let Yt=0;Yt<X;Yt++){const At=rt[Yt];let ut,Z,bt=-1,Ct=0;for(;Ct<At.length&&(dt.lastIndex=Ct,Z=dt.exec(At),Z!==null);)Ct=dt.lastIndex,dt===f?Z[1]==="!--"?dt=v:Z[1]!==void 0?dt=_:Z[2]!==void 0?($.test(Z[2])&&(U=RegExp("</"+Z[2],"g")),dt=m):Z[3]!==void 0&&(dt=m):dt===m?Z[0]===">"?(dt=U??f,bt=-1):Z[1]===void 0?bt=-2:(bt=dt.lastIndex-Z[2].length,ut=Z[1],dt=Z[3]===void 0?m:Z[3]==='"'?g:p):dt===g||dt===p?dt=m:dt===v||dt===_?dt=f:(dt=m,U=void 0);const at=dt===m&&rt[Yt+1].startsWith("/>")?" ":"";yt+=dt===f?At+n$1:bt>=0?(F.push(ut),At.slice(0,bt)+e$2+At.slice(bt)+h+at):At+h+(bt===-2?Yt:at)}return[P(rt,yt+(rt[X]||"<?>")+(w===2?"</svg>":w===3?"</math>":"")),F]};class N{constructor({strings:w,_$litType$:X},F){let U;this.parts=[];let yt=0,dt=0;const Yt=w.length-1,At=this.parts,[ut,Z]=V(w,X);if(this.el=N.createElement(ut,F),C.currentNode=this.el.content,X===2||X===3){const bt=this.el.content.firstChild;bt.replaceWith(...bt.childNodes)}for(;(U=C.nextNode())!==null&&At.length<Yt;){if(U.nodeType===1){if(U.hasAttributes())for(const bt of U.getAttributeNames())if(bt.endsWith(e$2)){const Ct=Z[dt++],at=U.getAttribute(bt).split(h),lt=/([.?@])?(.*)/.exec(Ct);At.push({type:1,index:yt,name:lt[2],strings:at,ctor:lt[1]==="."?H:lt[1]==="?"?I:lt[1]==="@"?L:k}),U.removeAttribute(bt)}else bt.startsWith(h)&&(At.push({type:6,index:yt}),U.removeAttribute(bt));if($.test(U.tagName)){const bt=U.textContent.split(h),Ct=bt.length-1;if(Ct>0){U.textContent=i$1?i$1.emptyScript:"";for(let at=0;at<Ct;at++)U.append(bt[at],l()),C.nextNode(),At.push({type:2,index:++yt});U.append(bt[Ct],l())}}}else if(U.nodeType===8)if(U.data===o$2)At.push({type:2,index:yt});else{let bt=-1;for(;(bt=U.data.indexOf(h,bt+1))!==-1;)At.push({type:7,index:yt}),bt+=h.length-1}yt++}}static createElement(w,X){const F=r$2.createElement("template");return F.innerHTML=w,F}}function S(rt,w,X=rt,F){if(w===T)return w;let U=F!==void 0?X._$Co?.[F]:X._$Cl;const yt=c(w)?void 0:w._$litDirective$;return U?.constructor!==yt&&(U?._$AO?.(!1),yt===void 0?U=void 0:(U=new yt(rt),U._$AT(rt,X,F)),F!==void 0?(X._$Co??(X._$Co=[]))[F]=U:X._$Cl=U),U!==void 0&&(w=S(rt,U._$AS(rt,w.values),U,F)),w}class M{constructor(w,X){this._$AV=[],this._$AN=void 0,this._$AD=w,this._$AM=X}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(w){const{el:{content:X},parts:F}=this._$AD,U=(w?.creationScope??r$2).importNode(X,!0);C.currentNode=U;let yt=C.nextNode(),dt=0,Yt=0,At=F[0];for(;At!==void 0;){if(dt===At.index){let ut;At.type===2?ut=new R(yt,yt.nextSibling,this,w):At.type===1?ut=new At.ctor(yt,At.name,At.strings,this,w):At.type===6&&(ut=new z(yt,this,w)),this._$AV.push(ut),At=F[++Yt]}dt!==At?.index&&(yt=C.nextNode(),dt++)}return C.currentNode=r$2,U}p(w){let X=0;for(const F of this._$AV)F!==void 0&&(F.strings!==void 0?(F._$AI(w,F,X),X+=F.strings.length-2):F._$AI(w[X])),X++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(w,X,F,U){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=w,this._$AB=X,this._$AM=F,this.options=U,this._$Cv=U?.isConnected??!0}get parentNode(){let w=this._$AA.parentNode;const X=this._$AM;return X!==void 0&&w?.nodeType===11&&(w=X.parentNode),w}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(w,X=this){w=S(this,w,X),c(w)?w===E||w==null||w===""?(this._$AH!==E&&this._$AR(),this._$AH=E):w!==this._$AH&&w!==T&&this._(w):w._$litType$!==void 0?this.$(w):w.nodeType!==void 0?this.T(w):u(w)?this.k(w):this._(w)}O(w){return this._$AA.parentNode.insertBefore(w,this._$AB)}T(w){this._$AH!==w&&(this._$AR(),this._$AH=this.O(w))}_(w){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=w:this.T(r$2.createTextNode(w)),this._$AH=w}$(w){const{values:X,_$litType$:F}=w,U=typeof F=="number"?this._$AC(w):(F.el===void 0&&(F.el=N.createElement(P(F.h,F.h[0]),this.options)),F);if(this._$AH?._$AD===U)this._$AH.p(X);else{const yt=new M(U,this),dt=yt.u(this.options);yt.p(X),this.T(dt),this._$AH=yt}}_$AC(w){let X=A.get(w.strings);return X===void 0&&A.set(w.strings,X=new N(w)),X}k(w){a(this._$AH)||(this._$AH=[],this._$AR());const X=this._$AH;let F,U=0;for(const yt of w)U===X.length?X.push(F=new R(this.O(l()),this.O(l()),this,this.options)):F=X[U],F._$AI(yt),U++;U<X.length&&(this._$AR(F&&F._$AB.nextSibling,U),X.length=U)}_$AR(w=this._$AA.nextSibling,X){for(this._$AP?.(!1,!0,X);w!==this._$AB;){const F=w.nextSibling;w.remove(),w=F}}setConnected(w){this._$AM===void 0&&(this._$Cv=w,this._$AP?.(w))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(w,X,F,U,yt){this.type=1,this._$AH=E,this._$AN=void 0,this.element=w,this.name=X,this._$AM=U,this.options=yt,F.length>2||F[0]!==""||F[1]!==""?(this._$AH=Array(F.length-1).fill(new String),this.strings=F):this._$AH=E}_$AI(w,X=this,F,U){const yt=this.strings;let dt=!1;if(yt===void 0)w=S(this,w,X,0),dt=!c(w)||w!==this._$AH&&w!==T,dt&&(this._$AH=w);else{const Yt=w;let At,ut;for(w=yt[0],At=0;At<yt.length-1;At++)ut=S(this,Yt[F+At],X,At),ut===T&&(ut=this._$AH[At]),dt||(dt=!c(ut)||ut!==this._$AH[At]),ut===E?w=E:w!==E&&(w+=(ut??"")+yt[At+1]),this._$AH[At]=ut}dt&&!U&&this.j(w)}j(w){w===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,w??"")}}class H extends k{constructor(){super(...arguments),this.type=3}j(w){this.element[this.name]=w===E?void 0:w}}class I extends k{constructor(){super(...arguments),this.type=4}j(w){this.element.toggleAttribute(this.name,!!w&&w!==E)}}class L extends k{constructor(w,X,F,U,yt){super(w,X,F,U,yt),this.type=5}_$AI(w,X=this){if((w=S(this,w,X,0)??E)===T)return;const F=this._$AH,U=w===E&&F!==E||w.capture!==F.capture||w.once!==F.once||w.passive!==F.passive,yt=w!==E&&(F===E||U);U&&this.element.removeEventListener(this.name,this,F),yt&&this.element.addEventListener(this.name,this,w),this._$AH=w}handleEvent(w){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,w):this._$AH.handleEvent(w)}}class z{constructor(w,X,F){this.element=w,this.type=6,this._$AN=void 0,this._$AM=X,this.options=F}get _$AU(){return this._$AM._$AU}_$AI(w){S(this,w)}}const j=t$1.litHtmlPolyfillSupport;j?.(N,R),(t$1.litHtmlVersions??(t$1.litHtmlVersions=[])).push("3.3.1");const B=(rt,w,X)=>{const F=X?.renderBefore??w;let U=F._$litPart$;if(U===void 0){const yt=X?.renderBefore??null;F._$litPart$=U=new R(w.insertBefore(l(),yt),yt,void 0,X??{})}return U._$AI(rt),U};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const s=globalThis;class i extends y$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var X;const w=super.createRenderRoot();return(X=this.renderOptions).renderBefore??(X.renderBefore=w.firstChild),w}update(w){const X=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(w),this._$Do=B(X,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return T}}i._$litElement$=!0,i.finalized=!0,s.litElementHydrateSupport?.({LitElement:i});const o$1=s.litElementPolyfillSupport;o$1?.({LitElement:i});(s.litElementVersions??(s.litElementVersions=[])).push("4.2.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t=rt=>(w,X)=>{X!==void 0?X.addInitializer(()=>{customElements.define(rt,w)}):customElements.define(rt,w)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1},r$1=(rt=o,w,X)=>{const{kind:F,metadata:U}=X;let yt=globalThis.litPropertyMetadata.get(U);if(yt===void 0&&globalThis.litPropertyMetadata.set(U,yt=new Map),F==="setter"&&((rt=Object.create(rt)).wrapped=!0),yt.set(X.name,rt),F==="accessor"){const{name:dt}=X;return{set(Yt){const At=w.get.call(this);w.set.call(this,Yt),this.requestUpdate(dt,At,rt)},init(Yt){return Yt!==void 0&&this.C(dt,void 0,rt,Yt),Yt}}}if(F==="setter"){const{name:dt}=X;return function(Yt){const At=this[dt];w.call(this,Yt),this.requestUpdate(dt,At,rt)}}throw Error("Unsupported decorator location: "+F)};function n(rt){return(w,X)=>typeof X=="object"?r$1(rt,w,X):((F,U,yt)=>{const dt=U.hasOwnProperty(yt);return U.constructor.createProperty(yt,F),dt?Object.getOwnPropertyDescriptor(U,yt):void 0})(rt,w,X)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function r(rt){return n({...rt,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const e$1=(rt,w,X)=>(X.configurable=!0,X.enumerable=!0,Reflect.decorate&&typeof w!="object"&&Object.defineProperty(rt,w,X),X);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function e(rt,w){return(X,F,U)=>{const yt=dt=>dt.renderRoot?.querySelector(rt)??null;return e$1(X,F,{get(){return yt(this)}})}}class ApiError extends Error{constructor(w,X,F){super(w),this.status=X,this.details=F,this.name="ApiError"}}class ApiClient{constructor(){this.baseUrl=""}async createSession(w){const X=new FormData;X.append("file",w);const F=await fetch(`${this.baseUrl}/sessions/new`,{method:"POST",body:X});if(!F.ok)throw new ApiError(`Failed to create session: ${F.statusText}`,F.status);return F.json()}async createSessionFromZotero(w){const X=await fetch(`${this.baseUrl}/sessions/new`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({zotero_key:w})});if(!X.ok)throw new ApiError(`Failed to create session from Zotero: ${X.statusText}`,X.status);return X.json()}async getSession(w){const X=await fetch(`${this.baseUrl}/sessions/${w}`);if(!X.ok)throw new ApiError(`Failed to get session: ${X.statusText}`,X.status);return X.json()}async listSessions(w=50,X=0){const F=await fetch(`${this.baseUrl}/sessions?limit=${w}&offset=${X}`);if(!F.ok)throw new ApiError(`Failed to list sessions: ${F.statusText}`,F.status);return F.json()}async query(w,X){const F=await fetch(`${this.baseUrl}/sessions/${w}/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(!F.ok){const U=await F.json().catch(()=>({}));throw new ApiError(U.detail||`Query failed: ${F.statusText}`,F.status,U)}return F.json()}async toggleFlag(w,X,F){const U=await fetch(`${this.baseUrl}/sessions/${w}/exchanges/${X}/flag`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:F})});if(!U.ok)throw new ApiError(`Failed to toggle flag: ${U.statusText}`,U.status)}async unflag(w,X){const F=await fetch(`${this.baseUrl}/sessions/${w}/exchanges/${X}/flag`,{method:"DELETE"});if(!F.ok)throw new ApiError(`Failed to unflag: ${F.statusText}`,F.status)}async deleteSession(w){const X=await fetch(`${this.baseUrl}/sessions/${w}`,{method:"DELETE"});if(!X.ok)throw new ApiError(`Failed to delete session: ${X.statusText}`,X.status)}async exportSession(w){const X=await fetch(`${this.baseUrl}/sessions/${w}/export`);if(!X.ok)throw new ApiError(`Failed to export session: ${X.statusText}`,X.status);return X.text()}async searchZotero(w,X=20){const F=await fetch(`${this.baseUrl}/zotero/search?query=${encodeURIComponent(w)}&limit=${X}`);if(!F.ok)throw new ApiError(`Zotero search failed: ${F.statusText}`,F.status);return F.json()}async getRecentPapers(w=20){const X=await fetch(`${this.baseUrl}/zotero/recent?limit=${w}`);if(!X.ok)throw new ApiError(`Failed to get recent papers: ${X.statusText}`,X.status);return X.json()}}const api=new ApiClient;function getAugmentedNamespace(rt){if(rt.__esModule)return rt;var w=rt.default;if(typeof w=="function"){var X=function F(){return this instanceof F?Reflect.construct(w,arguments,this.constructor):w.apply(this,arguments)};X.prototype=w.prototype}else X={};return Object.defineProperty(X,"__esModule",{value:!0}),Object.keys(rt).forEach(function(F){var U=Object.getOwnPropertyDescriptor(rt,F);Object.defineProperty(X,F,U.get?U:{enumerable:!0,get:function(){return rt[F]}})}),X}function commonjsRequire(rt){throw new Error('Could not dynamically require "'+rt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports$1){(function(w,X){module.exports=w.pdfjsLib=X()})(globalThis,()=>(()=>{var __webpack_modules__=[,(rt,w)=>{var Fe;Object.defineProperty(w,"__esModule",{value:!0}),w.VerbosityLevel=w.Util=w.UnknownErrorException=w.UnexpectedResponseException=w.TextRenderingMode=w.RenderingIntentFlag=w.PromiseCapability=w.PermissionFlag=w.PasswordResponses=w.PasswordException=w.PageActionEventType=w.OPS=w.MissingPDFException=w.MAX_IMAGE_SIZE_TO_CACHE=w.LINE_FACTOR=w.LINE_DESCENT_FACTOR=w.InvalidPDFException=w.ImageKind=w.IDENTITY_MATRIX=w.FormatError=w.FeatureTest=w.FONT_IDENTITY_MATRIX=w.DocumentActionEventType=w.CMapCompressionType=w.BaseException=w.BASELINE_FACTOR=w.AnnotationType=w.AnnotationReplyType=w.AnnotationPrefix=w.AnnotationMode=w.AnnotationFlag=w.AnnotationFieldFlag=w.AnnotationEditorType=w.AnnotationEditorPrefix=w.AnnotationEditorParamsType=w.AnnotationBorderStyleType=w.AnnotationActionEventType=w.AbortException=void 0,w.assert=Et,w.bytesToString=Qt,w.createValidAbsoluteUrl=Nt,w.getModificationDate=de,w.getUuid=we,w.getVerbosityLevel=Lt,w.info=Bt,w.isArrayBuffer=Ot,w.isArrayEqual=he,w.isNodeJS=void 0,w.normalizeUnicode=be,w.objectFromMap=ae,w.objectSize=ne,w.setVerbosityLevel=Xt,w.shadow=ht,w.string32=se,w.stringToBytes=te,w.stringToPDFString=Zt,w.stringToUTF8String=re,w.unreachable=Vt,w.utf8StringToString=oe,w.warn=Mt;const X=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");w.isNodeJS=X;const F=[1,0,0,1,0,0];w.IDENTITY_MATRIX=F;const U=[.001,0,0,.001,0,0];w.FONT_IDENTITY_MATRIX=U;const yt=1e7;w.MAX_IMAGE_SIZE_TO_CACHE=yt;const dt=1.35;w.LINE_FACTOR=dt;const Yt=.35;w.LINE_DESCENT_FACTOR=Yt;const At=Yt/dt;w.BASELINE_FACTOR=At;const ut={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};w.RenderingIntentFlag=ut;const Z={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};w.AnnotationMode=Z;const bt="pdfjs_internal_editor_";w.AnnotationEditorPrefix=bt;const Ct={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};w.AnnotationEditorType=Ct;const at={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};w.AnnotationEditorParamsType=at;const lt={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};w.PermissionFlag=lt;const gt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};w.TextRenderingMode=gt;const et={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};w.ImageKind=et;const Q={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};w.AnnotationType=Q;const it={GROUP:"Group",REPLY:"R"};w.AnnotationReplyType=it;const xt={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};w.AnnotationFlag=xt;const ot={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};w.AnnotationFieldFlag=ot;const Y={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};w.AnnotationBorderStyleType=Y;const W={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};w.AnnotationActionEventType=W;const O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};w.DocumentActionEventType=O;const nt={O:"PageOpen",C:"PageClose"};w.PageActionEventType=nt;const J={ERRORS:0,WARNINGS:1,INFOS:5};w.VerbosityLevel=J;const Ft={NONE:0,BINARY:1};w.CMapCompressionType=Ft;const K={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};w.OPS=K;const pt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};w.PasswordResponses=pt;let Tt=J.WARNINGS;function Xt(le){Number.isInteger(le)&&(Tt=le)}function Lt(){return Tt}function Bt(le){Tt>=J.INFOS&&console.log(`Info: ${le}`)}function Mt(le){Tt>=J.WARNINGS&&console.log(`Warning: ${le}`)}function Vt(le){throw new Error(le)}function Et(le,Gt){le||Vt(Gt)}function Dt(le){switch(le?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Nt(le,Gt=null,qt=null){if(!le)return null;try{if(qt&&typeof le=="string"&&(qt.addDefaultProtocol&&le.startsWith("www.")&&le.match(/\./g)?.length>=2&&(le=`http://${le}`),qt.tryConvertEncoding))try{le=re(le)}catch{}const me=Gt?new URL(le,Gt):new URL(le);if(Dt(me))return me}catch{}return null}function ht(le,Gt,qt,me=!1){return Object.defineProperty(le,Gt,{value:qt,enumerable:!me,configurable:!0,writable:!1}),qt}const q=function(){function Gt(qt,me){this.constructor===Gt&&Vt("Cannot initialize BaseException."),this.message=qt,this.name=me}return Gt.prototype=new Error,Gt.constructor=Gt,Gt}();w.BaseException=q;class G extends q{constructor(Gt,qt){super(Gt,"PasswordException"),this.code=qt}}w.PasswordException=G;class tt extends q{constructor(Gt,qt){super(Gt,"UnknownErrorException"),this.details=qt}}w.UnknownErrorException=tt;class mt extends q{constructor(Gt){super(Gt,"InvalidPDFException")}}w.InvalidPDFException=mt;class _t extends q{constructor(Gt){super(Gt,"MissingPDFException")}}w.MissingPDFException=_t;class vt extends q{constructor(Gt,qt){super(Gt,"UnexpectedResponseException"),this.status=qt}}w.UnexpectedResponseException=vt;class kt extends q{constructor(Gt){super(Gt,"FormatError")}}w.FormatError=kt;class zt extends q{constructor(Gt){super(Gt,"AbortException")}}w.AbortException=zt;function Qt(le){(typeof le!="object"||le?.length===void 0)&&Vt("Invalid argument for bytesToString");const Gt=le.length,qt=8192;if(Gt<qt)return String.fromCharCode.apply(null,le);const me=[];for(let Me=0;Me<Gt;Me+=qt){const Te=Math.min(Me+qt,Gt),wt=le.subarray(Me,Te);me.push(String.fromCharCode.apply(null,wt))}return me.join("")}function te(le){typeof le!="string"&&Vt("Invalid argument for stringToBytes");const Gt=le.length,qt=new Uint8Array(Gt);for(let me=0;me<Gt;++me)qt[me]=le.charCodeAt(me)&255;return qt}function se(le){return String.fromCharCode(le>>24&255,le>>16&255,le>>8&255,le&255)}function ne(le){return Object.keys(le).length}function ae(le){const Gt=Object.create(null);for(const[qt,me]of le)Gt[qt]=me;return Gt}function $t(){const le=new Uint8Array(4);return le[0]=1,new Uint32Array(le.buffer,0,1)[0]===1}function Ut(){try{return new Function(""),!0}catch{return!1}}class st{static get isLittleEndian(){return ht(this,"isLittleEndian",$t())}static get isEvalSupported(){return ht(this,"isEvalSupported",Ut())}static get isOffscreenCanvasSupported(){return ht(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?ht(this,"platform",{isWin:!1,isMac:!1}):ht(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return ht(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}w.FeatureTest=st;const St=[...Array(256).keys()].map(le=>le.toString(16).padStart(2,"0"));class It{static makeHexColor(Gt,qt,me){return`#${St[Gt]}${St[qt]}${St[me]}`}static scaleMinMax(Gt,qt){let me;Gt[0]?(Gt[0]<0&&(me=qt[0],qt[0]=qt[1],qt[1]=me),qt[0]*=Gt[0],qt[1]*=Gt[0],Gt[3]<0&&(me=qt[2],qt[2]=qt[3],qt[3]=me),qt[2]*=Gt[3],qt[3]*=Gt[3]):(me=qt[0],qt[0]=qt[2],qt[2]=me,me=qt[1],qt[1]=qt[3],qt[3]=me,Gt[1]<0&&(me=qt[2],qt[2]=qt[3],qt[3]=me),qt[2]*=Gt[1],qt[3]*=Gt[1],Gt[2]<0&&(me=qt[0],qt[0]=qt[1],qt[1]=me),qt[0]*=Gt[2],qt[1]*=Gt[2]),qt[0]+=Gt[4],qt[1]+=Gt[4],qt[2]+=Gt[5],qt[3]+=Gt[5]}static transform(Gt,qt){return[Gt[0]*qt[0]+Gt[2]*qt[1],Gt[1]*qt[0]+Gt[3]*qt[1],Gt[0]*qt[2]+Gt[2]*qt[3],Gt[1]*qt[2]+Gt[3]*qt[3],Gt[0]*qt[4]+Gt[2]*qt[5]+Gt[4],Gt[1]*qt[4]+Gt[3]*qt[5]+Gt[5]]}static applyTransform(Gt,qt){const me=Gt[0]*qt[0]+Gt[1]*qt[2]+qt[4],Me=Gt[0]*qt[1]+Gt[1]*qt[3]+qt[5];return[me,Me]}static applyInverseTransform(Gt,qt){const me=qt[0]*qt[3]-qt[1]*qt[2],Me=(Gt[0]*qt[3]-Gt[1]*qt[2]+qt[2]*qt[5]-qt[4]*qt[3])/me,Te=(-Gt[0]*qt[1]+Gt[1]*qt[0]+qt[4]*qt[1]-qt[5]*qt[0])/me;return[Me,Te]}static getAxialAlignedBoundingBox(Gt,qt){const me=this.applyTransform(Gt,qt),Me=this.applyTransform(Gt.slice(2,4),qt),Te=this.applyTransform([Gt[0],Gt[3]],qt),wt=this.applyTransform([Gt[2],Gt[1]],qt);return[Math.min(me[0],Me[0],Te[0],wt[0]),Math.min(me[1],Me[1],Te[1],wt[1]),Math.max(me[0],Me[0],Te[0],wt[0]),Math.max(me[1],Me[1],Te[1],wt[1])]}static inverseTransform(Gt){const qt=Gt[0]*Gt[3]-Gt[1]*Gt[2];return[Gt[3]/qt,-Gt[1]/qt,-Gt[2]/qt,Gt[0]/qt,(Gt[2]*Gt[5]-Gt[4]*Gt[3])/qt,(Gt[4]*Gt[1]-Gt[5]*Gt[0])/qt]}static singularValueDecompose2dScale(Gt){const qt=[Gt[0],Gt[2],Gt[1],Gt[3]],me=Gt[0]*qt[0]+Gt[1]*qt[2],Me=Gt[0]*qt[1]+Gt[1]*qt[3],Te=Gt[2]*qt[0]+Gt[3]*qt[2],wt=Gt[2]*qt[1]+Gt[3]*qt[3],ie=(me+wt)/2,ue=Math.sqrt((me+wt)**2-4*(me*wt-Te*Me))/2,ye=ie+ue||1,ve=ie-ue||1;return[Math.sqrt(ye),Math.sqrt(ve)]}static normalizeRect(Gt){const qt=Gt.slice(0);return Gt[0]>Gt[2]&&(qt[0]=Gt[2],qt[2]=Gt[0]),Gt[1]>Gt[3]&&(qt[1]=Gt[3],qt[3]=Gt[1]),qt}static intersect(Gt,qt){const me=Math.max(Math.min(Gt[0],Gt[2]),Math.min(qt[0],qt[2])),Me=Math.min(Math.max(Gt[0],Gt[2]),Math.max(qt[0],qt[2]));if(me>Me)return null;const Te=Math.max(Math.min(Gt[1],Gt[3]),Math.min(qt[1],qt[3])),wt=Math.min(Math.max(Gt[1],Gt[3]),Math.max(qt[1],qt[3]));return Te>wt?null:[me,Te,Me,wt]}static bezierBoundingBox(Gt,qt,me,Me,Te,wt,ie,ue){const ye=[],ve=[[],[]];let ge,ft,ct,Pt,Kt,Jt,ee,ce;for(let fe=0;fe<2;++fe){if(fe===0?(ft=6*Gt-12*me+6*Te,ge=-3*Gt+9*me-9*Te+3*ie,ct=3*me-3*Gt):(ft=6*qt-12*Me+6*wt,ge=-3*qt+9*Me-9*wt+3*ue,ct=3*Me-3*qt),Math.abs(ge)<1e-12){if(Math.abs(ft)<1e-12)continue;Pt=-ct/ft,0<Pt&&Pt<1&&ye.push(Pt);continue}ee=ft*ft-4*ct*ge,ce=Math.sqrt(ee),!(ee<0)&&(Kt=(-ft+ce)/(2*ge),0<Kt&&Kt<1&&ye.push(Kt),Jt=(-ft-ce)/(2*ge),0<Jt&&Jt<1&&ye.push(Jt))}let pe=ye.length,Se;const Ae=pe;for(;pe--;)Pt=ye[pe],Se=1-Pt,ve[0][pe]=Se*Se*Se*Gt+3*Se*Se*Pt*me+3*Se*Pt*Pt*Te+Pt*Pt*Pt*ie,ve[1][pe]=Se*Se*Se*qt+3*Se*Se*Pt*Me+3*Se*Pt*Pt*wt+Pt*Pt*Pt*ue;return ve[0][Ae]=Gt,ve[1][Ae]=qt,ve[0][Ae+1]=ie,ve[1][Ae+1]=ue,ve[0].length=ve[1].length=Ae+2,[Math.min(...ve[0]),Math.min(...ve[1]),Math.max(...ve[0]),Math.max(...ve[1])]}}w.Util=It;const jt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Zt(le){if(le[0]>="ï"){let qt;if(le[0]==="þ"&&le[1]==="ÿ"?qt="utf-16be":le[0]==="ÿ"&&le[1]==="þ"?qt="utf-16le":le[0]==="ï"&&le[1]==="»"&&le[2]==="¿"&&(qt="utf-8"),qt)try{const me=new TextDecoder(qt,{fatal:!0}),Me=te(le);return me.decode(Me)}catch(me){Mt(`stringToPDFString: "${me}".`)}}const Gt=[];for(let qt=0,me=le.length;qt<me;qt++){const Me=jt[le.charCodeAt(qt)];Gt.push(Me?String.fromCharCode(Me):le.charAt(qt))}return Gt.join("")}function re(le){return decodeURIComponent(escape(le))}function oe(le){return unescape(encodeURIComponent(le))}function Ot(le){return typeof le=="object"&&le?.byteLength!==void 0}function he(le,Gt){if(le.length!==Gt.length)return!1;for(let qt=0,me=le.length;qt<me;qt++)if(le[qt]!==Gt[qt])return!1;return!0}function de(le=new Date){return[le.getUTCFullYear().toString(),(le.getUTCMonth()+1).toString().padStart(2,"0"),le.getUTCDate().toString().padStart(2,"0"),le.getUTCHours().toString().padStart(2,"0"),le.getUTCMinutes().toString().padStart(2,"0"),le.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ce{constructor(){Ht(this,Fe,!1);this.promise=new Promise((Gt,qt)=>{this.resolve=me=>{Wt(this,Fe,!0),Gt(me)},this.reject=me=>{Wt(this,Fe,!0),qt(me)}})}get settled(){return D(this,Fe)}}Fe=new WeakMap,w.PromiseCapability=Ce;let xe=null,Re=null;function be(le){return xe||(xe=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Re=new Map([["ﬅ","ſt"]])),le.replaceAll(xe,(Gt,qt,me)=>qt?qt.normalize("NFKC"):Re.get(me))}function we(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const le=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(le);else for(let Gt=0;Gt<32;Gt++)le[Gt]=Math.floor(Math.random()*255);return Qt(le)}const ke="pdfjs_internal_id_";w.AnnotationPrefix=ke},(__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{var rt,X,F,U,He,is,Yt,At,ut,Z,bt,Ct,at,lt,ns,et,Q,_s,xt,ot;Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(W){if(typeof W=="string"||W instanceof URL?W={url:W}:(0,_util.isArrayBuffer)(W)&&(W={data:W}),typeof W!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!W.url&&!W.data&&!W.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const O=new PDFDocumentLoadingTask,{docId:nt}=O,J=W.url?getUrlProp(W.url):null,Ft=W.data?getDataProp(W.data):null,K=W.httpHeaders||null,pt=W.withCredentials===!0,Tt=W.password??null,Xt=W.range instanceof PDFDataRangeTransport?W.range:null,Lt=Number.isInteger(W.rangeChunkSize)&&W.rangeChunkSize>0?W.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Bt=W.worker instanceof PDFWorker?W.worker:null;const Mt=W.verbosity,Vt=typeof W.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(W.docBaseUrl)?W.docBaseUrl:null,Et=typeof W.cMapUrl=="string"?W.cMapUrl:null,Dt=W.cMapPacked!==!1,Nt=W.CMapReaderFactory||DefaultCMapReaderFactory,ht=typeof W.standardFontDataUrl=="string"?W.standardFontDataUrl:null,q=W.StandardFontDataFactory||DefaultStandardFontDataFactory,G=W.stopAtErrors!==!0,tt=Number.isInteger(W.maxImageSize)&&W.maxImageSize>-1?W.maxImageSize:-1,mt=W.isEvalSupported!==!1,_t=typeof W.isOffscreenCanvasSupported=="boolean"?W.isOffscreenCanvasSupported:!_util.isNodeJS,vt=Number.isInteger(W.canvasMaxAreaInBytes)?W.canvasMaxAreaInBytes:-1,kt=typeof W.disableFontFace=="boolean"?W.disableFontFace:_util.isNodeJS,zt=W.fontExtraProperties===!0,Qt=W.enableXfa===!0,te=W.ownerDocument||globalThis.document,se=W.disableRange===!0,ne=W.disableStream===!0,ae=W.disableAutoFetch===!0,$t=W.pdfBug===!0,Ut=Xt?Xt.length:W.length??NaN,st=typeof W.useSystemFonts=="boolean"?W.useSystemFonts:!_util.isNodeJS&&!kt,St=typeof W.useWorkerFetch=="boolean"?W.useWorkerFetch:Nt===_display_utils.DOMCMapReaderFactory&&q===_display_utils.DOMStandardFontDataFactory&&Et&&ht&&(0,_display_utils.isValidFetchUrl)(Et,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ht,document.baseURI),It=W.canvasFactory||new DefaultCanvasFactory({ownerDocument:te}),jt=W.filterFactory||new DefaultFilterFactory({docId:nt,ownerDocument:te}),Zt=null;(0,_util.setVerbosityLevel)(Mt);const re={canvasFactory:It,filterFactory:jt};if(St||(re.cMapReaderFactory=new Nt({baseUrl:Et,isCompressed:Dt}),re.standardFontDataFactory=new q({baseUrl:ht})),!Bt){const he={verbosity:Mt,port:_worker_options.GlobalWorkerOptions.workerPort};Bt=he.port?PDFWorker.fromPort(he):new PDFWorker(he),O._worker=Bt}const oe={docId:nt,apiVersion:"3.11.174",data:Ft,password:Tt,disableAutoFetch:ae,rangeChunkSize:Lt,length:Ut,docBaseUrl:Vt,enableXfa:Qt,evaluatorOptions:{maxImageSize:tt,disableFontFace:kt,ignoreErrors:G,isEvalSupported:mt,isOffscreenCanvasSupported:_t,canvasMaxAreaInBytes:vt,fontExtraProperties:zt,useSystemFonts:st,cMapUrl:St?Et:null,standardFontDataUrl:St?ht:null}},Ot={ignoreErrors:G,isEvalSupported:mt,disableFontFace:kt,fontExtraProperties:zt,enableXfa:Qt,ownerDocument:te,disableAutoFetch:ae,pdfBug:$t,styleElement:Zt};return Bt.promise.then(function(){if(O.destroyed)throw new Error("Loading aborted");const he=_fetchDocument(Bt,oe),de=new Promise(function(Ce){let xe;Xt?xe=new _transport_stream.PDFDataTransportStream({length:Ut,initialData:Xt.initialData,progressiveDone:Xt.progressiveDone,contentDispositionFilename:Xt.contentDispositionFilename,disableRange:se,disableStream:ne},Xt):Ft||(xe=(be=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(be):(0,_display_utils.isValidFetchUrl)(be.url)?new _displayFetch_stream.PDFFetchStream(be):new _displayNetwork.PDFNetworkStream(be))({url:J,length:Ut,httpHeaders:K,withCredentials:pt,rangeChunkSize:Lt,disableRange:se,disableStream:ne})),Ce(xe)});return Promise.all([he,de]).then(function([Ce,xe]){if(O.destroyed)throw new Error("Loading aborted");const Re=new _message_handler.MessageHandler(nt,Ce,Bt.port),be=new WorkerTransport(Re,O,xe,Ot,re);O._transport=be,Re.send("Ready",null)})}).catch(O._capability.reject),O}async function _fetchDocument(W,O){if(W.destroyed)throw new Error("Worker was destroyed");const nt=await W.messageHandler.sendWithPromise("GetDocRequest",O,O.data?[O.data.buffer]:null);if(W.destroyed)throw new Error("Worker was destroyed");return nt}function getUrlProp(W){if(W instanceof URL)return W.href;try{return new URL(W,window.location).href}catch{if(_util.isNodeJS&&typeof W=="string")return W}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(W){if(_util.isNodeJS&&typeof Buffer<"u"&&W instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(W instanceof Uint8Array&&W.byteLength===W.buffer.byteLength)return W;if(typeof W=="string")return(0,_util.stringToBytes)(W);if(typeof W=="object"&&!isNaN(W?.length)||(0,_util.isArrayBuffer)(W))return new Uint8Array(W);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const w=class w{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Ye(w,rt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(O){throw this._worker?.port&&delete this._worker._pendingDestroy,O}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};rt=new WeakMap,Ht(w,rt,0);let PDFDocumentLoadingTask=w;exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(O,nt,J=!1,Ft=null){this.length=O,this.initialData=nt,this.progressiveDone=J,this.contentDispositionFilename=Ft,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(O){this._rangeListeners.push(O)}addProgressListener(O){this._progressListeners.push(O)}addProgressiveReadListener(O){this._progressiveReadListeners.push(O)}addProgressiveDoneListener(O){this._progressiveDoneListeners.push(O)}onDataRange(O,nt){for(const J of this._rangeListeners)J(O,nt)}onDataProgress(O,nt){this._readyCapability.promise.then(()=>{for(const J of this._progressListeners)J(O,nt)})}onDataProgressiveRead(O){this._readyCapability.promise.then(()=>{for(const nt of this._progressiveReadListeners)nt(O)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const O of this._progressiveDoneListeners)O()})}transportReady(){this._readyCapability.resolve()}requestDataRange(O,nt){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(O,nt){this._pdfInfo=O,this._transport=nt,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(J=>{if(!J)return J;const Ft=[];for(const K in J)Ft.push(...J[K]);return Ft}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(O){return this._transport.getPage(O)}getPageIndex(O){return this._transport.getPageIndex(O)}getDestinations(){return this._transport.getDestinations()}getDestination(O){return this._transport.getDestination(O)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(O=!1){return this._transport.startCleanup(O||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(O,nt,J,Ft=!1){Ht(this,U);Ht(this,X,null);Ht(this,F,!1);this._pageIndex=O,this._pageInfo=nt,this._transport=J,this._stats=Ft?new _display_utils.StatTimer:null,this._pdfBug=Ft,this.commonObjs=J.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:O,rotation:nt=this.rotate,offsetX:J=0,offsetY:Ft=0,dontFlip:K=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:O,rotation:nt,offsetX:J,offsetY:Ft,dontFlip:K})}getAnnotations({intent:O="display"}={}){const nt=this._transport.getRenderingIntent(O);return this._transport.getAnnotations(this._pageIndex,nt.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:O,viewport:nt,intent:J="display",annotationMode:Ft=_util.AnnotationMode.ENABLE,transform:K=null,background:pt=null,optionalContentConfigPromise:Tt=null,annotationCanvasMap:Xt=null,pageColors:Lt=null,printAnnotationStorage:Bt=null}){this._stats?.time("Overall");const Mt=this._transport.getRenderingIntent(J,Ft,Bt);Wt(this,F,!1),Rt(this,U,is).call(this),Tt||(Tt=this._transport.getOptionalContentConfig());let Vt=this._intentStates.get(Mt.cacheKey);Vt||(Vt=Object.create(null),this._intentStates.set(Mt.cacheKey,Vt)),Vt.streamReaderCancelTimeout&&(clearTimeout(Vt.streamReaderCancelTimeout),Vt.streamReaderCancelTimeout=null);const Et=!!(Mt.renderingIntent&_util.RenderingIntentFlag.PRINT);Vt.displayReadyCapability||(Vt.displayReadyCapability=new _util.PromiseCapability,Vt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(Mt));const Dt=q=>{Vt.renderTasks.delete(Nt),(this._maybeCleanupAfterRender||Et)&&Wt(this,F,!0),Rt(this,U,He).call(this,!Et),q?(Nt.capability.reject(q),this._abortOperatorList({intentState:Vt,reason:q instanceof Error?q:new Error(q)})):Nt.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},Nt=new InternalRenderTask({callback:Dt,params:{canvasContext:O,viewport:nt,transform:K,background:pt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Xt,operatorList:Vt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Et,pdfBug:this._pdfBug,pageColors:Lt});(Vt.renderTasks||(Vt.renderTasks=new Set)).add(Nt);const ht=Nt.task;return Promise.all([Vt.displayReadyCapability.promise,Tt]).then(([q,G])=>{if(this.destroyed){Dt();return}this._stats?.time("Rendering"),Nt.initializeGraphics({transparency:q,optionalContentConfig:G}),Nt.operatorListChanged()}).catch(Dt),ht}getOperatorList({intent:O="display",annotationMode:nt=_util.AnnotationMode.ENABLE,printAnnotationStorage:J=null}={}){function Ft(){pt.operatorList.lastChunk&&(pt.opListReadCapability.resolve(pt.operatorList),pt.renderTasks.delete(Tt))}const K=this._transport.getRenderingIntent(O,nt,J,!0);let pt=this._intentStates.get(K.cacheKey);pt||(pt=Object.create(null),this._intentStates.set(K.cacheKey,pt));let Tt;return pt.opListReadCapability||(Tt=Object.create(null),Tt.operatorListChanged=Ft,pt.opListReadCapability=new _util.PromiseCapability,(pt.renderTasks||(pt.renderTasks=new Set)).add(Tt),pt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(K)),pt.opListReadCapability.promise}streamTextContent({includeMarkedContent:O=!1,disableNormalization:nt=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:O===!0,disableNormalization:nt===!0},{highWaterMark:100,size(Ft){return Ft.items.length}})}getTextContent(O={}){if(this._transport._htmlForXfa)return this.getXfa().then(J=>_xfa_text.XfaText.textContent(J));const nt=this.streamTextContent(O);return new Promise(function(J,Ft){function K(){pt.read().then(function({value:Xt,done:Lt}){if(Lt){J(Tt);return}Object.assign(Tt.styles,Xt.styles),Tt.items.push(...Xt.items),K()},Ft)}const pt=nt.getReader(),Tt={items:[],styles:Object.create(null)};K()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const O=[];for(const nt of this._intentStates.values())if(this._abortOperatorList({intentState:nt,reason:new Error("Page was destroyed."),force:!0}),!nt.opListReadCapability)for(const J of nt.renderTasks)O.push(J.completed),J.cancel();return this.objs.clear(),Wt(this,F,!1),Rt(this,U,is).call(this),Promise.all(O)}cleanup(O=!1){Wt(this,F,!0);const nt=Rt(this,U,He).call(this,!1);return O&&nt&&this._stats&&(this._stats=new _display_utils.StatTimer),nt}_startRenderPage(O,nt){const J=this._intentStates.get(nt);J&&(this._stats?.timeEnd("Page Request"),J.displayReadyCapability?.resolve(O))}_renderPageChunk(O,nt){for(let J=0,Ft=O.length;J<Ft;J++)nt.operatorList.fnArray.push(O.fnArray[J]),nt.operatorList.argsArray.push(O.argsArray[J]);nt.operatorList.lastChunk=O.lastChunk,nt.operatorList.separateAnnots=O.separateAnnots;for(const J of nt.renderTasks)J.operatorListChanged();O.lastChunk&&Rt(this,U,He).call(this,!0)}_pumpOperatorList({renderingIntent:O,cacheKey:nt,annotationStorageSerializable:J}){const{map:Ft,transfers:K}=J,Tt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:O,cacheKey:nt,annotationStorage:Ft},K).getReader(),Xt=this._intentStates.get(nt);Xt.streamReader=Tt;const Lt=()=>{Tt.read().then(({value:Bt,done:Mt})=>{if(Mt){Xt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Bt,Xt),Lt())},Bt=>{if(Xt.streamReader=null,!this._transport.destroyed){if(Xt.operatorList){Xt.operatorList.lastChunk=!0;for(const Mt of Xt.renderTasks)Mt.operatorListChanged();Rt(this,U,He).call(this,!0)}if(Xt.displayReadyCapability)Xt.displayReadyCapability.reject(Bt);else if(Xt.opListReadCapability)Xt.opListReadCapability.reject(Bt);else throw Bt}})};Lt()}_abortOperatorList({intentState:O,reason:nt,force:J=!1}){if(O.streamReader){if(O.streamReaderCancelTimeout&&(clearTimeout(O.streamReaderCancelTimeout),O.streamReaderCancelTimeout=null),!J){if(O.renderTasks.size>0)return;if(nt instanceof _display_utils.RenderingCancelledException){let Ft=RENDERING_CANCELLED_TIMEOUT;nt.extraDelay>0&&nt.extraDelay<1e3&&(Ft+=nt.extraDelay),O.streamReaderCancelTimeout=setTimeout(()=>{O.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:O,reason:nt,force:!0})},Ft);return}}if(O.streamReader.cancel(new _util.AbortException(nt.message)).catch(()=>{}),O.streamReader=null,!this._transport.destroyed){for(const[Ft,K]of this._intentStates)if(K===O){this._intentStates.delete(Ft);break}this.cleanup()}}}get stats(){return this._stats}}X=new WeakMap,F=new WeakMap,U=new WeakSet,He=function(O=!1){if(Rt(this,U,is).call(this),!D(this,F)||this.destroyed)return!1;if(O)return Wt(this,X,setTimeout(()=>{Wt(this,X,null),Rt(this,U,He).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:nt,operatorList:J}of this._intentStates.values())if(nt.size>0||!J.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Wt(this,F,!1),!0},is=function(){D(this,X)&&(clearTimeout(D(this,X)),Wt(this,X,null))},exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Ht(this,Yt,new Set);Ht(this,At,Promise.resolve())}postMessage(O,nt){const J={data:structuredClone(O,nt?{transfer:nt}:null)};D(this,At).then(()=>{for(const Ft of D(this,Yt))Ft.call(this,J)})}addEventListener(O,nt){D(this,Yt).add(nt)}removeEventListener(O,nt){D(this,Yt).delete(nt)}terminate(){D(this,Yt).clear()}}Yt=new WeakMap,At=new WeakMap,exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const W=document?.currentScript?.src;W&&(PDFWorkerUtil.fallbackWorkerSrc=W.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(W,O){let nt;try{if(nt=new URL(W),!nt.origin||nt.origin==="null")return!1}catch{return!1}const J=new URL(O,nt);return nt.origin===J.origin},PDFWorkerUtil.createCDNWrapper=function(W){const O=`importScripts("${W}");`;return URL.createObjectURL(new Blob([O]))}}const _PDFWorker=class _PDFWorker{constructor({name:W=null,port:O=null,verbosity:nt=(0,_util.getVerbosityLevel)()}={}){if(this.name=W,this.destroyed=!1,this.verbosity=nt,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,O){if(D(_PDFWorker,ut)?.has(O))throw new Error("Cannot use more than one PDFWorker per port.");(D(_PDFWorker,ut)||Wt(_PDFWorker,ut,new WeakMap)).set(O,this),this._initializeFromPort(O);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(W){this._port=W,this._messageHandler=new _message_handler.MessageHandler("main","worker",W),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:W}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,W)||(W=PDFWorkerUtil.createCDNWrapper(new URL(W,window.location).href));const O=new Worker(W),nt=new _message_handler.MessageHandler("main","worker",O),J=()=>{O.removeEventListener("error",Ft),nt.destroy(),O.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Ft=()=>{this._webWorker||J()};O.addEventListener("error",Ft),nt.on("test",pt=>{if(O.removeEventListener("error",Ft),this.destroyed){J();return}pt?(this._messageHandler=nt,this._port=O,this._webWorker=O,this._readyCapability.resolve(),nt.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),nt.destroy(),O.terminate())}),nt.on("ready",pt=>{if(O.removeEventListener("error",Ft),this.destroyed){J();return}try{K()}catch{this._setupFakeWorker()}});const K=()=>{const pt=new Uint8Array;nt.send("test",pt,[pt.buffer])};K();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(W=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const O=new LoopbackPort;this._port=O;const nt=`fake${PDFWorkerUtil.fakeWorkerId++}`,J=new _message_handler.MessageHandler(nt+"_worker",nt,O);W.setup(J,O);const Ft=new _message_handler.MessageHandler(nt,nt+"_worker",O);this._messageHandler=Ft,this._readyCapability.resolve(),Ft.send("configure",{verbosity:this.verbosity})}).catch(W=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${W.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),D(_PDFWorker,ut)?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(W){if(!W?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const O=D(this,ut)?.get(W.port);if(O){if(O._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return O}return new _PDFWorker(W)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};ut=new WeakMap,Ht(_PDFWorker,ut);let PDFWorker=_PDFWorker;exports$1.PDFWorker=PDFWorker;class WorkerTransport{constructor(O,nt,J,Ft,K){Ht(this,lt);Ht(this,Z,new Map);Ht(this,bt,new Map);Ht(this,Ct,new Map);Ht(this,at,null);this.messageHandler=O,this.loadingTask=nt,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Ft.ownerDocument,styleElement:Ft.styleElement}),this._params=Ft,this.canvasFactory=K.canvasFactory,this.filterFactory=K.filterFactory,this.cMapReaderFactory=K.cMapReaderFactory,this.standardFontDataFactory=K.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=J,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(O,nt=_util.AnnotationMode.ENABLE,J=null,Ft=!1){let K=_util.RenderingIntentFlag.DISPLAY,pt=_annotation_storage.SerializableEmpty;switch(O){case"any":K=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":K=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${O}`)}switch(nt){case _util.AnnotationMode.DISABLE:K+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:K+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:K+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,pt=(K&_util.RenderingIntentFlag.PRINT&&J instanceof _annotation_storage.PrintAnnotationStorage?J:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${nt}`)}return Ft&&(K+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:K,cacheKey:`${K}_${pt.hash}`,annotationStorageSerializable:pt}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,D(this,at)?.reject(new Error("Worker was destroyed during onPassword callback"));const O=[];for(const J of D(this,bt).values())O.push(J._destroy());D(this,bt).clear(),D(this,Ct).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const nt=this.messageHandler.sendWithPromise("Terminate",null);return O.push(nt),Promise.all(O).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),D(this,Z).clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:O,loadingTask:nt}=this;O.on("GetReader",(J,Ft)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=K=>{this._lastProgress={loaded:K.loaded,total:K.total}},Ft.onPull=()=>{this._fullReader.read().then(function({value:K,done:pt}){if(pt){Ft.close();return}(0,_util.assert)(K instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Ft.enqueue(new Uint8Array(K),1,[K])}).catch(K=>{Ft.error(K)})},Ft.onCancel=K=>{this._fullReader.cancel(K),Ft.ready.catch(pt=>{if(!this.destroyed)throw pt})}}),O.on("ReaderHeadersReady",J=>{const Ft=new _util.PromiseCapability,K=this._fullReader;return K.headersReady.then(()=>{(!K.isStreamingSupported||!K.isRangeSupported)&&(this._lastProgress&&nt.onProgress?.(this._lastProgress),K.onProgress=pt=>{nt.onProgress?.({loaded:pt.loaded,total:pt.total})}),Ft.resolve({isStreamingSupported:K.isStreamingSupported,isRangeSupported:K.isRangeSupported,contentLength:K.contentLength})},Ft.reject),Ft.promise}),O.on("GetRangeReader",(J,Ft)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const K=this._networkStream.getRangeReader(J.begin,J.end);if(!K){Ft.close();return}Ft.onPull=()=>{K.read().then(function({value:pt,done:Tt}){if(Tt){Ft.close();return}(0,_util.assert)(pt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Ft.enqueue(new Uint8Array(pt),1,[pt])}).catch(pt=>{Ft.error(pt)})},Ft.onCancel=pt=>{K.cancel(pt),Ft.ready.catch(Tt=>{if(!this.destroyed)throw Tt})}}),O.on("GetDoc",({pdfInfo:J})=>{this._numPages=J.numPages,this._htmlForXfa=J.htmlForXfa,delete J.htmlForXfa,nt._capability.resolve(new PDFDocumentProxy(J,this))}),O.on("DocException",function(J){let Ft;switch(J.name){case"PasswordException":Ft=new _util.PasswordException(J.message,J.code);break;case"InvalidPDFException":Ft=new _util.InvalidPDFException(J.message);break;case"MissingPDFException":Ft=new _util.MissingPDFException(J.message);break;case"UnexpectedResponseException":Ft=new _util.UnexpectedResponseException(J.message,J.status);break;case"UnknownErrorException":Ft=new _util.UnknownErrorException(J.message,J.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}nt._capability.reject(Ft)}),O.on("PasswordRequest",J=>{if(Wt(this,at,new _util.PromiseCapability),nt.onPassword){const Ft=K=>{K instanceof Error?D(this,at).reject(K):D(this,at).resolve({password:K})};try{nt.onPassword(Ft,J.code)}catch(K){D(this,at).reject(K)}}else D(this,at).reject(new _util.PasswordException(J.message,J.code));return D(this,at).promise}),O.on("DataLoaded",J=>{nt.onProgress?.({loaded:J.length,total:J.length}),this.downloadInfoCapability.resolve(J)}),O.on("StartRenderPage",J=>{if(this.destroyed)return;D(this,bt).get(J.pageIndex)._startRenderPage(J.transparency,J.cacheKey)}),O.on("commonobj",([J,Ft,K])=>{if(!this.destroyed&&!this.commonObjs.has(J))switch(Ft){case"Font":const pt=this._params;if("error"in K){const Lt=K.error;(0,_util.warn)(`Error during font loading: ${Lt}`),this.commonObjs.resolve(J,Lt);break}const Tt=pt.pdfBug&&globalThis.FontInspector?.enabled?(Lt,Bt)=>globalThis.FontInspector.fontAdded(Lt,Bt):null,Xt=new _font_loader.FontFaceObject(K,{isEvalSupported:pt.isEvalSupported,disableFontFace:pt.disableFontFace,ignoreErrors:pt.ignoreErrors,inspectFont:Tt});this.fontLoader.bind(Xt).catch(Lt=>O.sendWithPromise("FontFallback",{id:J})).finally(()=>{!pt.fontExtraProperties&&Xt.data&&(Xt.data=null),this.commonObjs.resolve(J,Xt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(J,K);break;default:throw new Error(`Got unknown common object type ${Ft}`)}}),O.on("obj",([J,Ft,K,pt])=>{if(this.destroyed)return;const Tt=D(this,bt).get(Ft);if(!Tt.objs.has(J))switch(K){case"Image":if(Tt.objs.resolve(J,pt),pt){let Xt;if(pt.bitmap){const{width:Lt,height:Bt}=pt;Xt=Lt*Bt*4}else Xt=pt.data?.length||0;Xt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Tt._maybeCleanupAfterRender=!0)}break;case"Pattern":Tt.objs.resolve(J,pt);break;default:throw new Error(`Got unknown object type ${K}`)}}),O.on("DocProgress",J=>{this.destroyed||nt.onProgress?.({loaded:J.loaded,total:J.total})}),O.on("FetchBuiltInCMap",J=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(J):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),O.on("FetchStandardFontData",J=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(J):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:O,transfers:nt}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:O,filename:this._fullReader?.filename??null},nt).finally(()=>{this.annotationStorage.resetModified()})}getPage(O){if(!Number.isInteger(O)||O<=0||O>this._numPages)return Promise.reject(new Error("Invalid page request."));const nt=O-1,J=D(this,Ct).get(nt);if(J)return J;const Ft=this.messageHandler.sendWithPromise("GetPage",{pageIndex:nt}).then(K=>{if(this.destroyed)throw new Error("Transport destroyed");const pt=new PDFPageProxy(nt,K,this,this._params.pdfBug);return D(this,bt).set(nt,pt),pt});return D(this,Ct).set(nt,Ft),Ft}getPageIndex(O){return typeof O!="object"||O===null||!Number.isInteger(O.num)||O.num<0||!Number.isInteger(O.gen)||O.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:O.num,gen:O.gen})}getAnnotations(O,nt){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:O,intent:nt})}getFieldObjects(){return Rt(this,lt,ns).call(this,"GetFieldObjects")}hasJSActions(){return Rt(this,lt,ns).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(O){return typeof O!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:O})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Rt(this,lt,ns).call(this,"GetDocJSActions")}getPageJSActions(O){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:O})}getStructTree(O){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:O})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(O=>new _optional_content_config.OptionalContentConfig(O))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const O="GetMetadata",nt=D(this,Z).get(O);if(nt)return nt;const J=this.messageHandler.sendWithPromise(O,null).then(Ft=>({info:Ft[0],metadata:Ft[1]?new _metadata.Metadata(Ft[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return D(this,Z).set(O,J),J}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(O=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const nt of D(this,bt).values())if(!nt.cleanup())throw new Error(`startCleanup: Page ${nt.pageNumber} is currently rendering.`);this.commonObjs.clear(),O||this.fontLoader.clear(),D(this,Z).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:O,enableXfa:nt}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:O,enableXfa:nt})}}Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakMap,lt=new WeakSet,ns=function(O,nt=null){const J=D(this,Z).get(O);if(J)return J;const Ft=this.messageHandler.sendWithPromise(O,nt);return D(this,Z).set(O,Ft),Ft};class PDFObjects{constructor(){Ht(this,Q);Ht(this,et,Object.create(null))}get(O,nt=null){if(nt){const Ft=Rt(this,Q,_s).call(this,O);return Ft.capability.promise.then(()=>nt(Ft.data)),null}const J=D(this,et)[O];if(!J?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${O}.`);return J.data}has(O){return D(this,et)[O]?.capability.settled||!1}resolve(O,nt=null){const J=Rt(this,Q,_s).call(this,O);J.data=nt,J.capability.resolve()}clear(){for(const O in D(this,et)){const{data:nt}=D(this,et)[O];nt?.bitmap?.close()}Wt(this,et,Object.create(null))}}et=new WeakMap,Q=new WeakSet,_s=function(O){var nt;return(nt=D(this,et))[O]||(nt[O]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(O){Ht(this,xt,null);Wt(this,xt,O),this.onContinue=null}get promise(){return D(this,xt).capability.promise}cancel(O=0){D(this,xt).cancel(null,O)}get separateAnnots(){const{separateAnnots:O}=D(this,xt).operatorList;if(!O)return!1;const{annotationCanvasMap:nt}=D(this,xt);return O.form||O.canvas&&nt?.size>0}}xt=new WeakMap,exports$1.RenderTask=RenderTask;const Y=class Y{constructor({callback:O,params:nt,objs:J,commonObjs:Ft,annotationCanvasMap:K,operatorList:pt,pageIndex:Tt,canvasFactory:Xt,filterFactory:Lt,useRequestAnimationFrame:Bt=!1,pdfBug:Mt=!1,pageColors:Vt=null}){this.callback=O,this.params=nt,this.objs=J,this.commonObjs=Ft,this.annotationCanvasMap=K,this.operatorListIdx=null,this.operatorList=pt,this._pageIndex=Tt,this.canvasFactory=Xt,this.filterFactory=Lt,this._pdfBug=Mt,this.pageColors=Vt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Bt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=nt.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:O=!1,optionalContentConfig:nt}){if(this.cancelled)return;if(this._canvas){if(D(Y,ot).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");D(Y,ot).add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:J,viewport:Ft,transform:K,background:pt}=this.params;this.gfx=new _canvas.CanvasGraphics(J,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:nt},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:K,viewport:Ft,transparency:O,background:pt}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(O=null,nt=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),D(Y,ot).delete(this._canvas),this.callback(O||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,nt))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),D(Y,ot).delete(this._canvas),this.callback())))}};ot=new WeakMap,Ht(Y,ot,new WeakSet);let InternalRenderTask=Y;const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build},(rt,w,X)=>{var ut,Z,bt,ei,at;Object.defineProperty(w,"__esModule",{value:!0}),w.SerializableEmpty=w.PrintAnnotationStorage=w.AnnotationStorage=void 0;var F=X(1),U=X(4),yt=X(8);const dt=Object.freeze({map:null,hash:"",transfers:void 0});w.SerializableEmpty=dt;class Yt{constructor(){Ht(this,bt);Ht(this,ut,!1);Ht(this,Z,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(gt,et){const Q=D(this,Z).get(gt);return Q===void 0?et:Object.assign(et,Q)}getRawValue(gt){return D(this,Z).get(gt)}remove(gt){if(D(this,Z).delete(gt),D(this,Z).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const et of D(this,Z).values())if(et instanceof U.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(gt,et){const Q=D(this,Z).get(gt);let it=!1;if(Q!==void 0)for(const[xt,ot]of Object.entries(et))Q[xt]!==ot&&(it=!0,Q[xt]=ot);else it=!0,D(this,Z).set(gt,et);it&&Rt(this,bt,ei).call(this),et instanceof U.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(et.constructor._type)}has(gt){return D(this,Z).has(gt)}getAll(){return D(this,Z).size>0?(0,F.objectFromMap)(D(this,Z)):null}setAll(gt){for(const[et,Q]of Object.entries(gt))this.setValue(et,Q)}get size(){return D(this,Z).size}resetModified(){D(this,ut)&&(Wt(this,ut,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new At(this)}get serializable(){if(D(this,Z).size===0)return dt;const gt=new Map,et=new yt.MurmurHash3_64,Q=[],it=Object.create(null);let xt=!1;for(const[ot,Y]of D(this,Z)){const W=Y instanceof U.AnnotationEditor?Y.serialize(!1,it):Y;W&&(gt.set(ot,W),et.update(`${ot}:${JSON.stringify(W)}`),xt||(xt=!!W.bitmap))}if(xt)for(const ot of gt.values())ot.bitmap&&Q.push(ot.bitmap);return gt.size>0?{map:gt,hash:et.hexdigest(),transfers:Q}:dt}}ut=new WeakMap,Z=new WeakMap,bt=new WeakSet,ei=function(){D(this,ut)||(Wt(this,ut,!0),typeof this.onSetModified=="function"&&this.onSetModified())},w.AnnotationStorage=Yt;class At extends Yt{constructor(et){super();Ht(this,at);const{map:Q,hash:it,transfers:xt}=et.serializable,ot=structuredClone(Q,xt?{transfer:xt}:null);Wt(this,at,{map:ot,hash:it,transfers:xt})}get print(){(0,F.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return D(this,at)}}at=new WeakMap,w.PrintAnnotationStorage=At},(rt,w,X)=>{var At,ut,Z,bt,Ct,at,lt,gt,et,Q,it,xt,ot,Y,W,ys,As,J,vs,Ss,si,ii,ni,Es,ri;Object.defineProperty(w,"__esModule",{value:!0}),w.AnnotationEditor=void 0;var F=X(5),U=X(1),yt=X(6);const Mt=class Mt{constructor(Et){Ht(this,W);Ht(this,At,"");Ht(this,ut,!1);Ht(this,Z,null);Ht(this,bt,null);Ht(this,Ct,null);Ht(this,at,!1);Ht(this,lt,null);Ht(this,gt,this.focusin.bind(this));Ht(this,et,this.focusout.bind(this));Ht(this,Q,!1);Ht(this,it,!1);Ht(this,xt,!1);Oe(this,"_initialOptions",Object.create(null));Oe(this,"_uiManager",null);Oe(this,"_focusEventsAllowed",!0);Oe(this,"_l10nPromise",null);Ht(this,ot,!1);Ht(this,Y,Mt._zIndex++);this.constructor===Mt&&(0,U.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Et.parent,this.id=Et.id,this.width=this.height=null,this.pageIndex=Et.parent.pageIndex,this.name=Et.name,this.div=null,this._uiManager=Et.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Et.isCentered,this._structTreeParentId=null;const{rotation:Dt,rawDims:{pageWidth:Nt,pageHeight:ht,pageX:q,pageY:G}}=this.parent.viewport;this.rotation=Dt,this.pageRotation=(360+Dt-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Nt,ht],this.pageTranslation=[q,G];const[tt,mt]=this.parentDimensions;this.x=Et.x/tt,this.y=Et.y/mt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,U.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Et){const Dt=new Yt({id:Et.parent.getNextId(),parent:Et.parent,uiManager:Et._uiManager});Dt.annotationElementId=Et.annotationElementId,Dt.deleted=!0,Dt._uiManager.addToAnnotationStorage(Dt)}static initialize(Et,Dt=null){if(Mt._l10nPromise||(Mt._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(ht=>[ht,Et.get(ht)]))),Dt?.strings)for(const ht of Dt.strings)Mt._l10nPromise.set(ht,Et.get(ht));if(Mt._borderLineWidth!==-1)return;const Nt=getComputedStyle(document.documentElement);Mt._borderLineWidth=parseFloat(Nt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Et,Dt){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Et){return!1}static paste(Et,Dt){(0,U.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return D(this,ot)}set _isDraggable(Et){Wt(this,ot,Et),this.div?.classList.toggle("draggable",Et)}center(){const[Et,Dt]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Dt/(Et*2),this.y+=this.width*Et/(Dt*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Dt/(Et*2),this.y-=this.width*Et/(Dt*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Et){this._uiManager.addCommands(Et)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=D(this,Y)}setParent(Et){Et!==null&&(this.pageIndex=Et.pageIndex,this.pageDimensions=Et.pageDimensions),this.parent=Et}focusin(Et){this._focusEventsAllowed&&(D(this,Q)?Wt(this,Q,!1):this.parent.setSelected(this))}focusout(Et){!this._focusEventsAllowed||!this.isAttachedToDOM||Et.relatedTarget?.closest(`#${this.id}`)||(Et.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Et,Dt,Nt,ht){const[q,G]=this.parentDimensions;[Nt,ht]=this.screenToPageTranslation(Nt,ht),this.x=(Et+Nt)/q,this.y=(Dt+ht)/G,this.fixAndSetPosition()}translate(Et,Dt){Rt(this,W,ys).call(this,this.parentDimensions,Et,Dt)}translateInPage(Et,Dt){Rt(this,W,ys).call(this,this.pageDimensions,Et,Dt),this.div.scrollIntoView({block:"nearest"})}drag(Et,Dt){const[Nt,ht]=this.parentDimensions;if(this.x+=Et/Nt,this.y+=Dt/ht,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:_t,y:vt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,_t,vt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:q,y:G}=this;const[tt,mt]=Rt(this,W,As).call(this);q+=tt,G+=mt,this.div.style.left=`${(100*q).toFixed(2)}%`,this.div.style.top=`${(100*G).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[Et,Dt]=this.pageDimensions;let{x:Nt,y:ht,width:q,height:G}=this;switch(q*=Et,G*=Dt,Nt*=Et,ht*=Dt,this.rotation){case 0:Nt=Math.max(0,Math.min(Et-q,Nt)),ht=Math.max(0,Math.min(Dt-G,ht));break;case 90:Nt=Math.max(0,Math.min(Et-G,Nt)),ht=Math.min(Dt,Math.max(q,ht));break;case 180:Nt=Math.min(Et,Math.max(q,Nt)),ht=Math.min(Dt,Math.max(G,ht));break;case 270:Nt=Math.min(Et,Math.max(G,Nt)),ht=Math.max(0,Math.min(Dt-q,ht));break}this.x=Nt/=Et,this.y=ht/=Dt;const[tt,mt]=Rt(this,W,As).call(this);Nt+=tt,ht+=mt;const{style:_t}=this.div;_t.left=`${(100*Nt).toFixed(2)}%`,_t.top=`${(100*ht).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Et,Dt){var Nt;return Rt(Nt=Mt,J,vs).call(Nt,Et,Dt,this.parentRotation)}pageTranslationToScreen(Et,Dt){var Nt;return Rt(Nt=Mt,J,vs).call(Nt,Et,Dt,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Et,pageDimensions:[Dt,Nt]}=this,ht=Dt*Et,q=Nt*Et;return U.FeatureTest.isCSSRoundSupported?[Math.round(ht),Math.round(q)]:[ht,q]}setDims(Et,Dt){const[Nt,ht]=this.parentDimensions;this.div.style.width=`${(100*Et/Nt).toFixed(2)}%`,D(this,at)||(this.div.style.height=`${(100*Dt/ht).toFixed(2)}%`),D(this,Z)?.classList.toggle("small",Et<Mt.SMALL_EDITOR_SIZE||Dt<Mt.SMALL_EDITOR_SIZE)}fixDims(){const{style:Et}=this.div,{height:Dt,width:Nt}=Et,ht=Nt.endsWith("%"),q=!D(this,at)&&Dt.endsWith("%");if(ht&&q)return;const[G,tt]=this.parentDimensions;ht||(Et.width=`${(100*parseFloat(Nt)/G).toFixed(2)}%`),!D(this,at)&&!q&&(Et.height=`${(100*parseFloat(Dt)/tt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(D(this,Z))return;const Et=Wt(this,Z,document.createElement("button"));Et.className="altText";const Dt=await Mt._l10nPromise.get("editor_alt_text_button_label");Et.textContent=Dt,Et.setAttribute("aria-label",Dt),Et.tabIndex="0",Et.addEventListener("contextmenu",yt.noContextMenu),Et.addEventListener("pointerdown",Nt=>Nt.stopPropagation()),Et.addEventListener("click",Nt=>{Nt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Et.addEventListener("keydown",Nt=>{Nt.target===Et&&Nt.key==="Enter"&&(Nt.preventDefault(),this._uiManager.editAltText(this))}),Rt(this,W,Es).call(this),this.div.append(Et),Mt.SMALL_EDITOR_SIZE||(Mt.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Et.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:D(this,At),decorative:D(this,ut)}}set altTextData({altText:Et,decorative:Dt}){D(this,At)===Et&&D(this,ut)===Dt||(Wt(this,At,Et),Wt(this,ut,Dt),Rt(this,W,Es).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",D(this,gt)),this.div.addEventListener("focusout",D(this,et));const[Et,Dt]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Dt/Et).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Et/Dt).toFixed(2)}%`);const[Nt,ht]=this.getInitialTranslation();return this.translate(Nt,ht),(0,F.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Et){const{isMac:Dt}=U.FeatureTest.platform;if(Et.button!==0||Et.ctrlKey&&Dt){Et.preventDefault();return}Wt(this,Q,!0),Rt(this,W,ri).call(this,Et)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(Et,Dt,Nt){Et.changeParent(this),this.x=Dt,this.y=Nt,this.fixAndSetPosition()}getRect(Et,Dt){const Nt=this.parentScale,[ht,q]=this.pageDimensions,[G,tt]=this.pageTranslation,mt=Et/Nt,_t=Dt/Nt,vt=this.x*ht,kt=this.y*q,zt=this.width*ht,Qt=this.height*q;switch(this.rotation){case 0:return[vt+mt+G,q-kt-_t-Qt+tt,vt+mt+zt+G,q-kt-_t+tt];case 90:return[vt+_t+G,q-kt+mt+tt,vt+_t+Qt+G,q-kt+mt+zt+tt];case 180:return[vt-mt-zt+G,q-kt+_t+tt,vt-mt+G,q-kt+_t+Qt+tt];case 270:return[vt-_t-Qt+G,q-kt-mt-zt+tt,vt-_t+G,q-kt-mt+tt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Et,Dt){const[Nt,ht,q,G]=Et,tt=q-Nt,mt=G-ht;switch(this.rotation){case 0:return[Nt,Dt-G,tt,mt];case 90:return[Nt,Dt-ht,mt,tt];case 180:return[q,Dt-ht,tt,mt];case 270:return[q,Dt-G,mt,tt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Wt(this,xt,!0)}disableEditMode(){Wt(this,xt,!1)}isInEditMode(){return D(this,xt)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",D(this,gt)),this.div?.addEventListener("focusout",D(this,et))}serialize(Et=!1,Dt=null){(0,U.unreachable)("An editor must be serializable")}static deserialize(Et,Dt,Nt){const ht=new this.prototype.constructor({parent:Dt,id:Dt.getNextId(),uiManager:Nt});ht.rotation=Et.rotation;const[q,G]=ht.pageDimensions,[tt,mt,_t,vt]=ht.getRectInCurrentCoords(Et.rect,G);return ht.x=tt/q,ht.y=mt/G,ht.width=_t/q,ht.height=vt/G,ht}remove(){this.div.removeEventListener("focusin",D(this,gt)),this.div.removeEventListener("focusout",D(this,et)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),D(this,Z)?.remove(),Wt(this,Z,null),Wt(this,bt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Rt(this,W,si).call(this),D(this,lt).classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){D(this,lt)?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Et,Dt){}disableEditing(){D(this,Z)&&(D(this,Z).hidden=!0)}enableEditing(){D(this,Z)&&(D(this,Z).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return D(this,it)}set isEditing(Et){Wt(this,it,Et),this.parent&&(Et?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Et,Dt){Wt(this,at,!0);const Nt=Et/Dt,{style:ht}=this.div;ht.aspectRatio=Nt,ht.height="auto"}static get MIN_SIZE(){return 16}};At=new WeakMap,ut=new WeakMap,Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakMap,lt=new WeakMap,gt=new WeakMap,et=new WeakMap,Q=new WeakMap,it=new WeakMap,xt=new WeakMap,ot=new WeakMap,Y=new WeakMap,W=new WeakSet,ys=function([Et,Dt],Nt,ht){[Nt,ht]=this.screenToPageTranslation(Nt,ht),this.x+=Nt/Et,this.y+=ht/Dt,this.fixAndSetPosition()},As=function(){const[Et,Dt]=this.parentDimensions,{_borderLineWidth:Nt}=Mt,ht=Nt/Et,q=Nt/Dt;switch(this.rotation){case 90:return[-ht,q];case 180:return[ht,q];case 270:return[ht,-q];default:return[-ht,-q]}},J=new WeakSet,vs=function(Et,Dt,Nt){switch(Nt){case 90:return[Dt,-Et];case 180:return[-Et,-Dt];case 270:return[-Dt,Et];default:return[Et,Dt]}},Ss=function(Et){switch(Et){case 90:{const[Dt,Nt]=this.pageDimensions;return[0,-Dt/Nt,Nt/Dt,0]}case 180:return[-1,0,0,-1];case 270:{const[Dt,Nt]=this.pageDimensions;return[0,Dt/Nt,-Nt/Dt,0]}default:return[1,0,0,1]}},si=function(){if(D(this,lt))return;Wt(this,lt,document.createElement("div")),D(this,lt).classList.add("resizers");const Et=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Et.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Dt of Et){const Nt=document.createElement("div");D(this,lt).append(Nt),Nt.classList.add("resizer",Dt),Nt.addEventListener("pointerdown",Rt(this,W,ii).bind(this,Dt)),Nt.addEventListener("contextmenu",yt.noContextMenu)}this.div.prepend(D(this,lt))},ii=function(Et,Dt){Dt.preventDefault();const{isMac:Nt}=U.FeatureTest.platform;if(Dt.button!==0||Dt.ctrlKey&&Nt)return;const ht=Rt(this,W,ni).bind(this,Et),q=this._isDraggable;this._isDraggable=!1;const G={passive:!0,capture:!0};window.addEventListener("pointermove",ht,G);const tt=this.x,mt=this.y,_t=this.width,vt=this.height,kt=this.parent.div.style.cursor,zt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Dt.target).cursor;const Qt=()=>{this._isDraggable=q,window.removeEventListener("pointerup",Qt),window.removeEventListener("blur",Qt),window.removeEventListener("pointermove",ht,G),this.parent.div.style.cursor=kt,this.div.style.cursor=zt;const te=this.x,se=this.y,ne=this.width,ae=this.height;te===tt&&se===mt&&ne===_t&&ae===vt||this.addCommands({cmd:()=>{this.width=ne,this.height=ae,this.x=te,this.y=se;const[$t,Ut]=this.parentDimensions;this.setDims($t*ne,Ut*ae),this.fixAndSetPosition()},undo:()=>{this.width=_t,this.height=vt,this.x=tt,this.y=mt;const[$t,Ut]=this.parentDimensions;this.setDims($t*_t,Ut*vt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Qt),window.addEventListener("blur",Qt)},ni=function(Et,Dt){const[Nt,ht]=this.parentDimensions,q=this.x,G=this.y,tt=this.width,mt=this.height,_t=Mt.MIN_SIZE/Nt,vt=Mt.MIN_SIZE/ht,kt=be=>Math.round(be*1e4)/1e4,zt=Rt(this,W,Ss).call(this,this.rotation),Qt=(be,we)=>[zt[0]*be+zt[2]*we,zt[1]*be+zt[3]*we],te=Rt(this,W,Ss).call(this,360-this.rotation),se=(be,we)=>[te[0]*be+te[2]*we,te[1]*be+te[3]*we];let ne,ae,$t=!1,Ut=!1;switch(Et){case"topLeft":$t=!0,ne=(be,we)=>[0,0],ae=(be,we)=>[be,we];break;case"topMiddle":ne=(be,we)=>[be/2,0],ae=(be,we)=>[be/2,we];break;case"topRight":$t=!0,ne=(be,we)=>[be,0],ae=(be,we)=>[0,we];break;case"middleRight":Ut=!0,ne=(be,we)=>[be,we/2],ae=(be,we)=>[0,we/2];break;case"bottomRight":$t=!0,ne=(be,we)=>[be,we],ae=(be,we)=>[0,0];break;case"bottomMiddle":ne=(be,we)=>[be/2,we],ae=(be,we)=>[be/2,0];break;case"bottomLeft":$t=!0,ne=(be,we)=>[0,we],ae=(be,we)=>[be,0];break;case"middleLeft":Ut=!0,ne=(be,we)=>[0,we/2],ae=(be,we)=>[be,we/2];break}const st=ne(tt,mt),St=ae(tt,mt);let It=Qt(...St);const jt=kt(q+It[0]),Zt=kt(G+It[1]);let re=1,oe=1,[Ot,he]=this.screenToPageTranslation(Dt.movementX,Dt.movementY);if([Ot,he]=se(Ot/Nt,he/ht),$t){const be=Math.hypot(tt,mt);re=oe=Math.max(Math.min(Math.hypot(St[0]-st[0]-Ot,St[1]-st[1]-he)/be,1/tt,1/mt),_t/tt,vt/mt)}else Ut?re=Math.max(_t,Math.min(1,Math.abs(St[0]-st[0]-Ot)))/tt:oe=Math.max(vt,Math.min(1,Math.abs(St[1]-st[1]-he)))/mt;const de=kt(tt*re),Ce=kt(mt*oe);It=Qt(...ae(de,Ce));const xe=jt-It[0],Re=Zt-It[1];this.width=de,this.height=Ce,this.x=xe,this.y=Re,this.setDims(Nt*de,ht*Ce),this.fixAndSetPosition()},Es=async function(){const Et=D(this,Z);if(!Et)return;if(!D(this,At)&&!D(this,ut)){Et.classList.remove("done"),D(this,bt)?.remove();return}Mt._l10nPromise.get("editor_alt_text_edit_button_label").then(Nt=>{Et.setAttribute("aria-label",Nt)});let Dt=D(this,bt);if(!Dt){Wt(this,bt,Dt=document.createElement("span")),Dt.className="tooltip",Dt.setAttribute("role","tooltip");const Nt=Dt.id=`alt-text-tooltip-${this.id}`;Et.setAttribute("aria-describedby",Nt);const ht=100;Et.addEventListener("mouseenter",()=>{Wt(this,Ct,setTimeout(()=>{Wt(this,Ct,null),D(this,bt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},ht))}),Et.addEventListener("mouseleave",()=>{clearTimeout(D(this,Ct)),Wt(this,Ct,null),D(this,bt)?.classList.remove("show")})}Et.classList.add("done"),Dt.innerText=D(this,ut)?await Mt._l10nPromise.get("editor_alt_text_decorative_tooltip"):D(this,At),Dt.parentNode||Et.append(Dt)},ri=function(Et){if(!this._isDraggable)return;const Dt=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Nt,ht;Dt&&(Nt={passive:!0,capture:!0},ht=G=>{const[tt,mt]=this.screenToPageTranslation(G.movementX,G.movementY);this._uiManager.dragSelectedEditors(tt,mt)},window.addEventListener("pointermove",ht,Nt));const q=()=>{if(window.removeEventListener("pointerup",q),window.removeEventListener("blur",q),Dt&&window.removeEventListener("pointermove",ht,Nt),Wt(this,Q,!1),!this._uiManager.endDragSession()){const{isMac:G}=U.FeatureTest.platform;Et.ctrlKey&&!G||Et.shiftKey||Et.metaKey&&G?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",q),window.addEventListener("blur",q)},Ht(Mt,J),Oe(Mt,"_borderLineWidth",-1),Oe(Mt,"_colorManager",new F.ColorManager),Oe(Mt,"_zIndex",1),Oe(Mt,"SMALL_EDITOR_SIZE",0);let dt=Mt;w.AnnotationEditor=dt;class Yt extends dt{constructor(Et){super(Et),this.annotationElementId=Et.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(rt,w,X)=>{var at,lt,gt,et,Q,xs,ot,Y,W,O,nt,ai,K,pt,Tt,Xt,Lt,Bt,Mt,Vt,Et,Dt,Nt,ht,q,G,tt,mt,_t,vt,kt,zt,Qt,te,se,ne,ae,$t,Ut,st,St,It,jt,Zt,re,oe,Ot,oi,ws,Cs,rs,Ts,Ps,$e,Ke,li,ci,ks,Je,Ms;Object.defineProperty(w,"__esModule",{value:!0}),w.KeyboardManager=w.CommandManager=w.ColorManager=w.AnnotationEditorUIManager=void 0,w.bindEvents=yt,w.opacityToHex=dt;var F=X(1),U=X(6);function yt(Te,wt,ie){for(const ue of ie)wt.addEventListener(ue,Te[ue].bind(Te))}function dt(Te){return Math.round(Math.min(255,Math.max(1,255*Te))).toString(16).padStart(2,"0")}class Yt{constructor(){Ht(this,at,0)}getId(){return`${F.AnnotationEditorPrefix}${Ye(this,at)._++}`}}at=new WeakMap;const xt=class xt{constructor(){Ht(this,Q);Ht(this,lt,(0,F.getUuid)());Ht(this,gt,0);Ht(this,et,null)}static get _isSVGFittingCanvas(){const wt='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',ue=new OffscreenCanvas(1,3).getContext("2d"),ye=new Image;ye.src=wt;const ve=ye.decode().then(()=>(ue.drawImage(ye,0,0,1,1,0,0,1,3),new Uint32Array(ue.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,F.shadow)(this,"_isSVGFittingCanvas",ve)}async getFromFile(wt){const{lastModified:ie,name:ue,size:ye,type:ve}=wt;return Rt(this,Q,xs).call(this,`${ie}_${ue}_${ye}_${ve}`,wt)}async getFromUrl(wt){return Rt(this,Q,xs).call(this,wt,wt)}async getFromId(wt){D(this,et)||Wt(this,et,new Map);const ie=D(this,et).get(wt);return ie?ie.bitmap?(ie.refCounter+=1,ie):ie.file?this.getFromFile(ie.file):this.getFromUrl(ie.url):null}getSvgUrl(wt){const ie=D(this,et).get(wt);return ie?.isSvg?ie.svgUrl:null}deleteId(wt){D(this,et)||Wt(this,et,new Map);const ie=D(this,et).get(wt);ie&&(ie.refCounter-=1,ie.refCounter===0&&(ie.bitmap=null))}isValidId(wt){return wt.startsWith(`image_${D(this,lt)}_`)}};lt=new WeakMap,gt=new WeakMap,et=new WeakMap,Q=new WeakSet,xs=async function(wt,ie){D(this,et)||Wt(this,et,new Map);let ue=D(this,et).get(wt);if(ue===null)return null;if(ue?.bitmap)return ue.refCounter+=1,ue;try{ue||(ue={bitmap:null,id:`image_${D(this,lt)}_${Ye(this,gt)._++}`,refCounter:0,isSvg:!1});let ye;if(typeof ie=="string"){ue.url=ie;const ve=await fetch(ie);if(!ve.ok)throw new Error(ve.statusText);ye=await ve.blob()}else ye=ue.file=ie;if(ye.type==="image/svg+xml"){const ve=xt._isSVGFittingCanvas,ge=new FileReader,ft=new Image,ct=new Promise((Pt,Kt)=>{ft.onload=()=>{ue.bitmap=ft,ue.isSvg=!0,Pt()},ge.onload=async()=>{const Jt=ue.svgUrl=ge.result;ft.src=await ve?`${Jt}#svgView(preserveAspectRatio(none))`:Jt},ft.onerror=ge.onerror=Kt});ge.readAsDataURL(ye),await ct}else ue.bitmap=await createImageBitmap(ye);ue.refCounter=1}catch(ye){console.error(ye),ue=null}return D(this,et).set(wt,ue),ue&&D(this,et).set(ue.id,ue),ue};let At=xt;class ut{constructor(wt=128){Ht(this,ot,[]);Ht(this,Y,!1);Ht(this,W);Ht(this,O,-1);Wt(this,W,wt)}add({cmd:wt,undo:ie,mustExec:ue,type:ye=NaN,overwriteIfSameType:ve=!1,keepUndo:ge=!1}){if(ue&&wt(),D(this,Y))return;const ft={cmd:wt,undo:ie,type:ye};if(D(this,O)===-1){D(this,ot).length>0&&(D(this,ot).length=0),Wt(this,O,0),D(this,ot).push(ft);return}if(ve&&D(this,ot)[D(this,O)].type===ye){ge&&(ft.undo=D(this,ot)[D(this,O)].undo),D(this,ot)[D(this,O)]=ft;return}const ct=D(this,O)+1;ct===D(this,W)?D(this,ot).splice(0,1):(Wt(this,O,ct),ct<D(this,ot).length&&D(this,ot).splice(ct)),D(this,ot).push(ft)}undo(){D(this,O)!==-1&&(Wt(this,Y,!0),D(this,ot)[D(this,O)].undo(),Wt(this,Y,!1),Wt(this,O,D(this,O)-1))}redo(){D(this,O)<D(this,ot).length-1&&(Wt(this,O,D(this,O)+1),Wt(this,Y,!0),D(this,ot)[D(this,O)].cmd(),Wt(this,Y,!1))}hasSomethingToUndo(){return D(this,O)!==-1}hasSomethingToRedo(){return D(this,O)<D(this,ot).length-1}destroy(){Wt(this,ot,null)}}ot=new WeakMap,Y=new WeakMap,W=new WeakMap,O=new WeakMap,w.CommandManager=ut;class Z{constructor(wt){Ht(this,nt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ie}=F.FeatureTest.platform;for(const[ue,ye,ve={}]of wt)for(const ge of ue){const ft=ge.startsWith("mac+");ie&&ft?(this.callbacks.set(ge.slice(4),{callback:ye,options:ve}),this.allKeys.add(ge.split("+").at(-1))):!ie&&!ft&&(this.callbacks.set(ge,{callback:ye,options:ve}),this.allKeys.add(ge.split("+").at(-1)))}}exec(wt,ie){if(!this.allKeys.has(ie.key))return;const ue=this.callbacks.get(Rt(this,nt,ai).call(this,ie));if(!ue)return;const{callback:ye,options:{bubbles:ve=!1,args:ge=[],checker:ft=null}}=ue;ft&&!ft(wt,ie)||(ye.bind(wt,...ge)(),ve||(ie.stopPropagation(),ie.preventDefault()))}}nt=new WeakSet,ai=function(wt){wt.altKey&&this.buffer.push("alt"),wt.ctrlKey&&this.buffer.push("ctrl"),wt.metaKey&&this.buffer.push("meta"),wt.shiftKey&&this.buffer.push("shift"),this.buffer.push(wt.key);const ie=this.buffer.join("+");return this.buffer.length=0,ie},w.KeyboardManager=Z;const Ft=class Ft{get _colors(){const wt=new Map([["CanvasText",null],["Canvas",null]]);return(0,U.getColorValues)(wt),(0,F.shadow)(this,"_colors",wt)}convert(wt){const ie=(0,U.getRGB)(wt);if(!window.matchMedia("(forced-colors: active)").matches)return ie;for(const[ue,ye]of this._colors)if(ye.every((ve,ge)=>ve===ie[ge]))return Ft._colorsMapping.get(ue);return ie}getHexCode(wt){const ie=this._colors.get(wt);return ie?F.Util.makeHexColor(...ie):wt}};Oe(Ft,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let bt=Ft;w.ColorManager=bt;const Me=class Me{constructor(wt,ie,ue,ye,ve,ge){Ht(this,Ot);Ht(this,K,null);Ht(this,pt,new Map);Ht(this,Tt,new Map);Ht(this,Xt,null);Ht(this,Lt,null);Ht(this,Bt,new ut);Ht(this,Mt,0);Ht(this,Vt,new Set);Ht(this,Et,null);Ht(this,Dt,null);Ht(this,Nt,new Set);Ht(this,ht,null);Ht(this,q,new Yt);Ht(this,G,!1);Ht(this,tt,!1);Ht(this,mt,null);Ht(this,_t,F.AnnotationEditorType.NONE);Ht(this,vt,new Set);Ht(this,kt,null);Ht(this,zt,this.blur.bind(this));Ht(this,Qt,this.focus.bind(this));Ht(this,te,this.copy.bind(this));Ht(this,se,this.cut.bind(this));Ht(this,ne,this.paste.bind(this));Ht(this,ae,this.keydown.bind(this));Ht(this,$t,this.onEditingAction.bind(this));Ht(this,Ut,this.onPageChanging.bind(this));Ht(this,st,this.onScaleChanging.bind(this));Ht(this,St,this.onRotationChanging.bind(this));Ht(this,It,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Ht(this,jt,[0,0]);Ht(this,Zt,null);Ht(this,re,null);Ht(this,oe,null);Wt(this,re,wt),Wt(this,oe,ie),Wt(this,Xt,ue),this._eventBus=ye,this._eventBus._on("editingaction",D(this,$t)),this._eventBus._on("pagechanging",D(this,Ut)),this._eventBus._on("scalechanging",D(this,st)),this._eventBus._on("rotationchanging",D(this,St)),Wt(this,Lt,ve.annotationStorage),Wt(this,ht,ve.filterFactory),Wt(this,kt,ge),this.viewParameters={realScale:U.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const wt=Me.prototype,ie=ve=>{const{activeElement:ge}=document;return ge&&D(ve,re).contains(ge)&&ve.hasSomethingToControl()},ue=this.TRANSLATE_SMALL,ye=this.TRANSLATE_BIG;return(0,F.shadow)(this,"_keyboardManager",new Z([[["ctrl+a","mac+meta+a"],wt.selectAll],[["ctrl+z","mac+meta+z"],wt.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],wt.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],wt.delete],[["Escape","mac+Escape"],wt.unselectAll],[["ArrowLeft","mac+ArrowLeft"],wt.translateSelectedEditors,{args:[-ue,0],checker:ie}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],wt.translateSelectedEditors,{args:[-ye,0],checker:ie}],[["ArrowRight","mac+ArrowRight"],wt.translateSelectedEditors,{args:[ue,0],checker:ie}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],wt.translateSelectedEditors,{args:[ye,0],checker:ie}],[["ArrowUp","mac+ArrowUp"],wt.translateSelectedEditors,{args:[0,-ue],checker:ie}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],wt.translateSelectedEditors,{args:[0,-ye],checker:ie}],[["ArrowDown","mac+ArrowDown"],wt.translateSelectedEditors,{args:[0,ue],checker:ie}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],wt.translateSelectedEditors,{args:[0,ye],checker:ie}]]))}destroy(){Rt(this,Ot,rs).call(this),Rt(this,Ot,ws).call(this),this._eventBus._off("editingaction",D(this,$t)),this._eventBus._off("pagechanging",D(this,Ut)),this._eventBus._off("scalechanging",D(this,st)),this._eventBus._off("rotationchanging",D(this,St));for(const wt of D(this,Tt).values())wt.destroy();D(this,Tt).clear(),D(this,pt).clear(),D(this,Nt).clear(),Wt(this,K,null),D(this,vt).clear(),D(this,Bt).destroy(),D(this,Xt).destroy()}get hcmFilter(){return(0,F.shadow)(this,"hcmFilter",D(this,kt)?D(this,ht).addHCMFilter(D(this,kt).foreground,D(this,kt).background):"none")}get direction(){return(0,F.shadow)(this,"direction",getComputedStyle(D(this,re)).direction)}editAltText(wt){D(this,Xt)?.editAltText(this,wt)}onPageChanging({pageNumber:wt}){Wt(this,Mt,wt-1)}focusMainContainer(){D(this,re).focus()}findParent(wt,ie){for(const ue of D(this,Tt).values()){const{x:ye,y:ve,width:ge,height:ft}=ue.div.getBoundingClientRect();if(wt>=ye&&wt<=ye+ge&&ie>=ve&&ie<=ve+ft)return ue}return null}disableUserSelect(wt=!1){D(this,oe).classList.toggle("noUserSelect",wt)}addShouldRescale(wt){D(this,Nt).add(wt)}removeShouldRescale(wt){D(this,Nt).delete(wt)}onScaleChanging({scale:wt}){this.commitOrRemove(),this.viewParameters.realScale=wt*U.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ie of D(this,Nt))ie.onScaleChanging()}onRotationChanging({pagesRotation:wt}){this.commitOrRemove(),this.viewParameters.rotation=wt}addToAnnotationStorage(wt){!wt.isEmpty()&&D(this,Lt)&&!D(this,Lt).has(wt.id)&&D(this,Lt).setValue(wt.id,wt)}blur(){if(!this.hasSelection)return;const{activeElement:wt}=document;for(const ie of D(this,vt))if(ie.div.contains(wt)){Wt(this,mt,[ie,wt]),ie._focusEventsAllowed=!1;break}}focus(){if(!D(this,mt))return;const[wt,ie]=D(this,mt);Wt(this,mt,null),ie.addEventListener("focusin",()=>{wt._focusEventsAllowed=!0},{once:!0}),ie.focus()}addEditListeners(){Rt(this,Ot,Cs).call(this),Rt(this,Ot,Ts).call(this)}removeEditListeners(){Rt(this,Ot,rs).call(this),Rt(this,Ot,Ps).call(this)}copy(wt){if(wt.preventDefault(),D(this,K)?.commitOrRemove(),!this.hasSelection)return;const ie=[];for(const ue of D(this,vt)){const ye=ue.serialize(!0);ye&&ie.push(ye)}ie.length!==0&&wt.clipboardData.setData("application/pdfjs",JSON.stringify(ie))}cut(wt){this.copy(wt),this.delete()}paste(wt){wt.preventDefault();const{clipboardData:ie}=wt;for(const ve of ie.items)for(const ge of D(this,Dt))if(ge.isHandlingMimeForPasting(ve.type)){ge.paste(ve,this.currentLayer);return}let ue=ie.getData("application/pdfjs");if(!ue)return;try{ue=JSON.parse(ue)}catch(ve){(0,F.warn)(`paste: "${ve.message}".`);return}if(!Array.isArray(ue))return;this.unselectAll();const ye=this.currentLayer;try{const ve=[];for(const ct of ue){const Pt=ye.deserialize(ct);if(!Pt)return;ve.push(Pt)}const ge=()=>{for(const ct of ve)Rt(this,Ot,ks).call(this,ct);Rt(this,Ot,Ms).call(this,ve)},ft=()=>{for(const ct of ve)ct.remove()};this.addCommands({cmd:ge,undo:ft,mustExec:!0})}catch(ve){(0,F.warn)(`paste: "${ve.message}".`)}}keydown(wt){this.getActive()?.shouldGetKeyboardEvents()||Me._keyboardManager.exec(this,wt)}onEditingAction(wt){["undo","redo","delete","selectAll"].includes(wt.name)&&this[wt.name]()}setEditingState(wt){wt?(Rt(this,Ot,oi).call(this),Rt(this,Ot,Cs).call(this),Rt(this,Ot,Ts).call(this),Rt(this,Ot,$e).call(this,{isEditing:D(this,_t)!==F.AnnotationEditorType.NONE,isEmpty:Rt(this,Ot,Je).call(this),hasSomethingToUndo:D(this,Bt).hasSomethingToUndo(),hasSomethingToRedo:D(this,Bt).hasSomethingToRedo(),hasSelectedEditor:!1})):(Rt(this,Ot,ws).call(this),Rt(this,Ot,rs).call(this),Rt(this,Ot,Ps).call(this),Rt(this,Ot,$e).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(wt){if(!D(this,Dt)){Wt(this,Dt,wt);for(const ie of D(this,Dt))Rt(this,Ot,Ke).call(this,ie.defaultPropertiesToUpdate)}}getId(){return D(this,q).getId()}get currentLayer(){return D(this,Tt).get(D(this,Mt))}getLayer(wt){return D(this,Tt).get(wt)}get currentPageIndex(){return D(this,Mt)}addLayer(wt){D(this,Tt).set(wt.pageIndex,wt),D(this,G)?wt.enable():wt.disable()}removeLayer(wt){D(this,Tt).delete(wt.pageIndex)}updateMode(wt,ie=null){if(D(this,_t)!==wt){if(Wt(this,_t,wt),wt===F.AnnotationEditorType.NONE){this.setEditingState(!1),Rt(this,Ot,ci).call(this);return}this.setEditingState(!0),Rt(this,Ot,li).call(this),this.unselectAll();for(const ue of D(this,Tt).values())ue.updateMode(wt);if(ie){for(const ue of D(this,pt).values())if(ue.annotationElementId===ie){this.setSelected(ue),ue.enterInEditMode();break}}}}updateToolbar(wt){wt!==D(this,_t)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:wt})}updateParams(wt,ie){if(D(this,Dt)){if(wt===F.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(wt);return}for(const ue of D(this,vt))ue.updateParams(wt,ie);for(const ue of D(this,Dt))ue.updateDefaultParams(wt,ie)}}enableWaiting(wt=!1){if(D(this,tt)!==wt){Wt(this,tt,wt);for(const ie of D(this,Tt).values())wt?ie.disableClick():ie.enableClick(),ie.div.classList.toggle("waiting",wt)}}getEditors(wt){const ie=[];for(const ue of D(this,pt).values())ue.pageIndex===wt&&ie.push(ue);return ie}getEditor(wt){return D(this,pt).get(wt)}addEditor(wt){D(this,pt).set(wt.id,wt)}removeEditor(wt){D(this,pt).delete(wt.id),this.unselect(wt),(!wt.annotationElementId||!D(this,Vt).has(wt.annotationElementId))&&D(this,Lt)?.remove(wt.id)}addDeletedAnnotationElement(wt){D(this,Vt).add(wt.annotationElementId),wt.deleted=!0}isDeletedAnnotationElement(wt){return D(this,Vt).has(wt)}removeDeletedAnnotationElement(wt){D(this,Vt).delete(wt.annotationElementId),wt.deleted=!1}setActiveEditor(wt){D(this,K)!==wt&&(Wt(this,K,wt),wt&&Rt(this,Ot,Ke).call(this,wt.propertiesToUpdate))}toggleSelected(wt){if(D(this,vt).has(wt)){D(this,vt).delete(wt),wt.unselect(),Rt(this,Ot,$e).call(this,{hasSelectedEditor:this.hasSelection});return}D(this,vt).add(wt),wt.select(),Rt(this,Ot,Ke).call(this,wt.propertiesToUpdate),Rt(this,Ot,$e).call(this,{hasSelectedEditor:!0})}setSelected(wt){for(const ie of D(this,vt))ie!==wt&&ie.unselect();D(this,vt).clear(),D(this,vt).add(wt),wt.select(),Rt(this,Ot,Ke).call(this,wt.propertiesToUpdate),Rt(this,Ot,$e).call(this,{hasSelectedEditor:!0})}isSelected(wt){return D(this,vt).has(wt)}unselect(wt){wt.unselect(),D(this,vt).delete(wt),Rt(this,Ot,$e).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return D(this,vt).size!==0}undo(){D(this,Bt).undo(),Rt(this,Ot,$e).call(this,{hasSomethingToUndo:D(this,Bt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Rt(this,Ot,Je).call(this)})}redo(){D(this,Bt).redo(),Rt(this,Ot,$e).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:D(this,Bt).hasSomethingToRedo(),isEmpty:Rt(this,Ot,Je).call(this)})}addCommands(wt){D(this,Bt).add(wt),Rt(this,Ot,$e).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Rt(this,Ot,Je).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const wt=[...D(this,vt)],ie=()=>{for(const ye of wt)ye.remove()},ue=()=>{for(const ye of wt)Rt(this,Ot,ks).call(this,ye)};this.addCommands({cmd:ie,undo:ue,mustExec:!0})}commitOrRemove(){D(this,K)?.commitOrRemove()}hasSomethingToControl(){return D(this,K)||this.hasSelection}selectAll(){for(const wt of D(this,vt))wt.commit();Rt(this,Ot,Ms).call(this,D(this,pt).values())}unselectAll(){if(D(this,K)){D(this,K).commitOrRemove();return}if(this.hasSelection){for(const wt of D(this,vt))wt.unselect();D(this,vt).clear(),Rt(this,Ot,$e).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(wt,ie,ue=!1){if(ue||this.commitOrRemove(),!this.hasSelection)return;D(this,jt)[0]+=wt,D(this,jt)[1]+=ie;const[ye,ve]=D(this,jt),ge=[...D(this,vt)],ft=1e3;D(this,Zt)&&clearTimeout(D(this,Zt)),Wt(this,Zt,setTimeout(()=>{Wt(this,Zt,null),D(this,jt)[0]=D(this,jt)[1]=0,this.addCommands({cmd:()=>{for(const ct of ge)D(this,pt).has(ct.id)&&ct.translateInPage(ye,ve)},undo:()=>{for(const ct of ge)D(this,pt).has(ct.id)&&ct.translateInPage(-ye,-ve)},mustExec:!1})},ft));for(const ct of ge)ct.translateInPage(wt,ie)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Wt(this,Et,new Map);for(const wt of D(this,vt))D(this,Et).set(wt,{savedX:wt.x,savedY:wt.y,savedPageIndex:wt.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!D(this,Et))return!1;this.disableUserSelect(!1);const wt=D(this,Et);Wt(this,Et,null);let ie=!1;for(const[{x:ye,y:ve,pageIndex:ge},ft]of wt)ft.newX=ye,ft.newY=ve,ft.newPageIndex=ge,ie||(ie=ye!==ft.savedX||ve!==ft.savedY||ge!==ft.savedPageIndex);if(!ie)return!1;const ue=(ye,ve,ge,ft)=>{if(D(this,pt).has(ye.id)){const ct=D(this,Tt).get(ft);ct?ye._setParentAndPosition(ct,ve,ge):(ye.pageIndex=ft,ye.x=ve,ye.y=ge)}};return this.addCommands({cmd:()=>{for(const[ye,{newX:ve,newY:ge,newPageIndex:ft}]of wt)ue(ye,ve,ge,ft)},undo:()=>{for(const[ye,{savedX:ve,savedY:ge,savedPageIndex:ft}]of wt)ue(ye,ve,ge,ft)},mustExec:!0}),!0}dragSelectedEditors(wt,ie){if(D(this,Et))for(const ue of D(this,Et).keys())ue.drag(wt,ie)}rebuild(wt){if(wt.parent===null){const ie=this.getLayer(wt.pageIndex);ie?(ie.changeParent(wt),ie.addOrRebuild(wt)):(this.addEditor(wt),this.addToAnnotationStorage(wt),wt.rebuild())}else wt.parent.addOrRebuild(wt)}isActive(wt){return D(this,K)===wt}getActive(){return D(this,K)}getMode(){return D(this,_t)}get imageManager(){return(0,F.shadow)(this,"imageManager",new At)}};K=new WeakMap,pt=new WeakMap,Tt=new WeakMap,Xt=new WeakMap,Lt=new WeakMap,Bt=new WeakMap,Mt=new WeakMap,Vt=new WeakMap,Et=new WeakMap,Dt=new WeakMap,Nt=new WeakMap,ht=new WeakMap,q=new WeakMap,G=new WeakMap,tt=new WeakMap,mt=new WeakMap,_t=new WeakMap,vt=new WeakMap,kt=new WeakMap,zt=new WeakMap,Qt=new WeakMap,te=new WeakMap,se=new WeakMap,ne=new WeakMap,ae=new WeakMap,$t=new WeakMap,Ut=new WeakMap,st=new WeakMap,St=new WeakMap,It=new WeakMap,jt=new WeakMap,Zt=new WeakMap,re=new WeakMap,oe=new WeakMap,Ot=new WeakSet,oi=function(){window.addEventListener("focus",D(this,Qt)),window.addEventListener("blur",D(this,zt))},ws=function(){window.removeEventListener("focus",D(this,Qt)),window.removeEventListener("blur",D(this,zt))},Cs=function(){window.addEventListener("keydown",D(this,ae),{capture:!0})},rs=function(){window.removeEventListener("keydown",D(this,ae),{capture:!0})},Ts=function(){document.addEventListener("copy",D(this,te)),document.addEventListener("cut",D(this,se)),document.addEventListener("paste",D(this,ne))},Ps=function(){document.removeEventListener("copy",D(this,te)),document.removeEventListener("cut",D(this,se)),document.removeEventListener("paste",D(this,ne))},$e=function(wt){Object.entries(wt).some(([ue,ye])=>D(this,It)[ue]!==ye)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(D(this,It),wt)})},Ke=function(wt){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:wt})},li=function(){if(!D(this,G)){Wt(this,G,!0);for(const wt of D(this,Tt).values())wt.enable()}},ci=function(){if(this.unselectAll(),D(this,G)){Wt(this,G,!1);for(const wt of D(this,Tt).values())wt.disable()}},ks=function(wt){const ie=D(this,Tt).get(wt.pageIndex);ie?ie.addOrRebuild(wt):this.addEditor(wt)},Je=function(){if(D(this,pt).size===0)return!0;if(D(this,pt).size===1)for(const wt of D(this,pt).values())return wt.isEmpty();return!1},Ms=function(wt){D(this,vt).clear();for(const ie of wt)ie.isEmpty()||(D(this,vt).add(ie),ie.select());Rt(this,Ot,$e).call(this,{hasSelectedEditor:!0})},Oe(Me,"TRANSLATE_SMALL",1),Oe(Me,"TRANSLATE_BIG",10);let Ct=Me;w.AnnotationEditorUIManager=Ct},(rt,w,X)=>{var Mt,Vt,Et,Dt,Nt,ht,q,G,tt,mt,_t,vt,We,ze,Rs,as,os,Qe,Ze;Object.defineProperty(w,"__esModule",{value:!0}),w.StatTimer=w.RenderingCancelledException=w.PixelsPerInch=w.PageViewport=w.PDFDateString=w.DOMStandardFontDataFactory=w.DOMSVGFactory=w.DOMFilterFactory=w.DOMCanvasFactory=w.DOMCMapReaderFactory=void 0,w.deprecated=O,w.getColorValues=pt,w.getCurrentTransform=Tt,w.getCurrentTransformInverse=Xt,w.getFilenameFromUrl=Q,w.getPdfFilenameFromUrl=it,w.getRGB=K,w.getXfaPageViewport=Ft,w.isDataScheme=gt,w.isPdfFile=et,w.isValidFetchUrl=ot,w.loadScript=W,w.noContextMenu=Y,w.setLayerDimensions=Lt;var F=X(7),U=X(1);const yt="http://www.w3.org/2000/svg",Bt=class Bt{};Oe(Bt,"CSS",96),Oe(Bt,"PDF",72),Oe(Bt,"PDF_TO_CSS_UNITS",Bt.CSS/Bt.PDF);let dt=Bt;w.PixelsPerInch=dt;class Yt extends F.BaseFilterFactory{constructor({docId:st,ownerDocument:St=globalThis.document}={}){super();Ht(this,vt);Ht(this,Mt);Ht(this,Vt);Ht(this,Et);Ht(this,Dt);Ht(this,Nt);Ht(this,ht);Ht(this,q);Ht(this,G);Ht(this,tt);Ht(this,mt);Ht(this,_t,0);Wt(this,Et,st),Wt(this,Dt,St)}addFilter(st){if(!st)return"none";let St=D(this,vt,We).get(st);if(St)return St;let It,jt,Zt,re;if(st.length===1){const de=st[0],Ce=new Array(256);for(let xe=0;xe<256;xe++)Ce[xe]=de[xe]/255;re=It=jt=Zt=Ce.join(",")}else{const[de,Ce,xe]=st,Re=new Array(256),be=new Array(256),we=new Array(256);for(let ke=0;ke<256;ke++)Re[ke]=de[ke]/255,be[ke]=Ce[ke]/255,we[ke]=xe[ke]/255;It=Re.join(","),jt=be.join(","),Zt=we.join(","),re=`${It}${jt}${Zt}`}if(St=D(this,vt,We).get(re),St)return D(this,vt,We).set(st,St),St;const oe=`g_${D(this,Et)}_transfer_map_${Ye(this,_t)._++}`,Ot=`url(#${oe})`;D(this,vt,We).set(st,Ot),D(this,vt,We).set(re,Ot);const he=Rt(this,vt,as).call(this,oe);return Rt(this,vt,Qe).call(this,It,jt,Zt,he),Ot}addHCMFilter(st,St){const It=`${st}-${St}`;if(D(this,ht)===It)return D(this,q);if(Wt(this,ht,It),Wt(this,q,"none"),D(this,Nt)?.remove(),!st||!St)return D(this,q);const jt=Rt(this,vt,Ze).call(this,st);st=U.Util.makeHexColor(...jt);const Zt=Rt(this,vt,Ze).call(this,St);if(St=U.Util.makeHexColor(...Zt),D(this,vt,ze).style.color="",st==="#000000"&&St==="#ffffff"||st===St)return D(this,q);const re=new Array(256);for(let Ce=0;Ce<=255;Ce++){const xe=Ce/255;re[Ce]=xe<=.03928?xe/12.92:((xe+.055)/1.055)**2.4}const oe=re.join(","),Ot=`g_${D(this,Et)}_hcm_filter`,he=Wt(this,G,Rt(this,vt,as).call(this,Ot));Rt(this,vt,Qe).call(this,oe,oe,oe,he),Rt(this,vt,Rs).call(this,he);const de=(Ce,xe)=>{const Re=jt[Ce]/255,be=Zt[Ce]/255,we=new Array(xe+1);for(let ke=0;ke<=xe;ke++)we[ke]=Re+ke/xe*(be-Re);return we.join(",")};return Rt(this,vt,Qe).call(this,de(0,5),de(1,5),de(2,5),he),Wt(this,q,`url(#${Ot})`),D(this,q)}addHighlightHCMFilter(st,St,It,jt){const Zt=`${st}-${St}-${It}-${jt}`;if(D(this,tt)===Zt)return D(this,mt);if(Wt(this,tt,Zt),Wt(this,mt,"none"),D(this,G)?.remove(),!st||!St)return D(this,mt);const[re,oe]=[st,St].map(Rt(this,vt,Ze).bind(this));let Ot=Math.round(.2126*re[0]+.7152*re[1]+.0722*re[2]),he=Math.round(.2126*oe[0]+.7152*oe[1]+.0722*oe[2]),[de,Ce]=[It,jt].map(Rt(this,vt,Ze).bind(this));he<Ot&&([Ot,he,de,Ce]=[he,Ot,Ce,de]),D(this,vt,ze).style.color="";const xe=(we,ke,Fe)=>{const le=new Array(256),Gt=(he-Ot)/Fe,qt=we/255,me=(ke-we)/(255*Fe);let Me=0;for(let Te=0;Te<=Fe;Te++){const wt=Math.round(Ot+Te*Gt),ie=qt+Te*me;for(let ue=Me;ue<=wt;ue++)le[ue]=ie;Me=wt+1}for(let Te=Me;Te<256;Te++)le[Te]=le[Me-1];return le.join(",")},Re=`g_${D(this,Et)}_hcm_highlight_filter`,be=Wt(this,G,Rt(this,vt,as).call(this,Re));return Rt(this,vt,Rs).call(this,be),Rt(this,vt,Qe).call(this,xe(de[0],Ce[0],5),xe(de[1],Ce[1],5),xe(de[2],Ce[2],5),be),Wt(this,mt,`url(#${Re})`),D(this,mt)}destroy(st=!1){st&&(D(this,q)||D(this,mt))||(D(this,Vt)&&(D(this,Vt).parentNode.parentNode.remove(),Wt(this,Vt,null)),D(this,Mt)&&(D(this,Mt).clear(),Wt(this,Mt,null)),Wt(this,_t,0))}}Mt=new WeakMap,Vt=new WeakMap,Et=new WeakMap,Dt=new WeakMap,Nt=new WeakMap,ht=new WeakMap,q=new WeakMap,G=new WeakMap,tt=new WeakMap,mt=new WeakMap,_t=new WeakMap,vt=new WeakSet,We=function(){return D(this,Mt)||Wt(this,Mt,new Map)},ze=function(){if(!D(this,Vt)){const st=D(this,Dt).createElement("div"),{style:St}=st;St.visibility="hidden",St.contain="strict",St.width=St.height=0,St.position="absolute",St.top=St.left=0,St.zIndex=-1;const It=D(this,Dt).createElementNS(yt,"svg");It.setAttribute("width",0),It.setAttribute("height",0),Wt(this,Vt,D(this,Dt).createElementNS(yt,"defs")),st.append(It),It.append(D(this,Vt)),D(this,Dt).body.append(st)}return D(this,Vt)},Rs=function(st){const St=D(this,Dt).createElementNS(yt,"feColorMatrix");St.setAttribute("type","matrix"),St.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),st.append(St)},as=function(st){const St=D(this,Dt).createElementNS(yt,"filter");return St.setAttribute("color-interpolation-filters","sRGB"),St.setAttribute("id",st),D(this,vt,ze).append(St),St},os=function(st,St,It){const jt=D(this,Dt).createElementNS(yt,St);jt.setAttribute("type","discrete"),jt.setAttribute("tableValues",It),st.append(jt)},Qe=function(st,St,It,jt){const Zt=D(this,Dt).createElementNS(yt,"feComponentTransfer");jt.append(Zt),Rt(this,vt,os).call(this,Zt,"feFuncR",st),Rt(this,vt,os).call(this,Zt,"feFuncG",St),Rt(this,vt,os).call(this,Zt,"feFuncB",It)},Ze=function(st){return D(this,vt,ze).style.color=st,K(getComputedStyle(D(this,vt,ze)).getPropertyValue("color"))},w.DOMFilterFactory=Yt;class At extends F.BaseCanvasFactory{constructor({ownerDocument:Ut=globalThis.document}={}){super(),this._document=Ut}_createCanvas(Ut,st){const St=this._document.createElement("canvas");return St.width=Ut,St.height=st,St}}w.DOMCanvasFactory=At;async function ut($t,Ut=!1){if(ot($t,document.baseURI)){const st=await fetch($t);if(!st.ok)throw new Error(st.statusText);return Ut?new Uint8Array(await st.arrayBuffer()):(0,U.stringToBytes)(await st.text())}return new Promise((st,St)=>{const It=new XMLHttpRequest;It.open("GET",$t,!0),Ut&&(It.responseType="arraybuffer"),It.onreadystatechange=()=>{if(It.readyState===XMLHttpRequest.DONE){if(It.status===200||It.status===0){let jt;if(Ut&&It.response?jt=new Uint8Array(It.response):!Ut&&It.responseText&&(jt=(0,U.stringToBytes)(It.responseText)),jt){st(jt);return}}St(new Error(It.statusText))}},It.send(null)})}class Z extends F.BaseCMapReaderFactory{_fetchData(Ut,st){return ut(Ut,this.isCompressed).then(St=>({cMapData:St,compressionType:st}))}}w.DOMCMapReaderFactory=Z;class bt extends F.BaseStandardFontDataFactory{_fetchData(Ut){return ut(Ut,!0)}}w.DOMStandardFontDataFactory=bt;class Ct extends F.BaseSVGFactory{_createSVG(Ut){return document.createElementNS(yt,Ut)}}w.DOMSVGFactory=Ct;class at{constructor({viewBox:Ut,scale:st,rotation:St,offsetX:It=0,offsetY:jt=0,dontFlip:Zt=!1}){this.viewBox=Ut,this.scale=st,this.rotation=St,this.offsetX=It,this.offsetY=jt;const re=(Ut[2]+Ut[0])/2,oe=(Ut[3]+Ut[1])/2;let Ot,he,de,Ce;switch(St%=360,St<0&&(St+=360),St){case 180:Ot=-1,he=0,de=0,Ce=1;break;case 90:Ot=0,he=1,de=1,Ce=0;break;case 270:Ot=0,he=-1,de=-1,Ce=0;break;case 0:Ot=1,he=0,de=0,Ce=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Zt&&(de=-de,Ce=-Ce);let xe,Re,be,we;Ot===0?(xe=Math.abs(oe-Ut[1])*st+It,Re=Math.abs(re-Ut[0])*st+jt,be=(Ut[3]-Ut[1])*st,we=(Ut[2]-Ut[0])*st):(xe=Math.abs(re-Ut[0])*st+It,Re=Math.abs(oe-Ut[1])*st+jt,be=(Ut[2]-Ut[0])*st,we=(Ut[3]-Ut[1])*st),this.transform=[Ot*st,he*st,de*st,Ce*st,xe-Ot*st*re-de*st*oe,Re-he*st*re-Ce*st*oe],this.width=be,this.height=we}get rawDims(){const{viewBox:Ut}=this;return(0,U.shadow)(this,"rawDims",{pageWidth:Ut[2]-Ut[0],pageHeight:Ut[3]-Ut[1],pageX:Ut[0],pageY:Ut[1]})}clone({scale:Ut=this.scale,rotation:st=this.rotation,offsetX:St=this.offsetX,offsetY:It=this.offsetY,dontFlip:jt=!1}={}){return new at({viewBox:this.viewBox.slice(),scale:Ut,rotation:st,offsetX:St,offsetY:It,dontFlip:jt})}convertToViewportPoint(Ut,st){return U.Util.applyTransform([Ut,st],this.transform)}convertToViewportRectangle(Ut){const st=U.Util.applyTransform([Ut[0],Ut[1]],this.transform),St=U.Util.applyTransform([Ut[2],Ut[3]],this.transform);return[st[0],st[1],St[0],St[1]]}convertToPdfPoint(Ut,st){return U.Util.applyInverseTransform([Ut,st],this.transform)}}w.PageViewport=at;class lt extends U.BaseException{constructor(Ut,st=0){super(Ut,"RenderingCancelledException"),this.extraDelay=st}}w.RenderingCancelledException=lt;function gt($t){const Ut=$t.length;let st=0;for(;st<Ut&&$t[st].trim()==="";)st++;return $t.substring(st,st+5).toLowerCase()==="data:"}function et($t){return typeof $t=="string"&&/\.pdf$/i.test($t)}function Q($t,Ut=!1){return Ut||([$t]=$t.split(/[#?]/,1)),$t.substring($t.lastIndexOf("/")+1)}function it($t,Ut="document.pdf"){if(typeof $t!="string")return Ut;if(gt($t))return(0,U.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ut;const st=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,St=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,It=st.exec($t);let jt=St.exec(It[1])||St.exec(It[2])||St.exec(It[3]);if(jt&&(jt=jt[0],jt.includes("%")))try{jt=St.exec(decodeURIComponent(jt))[0]}catch{}return jt||Ut}class xt{constructor(){Oe(this,"started",Object.create(null));Oe(this,"times",[])}time(Ut){Ut in this.started&&(0,U.warn)(`Timer is already running for ${Ut}`),this.started[Ut]=Date.now()}timeEnd(Ut){Ut in this.started||(0,U.warn)(`Timer has not been started for ${Ut}`),this.times.push({name:Ut,start:this.started[Ut],end:Date.now()}),delete this.started[Ut]}toString(){const Ut=[];let st=0;for(const{name:St}of this.times)st=Math.max(St.length,st);for(const{name:St,start:It,end:jt}of this.times)Ut.push(`${St.padEnd(st)} ${jt-It}ms
`);return Ut.join("")}}w.StatTimer=xt;function ot($t,Ut){try{const{protocol:st}=Ut?new URL($t,Ut):new URL($t);return st==="http:"||st==="https:"}catch{return!1}}function Y($t){$t.preventDefault()}function W($t,Ut=!1){return new Promise((st,St)=>{const It=document.createElement("script");It.src=$t,It.onload=function(jt){Ut&&It.remove(),st(jt)},It.onerror=function(){St(new Error(`Cannot load script at: ${It.src}`))},(document.head||document.documentElement).append(It)})}function O($t){console.log("Deprecated API usage: "+$t)}let nt;class J{static toDateObject(Ut){if(!Ut||typeof Ut!="string")return null;nt||(nt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const st=nt.exec(Ut);if(!st)return null;const St=parseInt(st[1],10);let It=parseInt(st[2],10);It=It>=1&&It<=12?It-1:0;let jt=parseInt(st[3],10);jt=jt>=1&&jt<=31?jt:1;let Zt=parseInt(st[4],10);Zt=Zt>=0&&Zt<=23?Zt:0;let re=parseInt(st[5],10);re=re>=0&&re<=59?re:0;let oe=parseInt(st[6],10);oe=oe>=0&&oe<=59?oe:0;const Ot=st[7]||"Z";let he=parseInt(st[8],10);he=he>=0&&he<=23?he:0;let de=parseInt(st[9],10)||0;return de=de>=0&&de<=59?de:0,Ot==="-"?(Zt+=he,re+=de):Ot==="+"&&(Zt-=he,re-=de),new Date(Date.UTC(St,It,jt,Zt,re,oe))}}w.PDFDateString=J;function Ft($t,{scale:Ut=1,rotation:st=0}){const{width:St,height:It}=$t.attributes.style,jt=[0,0,parseInt(St),parseInt(It)];return new at({viewBox:jt,scale:Ut,rotation:st})}function K($t){if($t.startsWith("#")){const Ut=parseInt($t.slice(1),16);return[(Ut&16711680)>>16,(Ut&65280)>>8,Ut&255]}return $t.startsWith("rgb(")?$t.slice(4,-1).split(",").map(Ut=>parseInt(Ut)):$t.startsWith("rgba(")?$t.slice(5,-1).split(",").map(Ut=>parseInt(Ut)).slice(0,3):((0,U.warn)(`Not a valid color format: "${$t}"`),[0,0,0])}function pt($t){const Ut=document.createElement("span");Ut.style.visibility="hidden",document.body.append(Ut);for(const st of $t.keys()){Ut.style.color=st;const St=window.getComputedStyle(Ut).color;$t.set(st,K(St))}Ut.remove()}function Tt($t){const{a:Ut,b:st,c:St,d:It,e:jt,f:Zt}=$t.getTransform();return[Ut,st,St,It,jt,Zt]}function Xt($t){const{a:Ut,b:st,c:St,d:It,e:jt,f:Zt}=$t.getTransform().invertSelf();return[Ut,st,St,It,jt,Zt]}function Lt($t,Ut,st=!1,St=!0){if(Ut instanceof at){const{pageWidth:It,pageHeight:jt}=Ut.rawDims,{style:Zt}=$t,re=U.FeatureTest.isCSSRoundSupported,oe=`var(--scale-factor) * ${It}px`,Ot=`var(--scale-factor) * ${jt}px`,he=re?`round(${oe}, 1px)`:`calc(${oe})`,de=re?`round(${Ot}, 1px)`:`calc(${Ot})`;!st||Ut.rotation%180===0?(Zt.width=he,Zt.height=de):(Zt.width=de,Zt.height=he)}St&&$t.setAttribute("data-main-rotation",Ut.rotation)}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.BaseStandardFontDataFactory=w.BaseSVGFactory=w.BaseFilterFactory=w.BaseCanvasFactory=w.BaseCMapReaderFactory=void 0;var F=X(1);class U{constructor(){this.constructor===U&&(0,F.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(Z){return"none"}addHCMFilter(Z,bt){return"none"}addHighlightHCMFilter(Z,bt,Ct,at){return"none"}destroy(Z=!1){}}w.BaseFilterFactory=U;class yt{constructor(){this.constructor===yt&&(0,F.unreachable)("Cannot initialize BaseCanvasFactory.")}create(Z,bt){if(Z<=0||bt<=0)throw new Error("Invalid canvas size");const Ct=this._createCanvas(Z,bt);return{canvas:Ct,context:Ct.getContext("2d")}}reset(Z,bt,Ct){if(!Z.canvas)throw new Error("Canvas is not specified");if(bt<=0||Ct<=0)throw new Error("Invalid canvas size");Z.canvas.width=bt,Z.canvas.height=Ct}destroy(Z){if(!Z.canvas)throw new Error("Canvas is not specified");Z.canvas.width=0,Z.canvas.height=0,Z.canvas=null,Z.context=null}_createCanvas(Z,bt){(0,F.unreachable)("Abstract method `_createCanvas` called.")}}w.BaseCanvasFactory=yt;class dt{constructor({baseUrl:Z=null,isCompressed:bt=!0}){this.constructor===dt&&(0,F.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=Z,this.isCompressed=bt}async fetch({name:Z}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!Z)throw new Error("CMap name must be specified.");const bt=this.baseUrl+Z+(this.isCompressed?".bcmap":""),Ct=this.isCompressed?F.CMapCompressionType.BINARY:F.CMapCompressionType.NONE;return this._fetchData(bt,Ct).catch(at=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${bt}`)})}_fetchData(Z,bt){(0,F.unreachable)("Abstract method `_fetchData` called.")}}w.BaseCMapReaderFactory=dt;class Yt{constructor({baseUrl:Z=null}){this.constructor===Yt&&(0,F.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=Z}async fetch({filename:Z}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!Z)throw new Error("Font filename must be specified.");const bt=`${this.baseUrl}${Z}`;return this._fetchData(bt).catch(Ct=>{throw new Error(`Unable to load font data at: ${bt}`)})}_fetchData(Z){(0,F.unreachable)("Abstract method `_fetchData` called.")}}w.BaseStandardFontDataFactory=Yt;class At{constructor(){this.constructor===At&&(0,F.unreachable)("Cannot initialize BaseSVGFactory.")}create(Z,bt,Ct=!1){if(Z<=0||bt<=0)throw new Error("Invalid SVG dimensions");const at=this._createSVG("svg:svg");return at.setAttribute("version","1.1"),Ct||(at.setAttribute("width",`${Z}px`),at.setAttribute("height",`${bt}px`)),at.setAttribute("preserveAspectRatio","none"),at.setAttribute("viewBox",`0 0 ${Z} ${bt}`),at}createElement(Z){if(typeof Z!="string")throw new Error("Invalid SVG element type");return this._createSVG(Z)}_createSVG(Z){(0,F.unreachable)("Abstract method `_createSVG` called.")}}w.BaseSVGFactory=At},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.MurmurHash3_64=void 0;var F=X(1);const U=3285377520,yt=4294901760,dt=65535;class Yt{constructor(ut){this.h1=ut?ut&4294967295:U,this.h2=ut?ut&4294967295:U}update(ut){let Z,bt;if(typeof ut=="string"){Z=new Uint8Array(ut.length*2),bt=0;for(let O=0,nt=ut.length;O<nt;O++){const J=ut.charCodeAt(O);J<=255?Z[bt++]=J:(Z[bt++]=J>>>8,Z[bt++]=J&255)}}else if((0,F.isArrayBuffer)(ut))Z=ut.slice(),bt=Z.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const Ct=bt>>2,at=bt-Ct*4,lt=new Uint32Array(Z.buffer,0,Ct);let gt=0,et=0,Q=this.h1,it=this.h2;const xt=3432918353,ot=461845907,Y=xt&dt,W=ot&dt;for(let O=0;O<Ct;O++)O&1?(gt=lt[O],gt=gt*xt&yt|gt*Y&dt,gt=gt<<15|gt>>>17,gt=gt*ot&yt|gt*W&dt,Q^=gt,Q=Q<<13|Q>>>19,Q=Q*5+3864292196):(et=lt[O],et=et*xt&yt|et*Y&dt,et=et<<15|et>>>17,et=et*ot&yt|et*W&dt,it^=et,it=it<<13|it>>>19,it=it*5+3864292196);switch(gt=0,at){case 3:gt^=Z[Ct*4+2]<<16;case 2:gt^=Z[Ct*4+1]<<8;case 1:gt^=Z[Ct*4],gt=gt*xt&yt|gt*Y&dt,gt=gt<<15|gt>>>17,gt=gt*ot&yt|gt*W&dt,Ct&1?Q^=gt:it^=gt}this.h1=Q,this.h2=it}hexdigest(){let ut=this.h1,Z=this.h2;return ut^=Z>>>1,ut=ut*3981806797&yt|ut*36045&dt,Z=Z*4283543511&yt|((Z<<16|ut>>>16)*2950163797&yt)>>>16,ut^=Z>>>1,ut=ut*444984403&yt|ut*60499&dt,Z=Z*3301882366&yt|((Z<<16|ut>>>16)*3120437893&yt)>>>16,ut^=Z>>>1,(ut>>>0).toString(16).padStart(8,"0")+(Z>>>0).toString(16).padStart(8,"0")}}w.MurmurHash3_64=Yt},(rt,w,X)=>{var dt;Object.defineProperty(w,"__esModule",{value:!0}),w.FontLoader=w.FontFaceObject=void 0;var F=X(1);class U{constructor({ownerDocument:At=globalThis.document,styleElement:ut=null}){Ht(this,dt,new Set);this._document=At,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(At){this.nativeFontFaces.add(At),this._document.fonts.add(At)}removeNativeFontFace(At){this.nativeFontFaces.delete(At),this._document.fonts.delete(At)}insertRule(At){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const ut=this.styleElement.sheet;ut.insertRule(At,ut.cssRules.length)}clear(){for(const At of this.nativeFontFaces)this._document.fonts.delete(At);this.nativeFontFaces.clear(),D(this,dt).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(At){if(!(!At||D(this,dt).has(At.loadedName))){if((0,F.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:ut,src:Z,style:bt}=At,Ct=new FontFace(ut,Z,bt);this.addNativeFontFace(Ct);try{await Ct.load(),D(this,dt).add(ut)}catch{(0,F.warn)(`Cannot load system font: ${At.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(Ct)}return}(0,F.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(At){if(At.attached||At.missingFile&&!At.systemFontInfo)return;if(At.attached=!0,At.systemFontInfo){await this.loadSystemFont(At.systemFontInfo);return}if(this.isFontLoadingAPISupported){const Z=At.createNativeFontFace();if(Z){this.addNativeFontFace(Z);try{await Z.loaded}catch(bt){throw(0,F.warn)(`Failed to load font '${Z.family}': '${bt}'.`),At.disableFontFace=!0,bt}}return}const ut=At.createFontFaceRule();if(ut){if(this.insertRule(ut),this.isSyncFontLoadingSupported)return;await new Promise(Z=>{const bt=this._queueLoadingCallback(Z);this._prepareFontLoadEvent(At,bt)})}}get isFontLoadingAPISupported(){const At=!!this._document?.fonts;return(0,F.shadow)(this,"isFontLoadingAPISupported",At)}get isSyncFontLoadingSupported(){let At=!1;return(F.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(At=!0),(0,F.shadow)(this,"isSyncFontLoadingSupported",At)}_queueLoadingCallback(At){function ut(){for((0,F.assert)(!bt.done,"completeRequest() cannot be called twice."),bt.done=!0;Z.length>0&&Z[0].done;){const Ct=Z.shift();setTimeout(Ct.callback,0)}}const{loadingRequests:Z}=this,bt={done:!1,complete:ut,callback:At};return Z.push(bt),bt}get _loadTestFont(){const At=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,F.shadow)(this,"_loadTestFont",At)}_prepareFontLoadEvent(At,ut){function Z(K,pt){return K.charCodeAt(pt)<<24|K.charCodeAt(pt+1)<<16|K.charCodeAt(pt+2)<<8|K.charCodeAt(pt+3)&255}function bt(K,pt,Tt,Xt){const Lt=K.substring(0,pt),Bt=K.substring(pt+Tt);return Lt+Xt+Bt}let Ct,at;const lt=this._document.createElement("canvas");lt.width=1,lt.height=1;const gt=lt.getContext("2d");let et=0;function Q(K,pt){if(++et>30){(0,F.warn)("Load test font never loaded."),pt();return}if(gt.font="30px "+K,gt.fillText(".",0,20),gt.getImageData(0,0,1,1).data[3]>0){pt();return}setTimeout(Q.bind(null,K,pt))}const it=`lt${Date.now()}${this.loadTestFontId++}`;let xt=this._loadTestFont;xt=bt(xt,976,it.length,it);const Y=16,W=1482184792;let O=Z(xt,Y);for(Ct=0,at=it.length-3;Ct<at;Ct+=4)O=O-W+Z(it,Ct)|0;Ct<it.length&&(O=O-W+Z(it+"XXX",Ct)|0),xt=bt(xt,Y,4,(0,F.string32)(O));const nt=`url(data:font/opentype;base64,${btoa(xt)});`,J=`@font-face {font-family:"${it}";src:${nt}}`;this.insertRule(J);const Ft=this._document.createElement("div");Ft.style.visibility="hidden",Ft.style.width=Ft.style.height="10px",Ft.style.position="absolute",Ft.style.top=Ft.style.left="0px";for(const K of[At.loadedName,it]){const pt=this._document.createElement("span");pt.textContent="Hi",pt.style.fontFamily=K,Ft.append(pt)}this._document.body.append(Ft),Q(it,()=>{Ft.remove(),ut.complete()})}}dt=new WeakMap,w.FontLoader=U;class yt{constructor(At,{isEvalSupported:ut=!0,disableFontFace:Z=!1,ignoreErrors:bt=!1,inspectFont:Ct=null}){this.compiledGlyphs=Object.create(null);for(const at in At)this[at]=At[at];this.isEvalSupported=ut!==!1,this.disableFontFace=Z===!0,this.ignoreErrors=bt===!0,this._inspectFont=Ct}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let At;if(!this.cssFontInfo)At=new FontFace(this.loadedName,this.data,{});else{const ut={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(ut.style=`oblique ${this.cssFontInfo.italicAngle}deg`),At=new FontFace(this.cssFontInfo.fontFamily,this.data,ut)}return this._inspectFont?.(this),At}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const At=(0,F.bytesToString)(this.data),ut=`url(data:${this.mimetype};base64,${btoa(At)});`;let Z;if(!this.cssFontInfo)Z=`@font-face {font-family:"${this.loadedName}";src:${ut}}`;else{let bt=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(bt+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),Z=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${bt}src:${ut}}`}return this._inspectFont?.(this,ut),Z}getPathGenerator(At,ut){if(this.compiledGlyphs[ut]!==void 0)return this.compiledGlyphs[ut];let Z;try{Z=At.get(this.loadedName+"_path_"+ut)}catch(bt){if(!this.ignoreErrors)throw bt;return(0,F.warn)(`getPathGenerator - ignoring character: "${bt}".`),this.compiledGlyphs[ut]=function(Ct,at){}}if(this.isEvalSupported&&F.FeatureTest.isEvalSupported){const bt=[];for(const Ct of Z){const at=Ct.args!==void 0?Ct.args.join(","):"";bt.push("c.",Ct.cmd,"(",at,`);
`)}return this.compiledGlyphs[ut]=new Function("c","size",bt.join(""))}return this.compiledGlyphs[ut]=function(bt,Ct){for(const at of Z)at.cmd==="scale"&&(at.args=[Ct,-Ct]),bt[at.cmd].apply(bt,at.args)}}}w.FontFaceObject=yt},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.NodeStandardFontDataFactory=w.NodeFilterFactory=w.NodeCanvasFactory=w.NodeCMapReaderFactory=void 0;var F=X(7);X(1);const U=function(ut){return new Promise((Z,bt)=>{require$$5.readFile(ut,(at,lt)=>{if(at||!lt){bt(new Error(at));return}Z(new Uint8Array(lt))})})};class yt extends F.BaseFilterFactory{}w.NodeFilterFactory=yt;class dt extends F.BaseCanvasFactory{_createCanvas(Z,bt){return require$$5.createCanvas(Z,bt)}}w.NodeCanvasFactory=dt;class Yt extends F.BaseCMapReaderFactory{_fetchData(Z,bt){return U(Z).then(Ct=>({cMapData:Ct,compressionType:bt}))}}w.NodeCMapReaderFactory=Yt;class At extends F.BaseStandardFontDataFactory{_fetchData(Z){return U(Z)}}w.NodeStandardFontDataFactory=At},(rt,w,X)=>{var Vt,Fs,Ds;Object.defineProperty(w,"__esModule",{value:!0}),w.CanvasGraphics=void 0;var F=X(1),U=X(6),yt=X(12),dt=X(13);const Yt=16,At=100,ut=4096,Z=15,bt=10,Ct=1e3,at=16;function lt(ht,q){if(ht._removeMirroring)throw new Error("Context is already forwarding operations.");ht.__originalSave=ht.save,ht.__originalRestore=ht.restore,ht.__originalRotate=ht.rotate,ht.__originalScale=ht.scale,ht.__originalTranslate=ht.translate,ht.__originalTransform=ht.transform,ht.__originalSetTransform=ht.setTransform,ht.__originalResetTransform=ht.resetTransform,ht.__originalClip=ht.clip,ht.__originalMoveTo=ht.moveTo,ht.__originalLineTo=ht.lineTo,ht.__originalBezierCurveTo=ht.bezierCurveTo,ht.__originalRect=ht.rect,ht.__originalClosePath=ht.closePath,ht.__originalBeginPath=ht.beginPath,ht._removeMirroring=()=>{ht.save=ht.__originalSave,ht.restore=ht.__originalRestore,ht.rotate=ht.__originalRotate,ht.scale=ht.__originalScale,ht.translate=ht.__originalTranslate,ht.transform=ht.__originalTransform,ht.setTransform=ht.__originalSetTransform,ht.resetTransform=ht.__originalResetTransform,ht.clip=ht.__originalClip,ht.moveTo=ht.__originalMoveTo,ht.lineTo=ht.__originalLineTo,ht.bezierCurveTo=ht.__originalBezierCurveTo,ht.rect=ht.__originalRect,ht.closePath=ht.__originalClosePath,ht.beginPath=ht.__originalBeginPath,delete ht._removeMirroring},ht.save=function(){q.save(),this.__originalSave()},ht.restore=function(){q.restore(),this.__originalRestore()},ht.translate=function(tt,mt){q.translate(tt,mt),this.__originalTranslate(tt,mt)},ht.scale=function(tt,mt){q.scale(tt,mt),this.__originalScale(tt,mt)},ht.transform=function(tt,mt,_t,vt,kt,zt){q.transform(tt,mt,_t,vt,kt,zt),this.__originalTransform(tt,mt,_t,vt,kt,zt)},ht.setTransform=function(tt,mt,_t,vt,kt,zt){q.setTransform(tt,mt,_t,vt,kt,zt),this.__originalSetTransform(tt,mt,_t,vt,kt,zt)},ht.resetTransform=function(){q.resetTransform(),this.__originalResetTransform()},ht.rotate=function(tt){q.rotate(tt),this.__originalRotate(tt)},ht.clip=function(tt){q.clip(tt),this.__originalClip(tt)},ht.moveTo=function(G,tt){q.moveTo(G,tt),this.__originalMoveTo(G,tt)},ht.lineTo=function(G,tt){q.lineTo(G,tt),this.__originalLineTo(G,tt)},ht.bezierCurveTo=function(G,tt,mt,_t,vt,kt){q.bezierCurveTo(G,tt,mt,_t,vt,kt),this.__originalBezierCurveTo(G,tt,mt,_t,vt,kt)},ht.rect=function(G,tt,mt,_t){q.rect(G,tt,mt,_t),this.__originalRect(G,tt,mt,_t)},ht.closePath=function(){q.closePath(),this.__originalClosePath()},ht.beginPath=function(){q.beginPath(),this.__originalBeginPath()}}class gt{constructor(q){this.canvasFactory=q,this.cache=Object.create(null)}getCanvas(q,G,tt){let mt;return this.cache[q]!==void 0?(mt=this.cache[q],this.canvasFactory.reset(mt,G,tt)):(mt=this.canvasFactory.create(G,tt),this.cache[q]=mt),mt}delete(q){delete this.cache[q]}clear(){for(const q in this.cache){const G=this.cache[q];this.canvasFactory.destroy(G),delete this.cache[q]}}}function et(ht,q,G,tt,mt,_t,vt,kt,zt,Qt){const[te,se,ne,ae,$t,Ut]=(0,U.getCurrentTransform)(ht);if(se===0&&ne===0){const It=vt*te+$t,jt=Math.round(It),Zt=kt*ae+Ut,re=Math.round(Zt),oe=(vt+zt)*te+$t,Ot=Math.abs(Math.round(oe)-jt)||1,he=(kt+Qt)*ae+Ut,de=Math.abs(Math.round(he)-re)||1;return ht.setTransform(Math.sign(te),0,0,Math.sign(ae),jt,re),ht.drawImage(q,G,tt,mt,_t,0,0,Ot,de),ht.setTransform(te,se,ne,ae,$t,Ut),[Ot,de]}if(te===0&&ae===0){const It=kt*ne+$t,jt=Math.round(It),Zt=vt*se+Ut,re=Math.round(Zt),oe=(kt+Qt)*ne+$t,Ot=Math.abs(Math.round(oe)-jt)||1,he=(vt+zt)*se+Ut,de=Math.abs(Math.round(he)-re)||1;return ht.setTransform(0,Math.sign(se),Math.sign(ne),0,jt,re),ht.drawImage(q,G,tt,mt,_t,0,0,de,Ot),ht.setTransform(te,se,ne,ae,$t,Ut),[de,Ot]}ht.drawImage(q,G,tt,mt,_t,vt,kt,zt,Qt);const st=Math.hypot(te,se),St=Math.hypot(ne,ae);return[st*zt,St*Qt]}function Q(ht){const{width:q,height:G}=ht;if(q>Ct||G>Ct)return null;const tt=1e3,mt=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),_t=q+1;let vt=new Uint8Array(_t*(G+1)),kt,zt,Qt;const te=q+7&-8;let se=new Uint8Array(te*G),ne=0;for(const St of ht.data){let It=128;for(;It>0;)se[ne++]=St&It?0:255,It>>=1}let ae=0;for(ne=0,se[ne]!==0&&(vt[0]=1,++ae),zt=1;zt<q;zt++)se[ne]!==se[ne+1]&&(vt[zt]=se[ne]?2:1,++ae),ne++;for(se[ne]!==0&&(vt[zt]=2,++ae),kt=1;kt<G;kt++){ne=kt*te,Qt=kt*_t,se[ne-te]!==se[ne]&&(vt[Qt]=se[ne]?1:8,++ae);let St=(se[ne]?4:0)+(se[ne-te]?8:0);for(zt=1;zt<q;zt++)St=(St>>2)+(se[ne+1]?4:0)+(se[ne-te+1]?8:0),mt[St]&&(vt[Qt+zt]=mt[St],++ae),ne++;if(se[ne-te]!==se[ne]&&(vt[Qt+zt]=se[ne]?2:4,++ae),ae>tt)return null}for(ne=te*(G-1),Qt=kt*_t,se[ne]!==0&&(vt[Qt]=8,++ae),zt=1;zt<q;zt++)se[ne]!==se[ne+1]&&(vt[Qt+zt]=se[ne]?4:8,++ae),ne++;if(se[ne]!==0&&(vt[Qt+zt]=4,++ae),ae>tt)return null;const $t=new Int32Array([0,_t,-1,0,-_t,0,0,0,1]),Ut=new Path2D;for(kt=0;ae&&kt<=G;kt++){let St=kt*_t;const It=St+q;for(;St<It&&!vt[St];)St++;if(St===It)continue;Ut.moveTo(St%_t,kt);const jt=St;let Zt=vt[St];do{const re=$t[Zt];do St+=re;while(!vt[St]);const oe=vt[St];oe!==5&&oe!==10?(Zt=oe,vt[St]=0):(Zt=oe&51*Zt>>4,vt[St]&=Zt>>2|Zt<<2),Ut.lineTo(St%_t,St/_t|0),vt[St]||--ae}while(jt!==St);--kt}return se=null,vt=null,function(St){St.save(),St.scale(1/q,-1/G),St.translate(0,-G),St.fill(Ut),St.beginPath(),St.restore()}}class it{constructor(q,G){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=F.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=F.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=F.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,q,G])}clone(){const q=Object.create(this);return q.clipBox=this.clipBox.slice(),q}setCurrentPoint(q,G){this.x=q,this.y=G}updatePathMinMax(q,G,tt){[G,tt]=F.Util.applyTransform([G,tt],q),this.minX=Math.min(this.minX,G),this.minY=Math.min(this.minY,tt),this.maxX=Math.max(this.maxX,G),this.maxY=Math.max(this.maxY,tt)}updateRectMinMax(q,G){const tt=F.Util.applyTransform(G,q),mt=F.Util.applyTransform(G.slice(2),q);this.minX=Math.min(this.minX,tt[0],mt[0]),this.minY=Math.min(this.minY,tt[1],mt[1]),this.maxX=Math.max(this.maxX,tt[0],mt[0]),this.maxY=Math.max(this.maxY,tt[1],mt[1])}updateScalingPathMinMax(q,G){F.Util.scaleMinMax(q,G),this.minX=Math.min(this.minX,G[0]),this.maxX=Math.max(this.maxX,G[1]),this.minY=Math.min(this.minY,G[2]),this.maxY=Math.max(this.maxY,G[3])}updateCurvePathMinMax(q,G,tt,mt,_t,vt,kt,zt,Qt,te){const se=F.Util.bezierBoundingBox(G,tt,mt,_t,vt,kt,zt,Qt);if(te){te[0]=Math.min(te[0],se[0],se[2]),te[1]=Math.max(te[1],se[0],se[2]),te[2]=Math.min(te[2],se[1],se[3]),te[3]=Math.max(te[3],se[1],se[3]);return}this.updateRectMinMax(q,se)}getPathBoundingBox(q=yt.PathType.FILL,G=null){const tt=[this.minX,this.minY,this.maxX,this.maxY];if(q===yt.PathType.STROKE){G||(0,F.unreachable)("Stroke bounding box must include transform.");const mt=F.Util.singularValueDecompose2dScale(G),_t=mt[0]*this.lineWidth/2,vt=mt[1]*this.lineWidth/2;tt[0]-=_t,tt[1]-=vt,tt[2]+=_t,tt[3]+=vt}return tt}updateClipFromPath(){const q=F.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(q||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(q){this.clipBox=q,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(q=yt.PathType.FILL,G=null){return F.Util.intersect(this.clipBox,this.getPathBoundingBox(q,G))}}function xt(ht,q){if(typeof ImageData<"u"&&q instanceof ImageData){ht.putImageData(q,0,0);return}const G=q.height,tt=q.width,mt=G%at,_t=(G-mt)/at,vt=mt===0?_t:_t+1,kt=ht.createImageData(tt,at);let zt=0,Qt;const te=q.data,se=kt.data;let ne,ae,$t,Ut;if(q.kind===F.ImageKind.GRAYSCALE_1BPP){const st=te.byteLength,St=new Uint32Array(se.buffer,0,se.byteLength>>2),It=St.length,jt=tt+7>>3,Zt=4294967295,re=F.FeatureTest.isLittleEndian?4278190080:255;for(ne=0;ne<vt;ne++){for($t=ne<_t?at:mt,Qt=0,ae=0;ae<$t;ae++){const oe=st-zt;let Ot=0;const he=oe>jt?tt:oe*8-7,de=he&-8;let Ce=0,xe=0;for(;Ot<de;Ot+=8)xe=te[zt++],St[Qt++]=xe&128?Zt:re,St[Qt++]=xe&64?Zt:re,St[Qt++]=xe&32?Zt:re,St[Qt++]=xe&16?Zt:re,St[Qt++]=xe&8?Zt:re,St[Qt++]=xe&4?Zt:re,St[Qt++]=xe&2?Zt:re,St[Qt++]=xe&1?Zt:re;for(;Ot<he;Ot++)Ce===0&&(xe=te[zt++],Ce=128),St[Qt++]=xe&Ce?Zt:re,Ce>>=1}for(;Qt<It;)St[Qt++]=0;ht.putImageData(kt,0,ne*at)}}else if(q.kind===F.ImageKind.RGBA_32BPP){for(ae=0,Ut=tt*at*4,ne=0;ne<_t;ne++)se.set(te.subarray(zt,zt+Ut)),zt+=Ut,ht.putImageData(kt,0,ae),ae+=at;ne<vt&&(Ut=tt*mt*4,se.set(te.subarray(zt,zt+Ut)),ht.putImageData(kt,0,ae))}else if(q.kind===F.ImageKind.RGB_24BPP)for($t=at,Ut=tt*$t,ne=0;ne<vt;ne++){for(ne>=_t&&($t=mt,Ut=tt*$t),Qt=0,ae=Ut;ae--;)se[Qt++]=te[zt++],se[Qt++]=te[zt++],se[Qt++]=te[zt++],se[Qt++]=255;ht.putImageData(kt,0,ne*at)}else throw new Error(`bad image kind: ${q.kind}`)}function ot(ht,q){if(q.bitmap){ht.drawImage(q.bitmap,0,0);return}const G=q.height,tt=q.width,mt=G%at,_t=(G-mt)/at,vt=mt===0?_t:_t+1,kt=ht.createImageData(tt,at);let zt=0;const Qt=q.data,te=kt.data;for(let se=0;se<vt;se++){const ne=se<_t?at:mt;({srcPos:zt}=(0,dt.convertBlackAndWhiteToRGBA)({src:Qt,srcPos:zt,dest:te,width:tt,height:ne,nonBlackColor:0})),ht.putImageData(kt,0,se*at)}}function Y(ht,q){const G=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const tt of G)ht[tt]!==void 0&&(q[tt]=ht[tt]);ht.setLineDash!==void 0&&(q.setLineDash(ht.getLineDash()),q.lineDashOffset=ht.lineDashOffset)}function W(ht){if(ht.strokeStyle=ht.fillStyle="#000000",ht.fillRule="nonzero",ht.globalAlpha=1,ht.lineWidth=1,ht.lineCap="butt",ht.lineJoin="miter",ht.miterLimit=10,ht.globalCompositeOperation="source-over",ht.font="10px sans-serif",ht.setLineDash!==void 0&&(ht.setLineDash([]),ht.lineDashOffset=0),!F.isNodeJS){const{filter:q}=ht;q!=="none"&&q!==""&&(ht.filter="none")}}function O(ht,q,G,tt){const mt=ht.length;for(let _t=3;_t<mt;_t+=4){const vt=ht[_t];if(vt===0)ht[_t-3]=q,ht[_t-2]=G,ht[_t-1]=tt;else if(vt<255){const kt=255-vt;ht[_t-3]=ht[_t-3]*vt+q*kt>>8,ht[_t-2]=ht[_t-2]*vt+G*kt>>8,ht[_t-1]=ht[_t-1]*vt+tt*kt>>8}}}function nt(ht,q,G){const tt=ht.length,mt=1/255;for(let _t=3;_t<tt;_t+=4){const vt=G?G[ht[_t]]:ht[_t];q[_t]=q[_t]*vt*mt|0}}function J(ht,q,G){const tt=ht.length;for(let mt=3;mt<tt;mt+=4){const _t=ht[mt-3]*77+ht[mt-2]*152+ht[mt-1]*28;q[mt]=G?q[mt]*G[_t>>8]>>8:q[mt]*_t>>16}}function Ft(ht,q,G,tt,mt,_t,vt,kt,zt,Qt,te){const se=!!_t,ne=se?_t[0]:0,ae=se?_t[1]:0,$t=se?_t[2]:0,Ut=mt==="Luminosity"?J:nt,St=Math.min(tt,Math.ceil(1048576/G));for(let It=0;It<tt;It+=St){const jt=Math.min(St,tt-It),Zt=ht.getImageData(kt-Qt,It+(zt-te),G,jt),re=q.getImageData(kt,It+zt,G,jt);se&&O(Zt.data,ne,ae,$t),Ut(Zt.data,re.data,vt),q.putImageData(re,kt,It+zt)}}function K(ht,q,G,tt){const mt=tt[0],_t=tt[1],vt=tt[2]-mt,kt=tt[3]-_t;vt===0||kt===0||(Ft(q.context,G,vt,kt,q.subtype,q.backdrop,q.transferMap,mt,_t,q.offsetX,q.offsetY),ht.save(),ht.globalAlpha=1,ht.globalCompositeOperation="source-over",ht.setTransform(1,0,0,1,0,0),ht.drawImage(G.canvas,0,0),ht.restore())}function pt(ht,q){const G=F.Util.singularValueDecompose2dScale(ht);G[0]=Math.fround(G[0]),G[1]=Math.fround(G[1]);const tt=Math.fround((globalThis.devicePixelRatio||1)*U.PixelsPerInch.PDF_TO_CSS_UNITS);return q!==void 0?q:G[0]<=tt||G[1]<=tt}const Tt=["butt","round","square"],Xt=["miter","round","bevel"],Lt={},Bt={},Nt=class Nt{constructor(q,G,tt,mt,_t,{optionalContentConfig:vt,markedContentStack:kt=null},zt,Qt){Ht(this,Vt);this.ctx=q,this.current=new it(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=G,this.objs=tt,this.canvasFactory=mt,this.filterFactory=_t,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=kt||[],this.optionalContentConfig=vt,this.cachedCanvases=new gt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=zt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Qt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(q,G=null){return typeof q=="string"?q.startsWith("g_")?this.commonObjs.get(q):this.objs.get(q):G}beginDrawing({transform:q,viewport:G,transparency:tt=!1,background:mt=null}){const _t=this.ctx.canvas.width,vt=this.ctx.canvas.height,kt=this.ctx.fillStyle;if(this.ctx.fillStyle=mt||"#ffffff",this.ctx.fillRect(0,0,_t,vt),this.ctx.fillStyle=kt,tt){const zt=this.cachedCanvases.getCanvas("transparent",_t,vt);this.compositeCtx=this.ctx,this.transparentCanvas=zt.canvas,this.ctx=zt.context,this.ctx.save(),this.ctx.transform(...(0,U.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),W(this.ctx),q&&(this.ctx.transform(...q),this.outputScaleX=q[0],this.outputScaleY=q[0]),this.ctx.transform(...G.transform),this.viewportScale=G.scale,this.baseTransform=(0,U.getCurrentTransform)(this.ctx)}executeOperatorList(q,G,tt,mt){const _t=q.argsArray,vt=q.fnArray;let kt=G||0;const zt=_t.length;if(zt===kt)return kt;const Qt=zt-kt>bt&&typeof tt=="function",te=Qt?Date.now()+Z:0;let se=0;const ne=this.commonObjs,ae=this.objs;let $t;for(;;){if(mt!==void 0&&kt===mt.nextBreakPoint)return mt.breakIt(kt,tt),kt;if($t=vt[kt],$t!==F.OPS.dependency)this[$t].apply(this,_t[kt]);else for(const Ut of _t[kt]){const st=Ut.startsWith("g_")?ne:ae;if(!st.has(Ut))return st.get(Ut,tt),kt}if(kt++,kt===zt)return kt;if(Qt&&++se>bt){if(Date.now()>te)return tt(),kt;se=0}}}endDrawing(){Rt(this,Vt,Fs).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const q of this._cachedBitmapsMap.values()){for(const G of q.values())typeof HTMLCanvasElement<"u"&&G instanceof HTMLCanvasElement&&(G.width=G.height=0);q.clear()}this._cachedBitmapsMap.clear(),Rt(this,Vt,Ds).call(this)}_scaleImage(q,G){const tt=q.width,mt=q.height;let _t=Math.max(Math.hypot(G[0],G[1]),1),vt=Math.max(Math.hypot(G[2],G[3]),1),kt=tt,zt=mt,Qt="prescale1",te,se;for(;_t>2&&kt>1||vt>2&&zt>1;){let ne=kt,ae=zt;_t>2&&kt>1&&(ne=kt>=16384?Math.floor(kt/2)-1||1:Math.ceil(kt/2),_t/=kt/ne),vt>2&&zt>1&&(ae=zt>=16384?Math.floor(zt/2)-1||1:Math.ceil(zt)/2,vt/=zt/ae),te=this.cachedCanvases.getCanvas(Qt,ne,ae),se=te.context,se.clearRect(0,0,ne,ae),se.drawImage(q,0,0,kt,zt,0,0,ne,ae),q=te.canvas,kt=ne,zt=ae,Qt=Qt==="prescale1"?"prescale2":"prescale1"}return{img:q,paintWidth:kt,paintHeight:zt}}_createMaskCanvas(q){const G=this.ctx,{width:tt,height:mt}=q,_t=this.current.fillColor,vt=this.current.patternFill,kt=(0,U.getCurrentTransform)(G);let zt,Qt,te,se;if((q.bitmap||q.data)&&q.count>1){const Ot=q.bitmap||q.data.buffer;Qt=JSON.stringify(vt?kt:[kt.slice(0,4),_t]),zt=this._cachedBitmapsMap.get(Ot),zt||(zt=new Map,this._cachedBitmapsMap.set(Ot,zt));const he=zt.get(Qt);if(he&&!vt){const de=Math.round(Math.min(kt[0],kt[2])+kt[4]),Ce=Math.round(Math.min(kt[1],kt[3])+kt[5]);return{canvas:he,offsetX:de,offsetY:Ce}}te=he}te||(se=this.cachedCanvases.getCanvas("maskCanvas",tt,mt),ot(se.context,q));let ne=F.Util.transform(kt,[1/tt,0,0,-1/mt,0,0]);ne=F.Util.transform(ne,[1,0,0,1,0,-mt]);const ae=F.Util.applyTransform([0,0],ne),$t=F.Util.applyTransform([tt,mt],ne),Ut=F.Util.normalizeRect([ae[0],ae[1],$t[0],$t[1]]),st=Math.round(Ut[2]-Ut[0])||1,St=Math.round(Ut[3]-Ut[1])||1,It=this.cachedCanvases.getCanvas("fillCanvas",st,St),jt=It.context,Zt=Math.min(ae[0],$t[0]),re=Math.min(ae[1],$t[1]);jt.translate(-Zt,-re),jt.transform(...ne),te||(te=this._scaleImage(se.canvas,(0,U.getCurrentTransformInverse)(jt)),te=te.img,zt&&vt&&zt.set(Qt,te)),jt.imageSmoothingEnabled=pt((0,U.getCurrentTransform)(jt),q.interpolate),et(jt,te,0,0,te.width,te.height,0,0,tt,mt),jt.globalCompositeOperation="source-in";const oe=F.Util.transform((0,U.getCurrentTransformInverse)(jt),[1,0,0,1,-Zt,-re]);return jt.fillStyle=vt?_t.getPattern(G,this,oe,yt.PathType.FILL):_t,jt.fillRect(0,0,tt,mt),zt&&!vt&&(this.cachedCanvases.delete("fillCanvas"),zt.set(Qt,It.canvas)),{canvas:It.canvas,offsetX:Math.round(Zt),offsetY:Math.round(re)}}setLineWidth(q){q!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=q,this.ctx.lineWidth=q}setLineCap(q){this.ctx.lineCap=Tt[q]}setLineJoin(q){this.ctx.lineJoin=Xt[q]}setMiterLimit(q){this.ctx.miterLimit=q}setDash(q,G){const tt=this.ctx;tt.setLineDash!==void 0&&(tt.setLineDash(q),tt.lineDashOffset=G)}setRenderingIntent(q){}setFlatness(q){}setGState(q){for(const[G,tt]of q)switch(G){case"LW":this.setLineWidth(tt);break;case"LC":this.setLineCap(tt);break;case"LJ":this.setLineJoin(tt);break;case"ML":this.setMiterLimit(tt);break;case"D":this.setDash(tt[0],tt[1]);break;case"RI":this.setRenderingIntent(tt);break;case"FL":this.setFlatness(tt);break;case"Font":this.setFont(tt[0],tt[1]);break;case"CA":this.current.strokeAlpha=tt;break;case"ca":this.current.fillAlpha=tt,this.ctx.globalAlpha=tt;break;case"BM":this.ctx.globalCompositeOperation=tt;break;case"SMask":this.current.activeSMask=tt?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(tt);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const q=this.inSMaskMode;this.current.activeSMask&&!q?this.beginSMaskMode():!this.current.activeSMask&&q&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const q=this.ctx.canvas.width,G=this.ctx.canvas.height,tt="smaskGroupAt"+this.groupLevel,mt=this.cachedCanvases.getCanvas(tt,q,G);this.suspendedCtx=this.ctx,this.ctx=mt.context;const _t=this.ctx;_t.setTransform(...(0,U.getCurrentTransform)(this.suspendedCtx)),Y(this.suspendedCtx,_t),lt(_t,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Y(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(q){if(!this.current.activeSMask)return;q?(q[0]=Math.floor(q[0]),q[1]=Math.floor(q[1]),q[2]=Math.ceil(q[2]),q[3]=Math.ceil(q[3])):q=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const G=this.current.activeSMask,tt=this.suspendedCtx;K(tt,G,this.ctx,q),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Y(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const q=this.current;this.stateStack.push(q),this.current=q.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Y(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(q,G,tt,mt,_t,vt){this.ctx.transform(q,G,tt,mt,_t,vt),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(q,G,tt){const mt=this.ctx,_t=this.current;let vt=_t.x,kt=_t.y,zt,Qt;const te=(0,U.getCurrentTransform)(mt),se=te[0]===0&&te[3]===0||te[1]===0&&te[2]===0,ne=se?tt.slice(0):null;for(let ae=0,$t=0,Ut=q.length;ae<Ut;ae++)switch(q[ae]|0){case F.OPS.rectangle:vt=G[$t++],kt=G[$t++];const st=G[$t++],St=G[$t++],It=vt+st,jt=kt+St;mt.moveTo(vt,kt),st===0||St===0?mt.lineTo(It,jt):(mt.lineTo(It,kt),mt.lineTo(It,jt),mt.lineTo(vt,jt)),se||_t.updateRectMinMax(te,[vt,kt,It,jt]),mt.closePath();break;case F.OPS.moveTo:vt=G[$t++],kt=G[$t++],mt.moveTo(vt,kt),se||_t.updatePathMinMax(te,vt,kt);break;case F.OPS.lineTo:vt=G[$t++],kt=G[$t++],mt.lineTo(vt,kt),se||_t.updatePathMinMax(te,vt,kt);break;case F.OPS.curveTo:zt=vt,Qt=kt,vt=G[$t+4],kt=G[$t+5],mt.bezierCurveTo(G[$t],G[$t+1],G[$t+2],G[$t+3],vt,kt),_t.updateCurvePathMinMax(te,zt,Qt,G[$t],G[$t+1],G[$t+2],G[$t+3],vt,kt,ne),$t+=6;break;case F.OPS.curveTo2:zt=vt,Qt=kt,mt.bezierCurveTo(vt,kt,G[$t],G[$t+1],G[$t+2],G[$t+3]),_t.updateCurvePathMinMax(te,zt,Qt,vt,kt,G[$t],G[$t+1],G[$t+2],G[$t+3],ne),vt=G[$t+2],kt=G[$t+3],$t+=4;break;case F.OPS.curveTo3:zt=vt,Qt=kt,vt=G[$t+2],kt=G[$t+3],mt.bezierCurveTo(G[$t],G[$t+1],vt,kt,vt,kt),_t.updateCurvePathMinMax(te,zt,Qt,G[$t],G[$t+1],vt,kt,vt,kt,ne),$t+=4;break;case F.OPS.closePath:mt.closePath();break}se&&_t.updateScalingPathMinMax(te,ne),_t.setCurrentPoint(vt,kt)}closePath(){this.ctx.closePath()}stroke(q=!0){const G=this.ctx,tt=this.current.strokeColor;G.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof tt=="object"&&tt?.getPattern?(G.save(),G.strokeStyle=tt.getPattern(G,this,(0,U.getCurrentTransformInverse)(G),yt.PathType.STROKE),this.rescaleAndStroke(!1),G.restore()):this.rescaleAndStroke(!0)),q&&this.consumePath(this.current.getClippedPathBoundingBox()),G.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(q=!0){const G=this.ctx,tt=this.current.fillColor,mt=this.current.patternFill;let _t=!1;mt&&(G.save(),G.fillStyle=tt.getPattern(G,this,(0,U.getCurrentTransformInverse)(G),yt.PathType.FILL),_t=!0);const vt=this.current.getClippedPathBoundingBox();this.contentVisible&&vt!==null&&(this.pendingEOFill?(G.fill("evenodd"),this.pendingEOFill=!1):G.fill()),_t&&G.restore(),q&&this.consumePath(vt)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Lt}eoClip(){this.pendingClip=Bt}beginText(){this.current.textMatrix=F.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const q=this.pendingTextPaths,G=this.ctx;if(q===void 0){G.beginPath();return}G.save(),G.beginPath();for(const tt of q)G.setTransform(...tt.transform),G.translate(tt.x,tt.y),tt.addToPath(G,tt.fontSize);G.restore(),G.clip(),G.beginPath(),delete this.pendingTextPaths}setCharSpacing(q){this.current.charSpacing=q}setWordSpacing(q){this.current.wordSpacing=q}setHScale(q){this.current.textHScale=q/100}setLeading(q){this.current.leading=-q}setFont(q,G){const tt=this.commonObjs.get(q),mt=this.current;if(!tt)throw new Error(`Can't find font for ${q}`);if(mt.fontMatrix=tt.fontMatrix||F.FONT_IDENTITY_MATRIX,(mt.fontMatrix[0]===0||mt.fontMatrix[3]===0)&&(0,F.warn)("Invalid font matrix for font "+q),G<0?(G=-G,mt.fontDirection=-1):mt.fontDirection=1,this.current.font=tt,this.current.fontSize=G,tt.isType3Font)return;const _t=tt.loadedName||"sans-serif",vt=tt.systemFontInfo?.css||`"${_t}", ${tt.fallbackName}`;let kt="normal";tt.black?kt="900":tt.bold&&(kt="bold");const zt=tt.italic?"italic":"normal";let Qt=G;G<Yt?Qt=Yt:G>At&&(Qt=At),this.current.fontSizeScale=G/Qt,this.ctx.font=`${zt} ${kt} ${Qt}px ${vt}`}setTextRenderingMode(q){this.current.textRenderingMode=q}setTextRise(q){this.current.textRise=q}moveText(q,G){this.current.x=this.current.lineX+=q,this.current.y=this.current.lineY+=G}setLeadingMoveText(q,G){this.setLeading(-G),this.moveText(q,G)}setTextMatrix(q,G,tt,mt,_t,vt){this.current.textMatrix=[q,G,tt,mt,_t,vt],this.current.textMatrixScale=Math.hypot(q,G),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(q,G,tt,mt){const _t=this.ctx,vt=this.current,kt=vt.font,zt=vt.textRenderingMode,Qt=vt.fontSize/vt.fontSizeScale,te=zt&F.TextRenderingMode.FILL_STROKE_MASK,se=!!(zt&F.TextRenderingMode.ADD_TO_PATH_FLAG),ne=vt.patternFill&&!kt.missingFile;let ae;(kt.disableFontFace||se||ne)&&(ae=kt.getPathGenerator(this.commonObjs,q)),kt.disableFontFace||ne?(_t.save(),_t.translate(G,tt),_t.beginPath(),ae(_t,Qt),mt&&_t.setTransform(...mt),(te===F.TextRenderingMode.FILL||te===F.TextRenderingMode.FILL_STROKE)&&_t.fill(),(te===F.TextRenderingMode.STROKE||te===F.TextRenderingMode.FILL_STROKE)&&_t.stroke(),_t.restore()):((te===F.TextRenderingMode.FILL||te===F.TextRenderingMode.FILL_STROKE)&&_t.fillText(q,G,tt),(te===F.TextRenderingMode.STROKE||te===F.TextRenderingMode.FILL_STROKE)&&_t.strokeText(q,G,tt)),se&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,U.getCurrentTransform)(_t),x:G,y:tt,fontSize:Qt,addToPath:ae})}get isFontSubpixelAAEnabled(){const{context:q}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);q.scale(1.5,1),q.fillText("I",0,10);const G=q.getImageData(0,0,10,10).data;let tt=!1;for(let mt=3;mt<G.length;mt+=4)if(G[mt]>0&&G[mt]<255){tt=!0;break}return(0,F.shadow)(this,"isFontSubpixelAAEnabled",tt)}showText(q){const G=this.current,tt=G.font;if(tt.isType3Font)return this.showType3Text(q);const mt=G.fontSize;if(mt===0)return;const _t=this.ctx,vt=G.fontSizeScale,kt=G.charSpacing,zt=G.wordSpacing,Qt=G.fontDirection,te=G.textHScale*Qt,se=q.length,ne=tt.vertical,ae=ne?1:-1,$t=tt.defaultVMetrics,Ut=mt*G.fontMatrix[0],st=G.textRenderingMode===F.TextRenderingMode.FILL&&!tt.disableFontFace&&!G.patternFill;_t.save(),_t.transform(...G.textMatrix),_t.translate(G.x,G.y+G.textRise),Qt>0?_t.scale(te,-1):_t.scale(te,1);let St;if(G.patternFill){_t.save();const oe=G.fillColor.getPattern(_t,this,(0,U.getCurrentTransformInverse)(_t),yt.PathType.FILL);St=(0,U.getCurrentTransform)(_t),_t.restore(),_t.fillStyle=oe}let It=G.lineWidth;const jt=G.textMatrixScale;if(jt===0||It===0){const oe=G.textRenderingMode&F.TextRenderingMode.FILL_STROKE_MASK;(oe===F.TextRenderingMode.STROKE||oe===F.TextRenderingMode.FILL_STROKE)&&(It=this.getSinglePixelWidth())}else It/=jt;if(vt!==1&&(_t.scale(vt,vt),It/=vt),_t.lineWidth=It,tt.isInvalidPDFjsFont){const oe=[];let Ot=0;for(const he of q)oe.push(he.unicode),Ot+=he.width;_t.fillText(oe.join(""),0,0),G.x+=Ot*Ut*te,_t.restore(),this.compose();return}let Zt=0,re;for(re=0;re<se;++re){const oe=q[re];if(typeof oe=="number"){Zt+=ae*oe*mt/1e3;continue}let Ot=!1;const he=(oe.isSpace?zt:0)+kt,de=oe.fontChar,Ce=oe.accent;let xe,Re,be=oe.width;if(ne){const ke=oe.vmetric||$t,Fe=-(oe.vmetric?ke[1]:be*.5)*Ut,le=ke[2]*Ut;be=ke?-ke[0]:be,xe=Fe/vt,Re=(Zt+le)/vt}else xe=Zt/vt,Re=0;if(tt.remeasure&&be>0){const ke=_t.measureText(de).width*1e3/mt*vt;if(be<ke&&this.isFontSubpixelAAEnabled){const Fe=be/ke;Ot=!0,_t.save(),_t.scale(Fe,1),xe/=Fe}else be!==ke&&(xe+=(be-ke)/2e3*mt/vt)}if(this.contentVisible&&(oe.isInFont||tt.missingFile)){if(st&&!Ce)_t.fillText(de,xe,Re);else if(this.paintChar(de,xe,Re,St),Ce){const ke=xe+mt*Ce.offset.x/vt,Fe=Re-mt*Ce.offset.y/vt;this.paintChar(Ce.fontChar,ke,Fe,St)}}const we=ne?be*Ut-he*Qt:be*Ut+he*Qt;Zt+=we,Ot&&_t.restore()}ne?G.y-=Zt:G.x+=Zt*te,_t.restore(),this.compose()}showType3Text(q){const G=this.ctx,tt=this.current,mt=tt.font,_t=tt.fontSize,vt=tt.fontDirection,kt=mt.vertical?1:-1,zt=tt.charSpacing,Qt=tt.wordSpacing,te=tt.textHScale*vt,se=tt.fontMatrix||F.FONT_IDENTITY_MATRIX,ne=q.length,ae=tt.textRenderingMode===F.TextRenderingMode.INVISIBLE;let $t,Ut,st,St;if(!(ae||_t===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,G.save(),G.transform(...tt.textMatrix),G.translate(tt.x,tt.y),G.scale(te,vt),$t=0;$t<ne;++$t){if(Ut=q[$t],typeof Ut=="number"){St=kt*Ut*_t/1e3,this.ctx.translate(St,0),tt.x+=St*te;continue}const It=(Ut.isSpace?Qt:0)+zt,jt=mt.charProcOperatorList[Ut.operatorListId];if(!jt){(0,F.warn)(`Type3 character "${Ut.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ut,this.save(),G.scale(_t,_t),G.transform(...se),this.executeOperatorList(jt),this.restore()),st=F.Util.applyTransform([Ut.width,0],se)[0]*_t+It,G.translate(st,0),tt.x+=st*te}G.restore(),this.processingType3=null}}setCharWidth(q,G){}setCharWidthAndBounds(q,G,tt,mt,_t,vt){this.ctx.rect(tt,mt,_t-tt,vt-mt),this.ctx.clip(),this.endPath()}getColorN_Pattern(q){let G;if(q[0]==="TilingPattern"){const tt=q[1],mt=this.baseTransform||(0,U.getCurrentTransform)(this.ctx),_t={createCanvasGraphics:vt=>new Nt(vt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};G=new yt.TilingPattern(q,tt,this.ctx,_t,mt)}else G=this._getPattern(q[1],q[2]);return G}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(q,G,tt){const mt=F.Util.makeHexColor(q,G,tt);this.ctx.strokeStyle=mt,this.current.strokeColor=mt}setFillRGBColor(q,G,tt){const mt=F.Util.makeHexColor(q,G,tt);this.ctx.fillStyle=mt,this.current.fillColor=mt,this.current.patternFill=!1}_getPattern(q,G=null){let tt;return this.cachedPatterns.has(q)?tt=this.cachedPatterns.get(q):(tt=(0,yt.getShadingPattern)(this.getObject(q)),this.cachedPatterns.set(q,tt)),G&&(tt.matrix=G),tt}shadingFill(q){if(!this.contentVisible)return;const G=this.ctx;this.save();const tt=this._getPattern(q);G.fillStyle=tt.getPattern(G,this,(0,U.getCurrentTransformInverse)(G),yt.PathType.SHADING);const mt=(0,U.getCurrentTransformInverse)(G);if(mt){const{width:_t,height:vt}=G.canvas,[kt,zt,Qt,te]=F.Util.getAxialAlignedBoundingBox([0,0,_t,vt],mt);this.ctx.fillRect(kt,zt,Qt-kt,te-zt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,F.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,F.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(q,G){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(q)&&q.length===6&&this.transform(...q),this.baseTransform=(0,U.getCurrentTransform)(this.ctx),G)){const tt=G[2]-G[0],mt=G[3]-G[1];this.ctx.rect(G[0],G[1],tt,mt),this.current.updateRectMinMax((0,U.getCurrentTransform)(this.ctx),G),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(q){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const G=this.ctx;q.isolated||(0,F.info)("TODO: Support non-isolated groups."),q.knockout&&(0,F.warn)("Knockout groups not supported.");const tt=(0,U.getCurrentTransform)(G);if(q.matrix&&G.transform(...q.matrix),!q.bbox)throw new Error("Bounding box is required.");let mt=F.Util.getAxialAlignedBoundingBox(q.bbox,(0,U.getCurrentTransform)(G));const _t=[0,0,G.canvas.width,G.canvas.height];mt=F.Util.intersect(mt,_t)||[0,0,0,0];const vt=Math.floor(mt[0]),kt=Math.floor(mt[1]);let zt=Math.max(Math.ceil(mt[2])-vt,1),Qt=Math.max(Math.ceil(mt[3])-kt,1),te=1,se=1;zt>ut&&(te=zt/ut,zt=ut),Qt>ut&&(se=Qt/ut,Qt=ut),this.current.startNewPathAndClipBox([0,0,zt,Qt]);let ne="groupAt"+this.groupLevel;q.smask&&(ne+="_smask_"+this.smaskCounter++%2);const ae=this.cachedCanvases.getCanvas(ne,zt,Qt),$t=ae.context;$t.scale(1/te,1/se),$t.translate(-vt,-kt),$t.transform(...tt),q.smask?this.smaskStack.push({canvas:ae.canvas,context:$t,offsetX:vt,offsetY:kt,scaleX:te,scaleY:se,subtype:q.smask.subtype,backdrop:q.smask.backdrop,transferMap:q.smask.transferMap||null,startTransformInverse:null}):(G.setTransform(1,0,0,1,0,0),G.translate(vt,kt),G.scale(te,se),G.save()),Y(G,$t),this.ctx=$t,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(G),this.groupLevel++}endGroup(q){if(!this.contentVisible)return;this.groupLevel--;const G=this.ctx,tt=this.groupStack.pop();if(this.ctx=tt,this.ctx.imageSmoothingEnabled=!1,q.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const mt=(0,U.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...mt);const _t=F.Util.getAxialAlignedBoundingBox([0,0,G.canvas.width,G.canvas.height],mt);this.ctx.drawImage(G.canvas,0,0),this.ctx.restore(),this.compose(_t)}}beginAnnotation(q,G,tt,mt,_t){if(Rt(this,Vt,Fs).call(this),W(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(G)&&G.length===4){const vt=G[2]-G[0],kt=G[3]-G[1];if(_t&&this.annotationCanvasMap){tt=tt.slice(),tt[4]-=G[0],tt[5]-=G[1],G=G.slice(),G[0]=G[1]=0,G[2]=vt,G[3]=kt;const[zt,Qt]=F.Util.singularValueDecompose2dScale((0,U.getCurrentTransform)(this.ctx)),{viewportScale:te}=this,se=Math.ceil(vt*this.outputScaleX*te),ne=Math.ceil(kt*this.outputScaleY*te);this.annotationCanvas=this.canvasFactory.create(se,ne);const{canvas:ae,context:$t}=this.annotationCanvas;this.annotationCanvasMap.set(q,ae),this.annotationCanvas.savedCtx=this.ctx,this.ctx=$t,this.ctx.save(),this.ctx.setTransform(zt,0,0,-Qt,0,kt*Qt),W(this.ctx)}else W(this.ctx),this.ctx.rect(G[0],G[1],vt,kt),this.ctx.clip(),this.endPath()}this.current=new it(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...tt),this.transform(...mt)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Rt(this,Vt,Ds).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(q){if(!this.contentVisible)return;const G=q.count;q=this.getObject(q.data,q),q.count=G;const tt=this.ctx,mt=this.processingType3;if(mt&&(mt.compiled===void 0&&(mt.compiled=Q(q)),mt.compiled)){mt.compiled(tt);return}const _t=this._createMaskCanvas(q),vt=_t.canvas;tt.save(),tt.setTransform(1,0,0,1,0,0),tt.drawImage(vt,_t.offsetX,_t.offsetY),tt.restore(),this.compose()}paintImageMaskXObjectRepeat(q,G,tt=0,mt=0,_t,vt){if(!this.contentVisible)return;q=this.getObject(q.data,q);const kt=this.ctx;kt.save();const zt=(0,U.getCurrentTransform)(kt);kt.transform(G,tt,mt,_t,0,0);const Qt=this._createMaskCanvas(q);kt.setTransform(1,0,0,1,Qt.offsetX-zt[4],Qt.offsetY-zt[5]);for(let te=0,se=vt.length;te<se;te+=2){const ne=F.Util.transform(zt,[G,tt,mt,_t,vt[te],vt[te+1]]),[ae,$t]=F.Util.applyTransform([0,0],ne);kt.drawImage(Qt.canvas,ae,$t)}kt.restore(),this.compose()}paintImageMaskXObjectGroup(q){if(!this.contentVisible)return;const G=this.ctx,tt=this.current.fillColor,mt=this.current.patternFill;for(const _t of q){const{data:vt,width:kt,height:zt,transform:Qt}=_t,te=this.cachedCanvases.getCanvas("maskCanvas",kt,zt),se=te.context;se.save();const ne=this.getObject(vt,_t);ot(se,ne),se.globalCompositeOperation="source-in",se.fillStyle=mt?tt.getPattern(se,this,(0,U.getCurrentTransformInverse)(G),yt.PathType.FILL):tt,se.fillRect(0,0,kt,zt),se.restore(),G.save(),G.transform(...Qt),G.scale(1,-1),et(G,te.canvas,0,0,kt,zt,0,-1,1,1),G.restore()}this.compose()}paintImageXObject(q){if(!this.contentVisible)return;const G=this.getObject(q);if(!G){(0,F.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(G)}paintImageXObjectRepeat(q,G,tt,mt){if(!this.contentVisible)return;const _t=this.getObject(q);if(!_t){(0,F.warn)("Dependent image isn't ready yet");return}const vt=_t.width,kt=_t.height,zt=[];for(let Qt=0,te=mt.length;Qt<te;Qt+=2)zt.push({transform:[G,0,0,tt,mt[Qt],mt[Qt+1]],x:0,y:0,w:vt,h:kt});this.paintInlineImageXObjectGroup(_t,zt)}applyTransferMapsToCanvas(q){return this.current.transferMaps!=="none"&&(q.filter=this.current.transferMaps,q.drawImage(q.canvas,0,0),q.filter="none"),q.canvas}applyTransferMapsToBitmap(q){if(this.current.transferMaps==="none")return q.bitmap;const{bitmap:G,width:tt,height:mt}=q,_t=this.cachedCanvases.getCanvas("inlineImage",tt,mt),vt=_t.context;return vt.filter=this.current.transferMaps,vt.drawImage(G,0,0),vt.filter="none",_t.canvas}paintInlineImageXObject(q){if(!this.contentVisible)return;const G=q.width,tt=q.height,mt=this.ctx;if(this.save(),!F.isNodeJS){const{filter:kt}=mt;kt!=="none"&&kt!==""&&(mt.filter="none")}mt.scale(1/G,-1/tt);let _t;if(q.bitmap)_t=this.applyTransferMapsToBitmap(q);else if(typeof HTMLElement=="function"&&q instanceof HTMLElement||!q.data)_t=q;else{const zt=this.cachedCanvases.getCanvas("inlineImage",G,tt).context;xt(zt,q),_t=this.applyTransferMapsToCanvas(zt)}const vt=this._scaleImage(_t,(0,U.getCurrentTransformInverse)(mt));mt.imageSmoothingEnabled=pt((0,U.getCurrentTransform)(mt),q.interpolate),et(mt,vt.img,0,0,vt.paintWidth,vt.paintHeight,0,-tt,G,tt),this.compose(),this.restore()}paintInlineImageXObjectGroup(q,G){if(!this.contentVisible)return;const tt=this.ctx;let mt;if(q.bitmap)mt=q.bitmap;else{const _t=q.width,vt=q.height,zt=this.cachedCanvases.getCanvas("inlineImage",_t,vt).context;xt(zt,q),mt=this.applyTransferMapsToCanvas(zt)}for(const _t of G)tt.save(),tt.transform(..._t.transform),tt.scale(1,-1),et(tt,mt,_t.x,_t.y,_t.w,_t.h,0,-1,1,1),tt.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(q){}markPointProps(q,G){}beginMarkedContent(q){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(q,G){q==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(G)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(q){const G=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(q);const tt=this.ctx;this.pendingClip&&(G||(this.pendingClip===Bt?tt.clip("evenodd"):tt.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),tt.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const q=(0,U.getCurrentTransform)(this.ctx);if(q[1]===0&&q[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(q[0]),Math.abs(q[3]));else{const G=Math.abs(q[0]*q[3]-q[2]*q[1]),tt=Math.hypot(q[0],q[2]),mt=Math.hypot(q[1],q[3]);this._cachedGetSinglePixelWidth=Math.max(tt,mt)/G}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:q}=this.current,{a:G,b:tt,c:mt,d:_t}=this.ctx.getTransform();let vt,kt;if(tt===0&&mt===0){const zt=Math.abs(G),Qt=Math.abs(_t);if(zt===Qt)if(q===0)vt=kt=1/zt;else{const te=zt*q;vt=kt=te<1?1/te:1}else if(q===0)vt=1/zt,kt=1/Qt;else{const te=zt*q,se=Qt*q;vt=te<1?1/te:1,kt=se<1?1/se:1}}else{const zt=Math.abs(G*_t-tt*mt),Qt=Math.hypot(G,tt),te=Math.hypot(mt,_t);if(q===0)vt=te/zt,kt=Qt/zt;else{const se=q*zt;vt=te>se?te/se:1,kt=Qt>se?Qt/se:1}}this._cachedScaleForStroking[0]=vt,this._cachedScaleForStroking[1]=kt}return this._cachedScaleForStroking}rescaleAndStroke(q){const{ctx:G}=this,{lineWidth:tt}=this.current,[mt,_t]=this.getScaleForStroking();if(G.lineWidth=tt||1,mt===1&&_t===1){G.stroke();return}const vt=G.getLineDash();if(q&&G.save(),G.scale(mt,_t),vt.length>0){const kt=Math.max(mt,_t);G.setLineDash(vt.map(zt=>zt/kt)),G.lineDashOffset/=kt}G.stroke(),q&&G.restore()}isContentVisible(){for(let q=this.markedContentStack.length-1;q>=0;q--)if(!this.markedContentStack[q].visible)return!1;return!0}};Vt=new WeakSet,Fs=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ds=function(){if(this.pageColors){const q=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(q!=="none"){const G=this.ctx.filter;this.ctx.filter=q,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=G}}};let Mt=Nt;w.CanvasGraphics=Mt;for(const ht in F.OPS)Mt.prototype[ht]!==void 0&&(Mt.prototype[F.OPS[ht]]=Mt.prototype[ht])},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.TilingPattern=w.PathType=void 0,w.getShadingPattern=at;var F=X(1),U=X(6);const yt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};w.PathType=yt;function dt(Q,it){if(!it)return;const xt=it[2]-it[0],ot=it[3]-it[1],Y=new Path2D;Y.rect(it[0],it[1],xt,ot),Q.clip(Y)}class Yt{constructor(){this.constructor===Yt&&(0,F.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,F.unreachable)("Abstract method `getPattern` called.")}}class At extends Yt{constructor(it){super(),this._type=it[1],this._bbox=it[2],this._colorStops=it[3],this._p0=it[4],this._p1=it[5],this._r0=it[6],this._r1=it[7],this.matrix=null}_createGradient(it){let xt;this._type==="axial"?xt=it.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(xt=it.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const ot of this._colorStops)xt.addColorStop(ot[0],ot[1]);return xt}getPattern(it,xt,ot,Y){let W;if(Y===yt.STROKE||Y===yt.FILL){const O=xt.current.getClippedPathBoundingBox(Y,(0,U.getCurrentTransform)(it))||[0,0,0,0],nt=Math.ceil(O[2]-O[0])||1,J=Math.ceil(O[3]-O[1])||1,Ft=xt.cachedCanvases.getCanvas("pattern",nt,J,!0),K=Ft.context;K.clearRect(0,0,K.canvas.width,K.canvas.height),K.beginPath(),K.rect(0,0,K.canvas.width,K.canvas.height),K.translate(-O[0],-O[1]),ot=F.Util.transform(ot,[1,0,0,1,O[0],O[1]]),K.transform(...xt.baseTransform),this.matrix&&K.transform(...this.matrix),dt(K,this._bbox),K.fillStyle=this._createGradient(K),K.fill(),W=it.createPattern(Ft.canvas,"no-repeat");const pt=new DOMMatrix(ot);W.setTransform(pt)}else dt(it,this._bbox),W=this._createGradient(it);return W}}function ut(Q,it,xt,ot,Y,W,O,nt){const J=it.coords,Ft=it.colors,K=Q.data,pt=Q.width*4;let Tt;J[xt+1]>J[ot+1]&&(Tt=xt,xt=ot,ot=Tt,Tt=W,W=O,O=Tt),J[ot+1]>J[Y+1]&&(Tt=ot,ot=Y,Y=Tt,Tt=O,O=nt,nt=Tt),J[xt+1]>J[ot+1]&&(Tt=xt,xt=ot,ot=Tt,Tt=W,W=O,O=Tt);const Xt=(J[xt]+it.offsetX)*it.scaleX,Lt=(J[xt+1]+it.offsetY)*it.scaleY,Bt=(J[ot]+it.offsetX)*it.scaleX,Mt=(J[ot+1]+it.offsetY)*it.scaleY,Vt=(J[Y]+it.offsetX)*it.scaleX,Et=(J[Y+1]+it.offsetY)*it.scaleY;if(Lt>=Et)return;const Dt=Ft[W],Nt=Ft[W+1],ht=Ft[W+2],q=Ft[O],G=Ft[O+1],tt=Ft[O+2],mt=Ft[nt],_t=Ft[nt+1],vt=Ft[nt+2],kt=Math.round(Lt),zt=Math.round(Et);let Qt,te,se,ne,ae,$t,Ut,st;for(let St=kt;St<=zt;St++){if(St<Mt){const oe=St<Lt?0:(Lt-St)/(Lt-Mt);Qt=Xt-(Xt-Bt)*oe,te=Dt-(Dt-q)*oe,se=Nt-(Nt-G)*oe,ne=ht-(ht-tt)*oe}else{let oe;St>Et?oe=1:Mt===Et?oe=0:oe=(Mt-St)/(Mt-Et),Qt=Bt-(Bt-Vt)*oe,te=q-(q-mt)*oe,se=G-(G-_t)*oe,ne=tt-(tt-vt)*oe}let It;St<Lt?It=0:St>Et?It=1:It=(Lt-St)/(Lt-Et),ae=Xt-(Xt-Vt)*It,$t=Dt-(Dt-mt)*It,Ut=Nt-(Nt-_t)*It,st=ht-(ht-vt)*It;const jt=Math.round(Math.min(Qt,ae)),Zt=Math.round(Math.max(Qt,ae));let re=pt*St+jt*4;for(let oe=jt;oe<=Zt;oe++)It=(Qt-oe)/(Qt-ae),It<0?It=0:It>1&&(It=1),K[re++]=te-(te-$t)*It|0,K[re++]=se-(se-Ut)*It|0,K[re++]=ne-(ne-st)*It|0,K[re++]=255}}function Z(Q,it,xt){const ot=it.coords,Y=it.colors;let W,O;switch(it.type){case"lattice":const nt=it.verticesPerRow,J=Math.floor(ot.length/nt)-1,Ft=nt-1;for(W=0;W<J;W++){let K=W*nt;for(let pt=0;pt<Ft;pt++,K++)ut(Q,xt,ot[K],ot[K+1],ot[K+nt],Y[K],Y[K+1],Y[K+nt]),ut(Q,xt,ot[K+nt+1],ot[K+1],ot[K+nt],Y[K+nt+1],Y[K+1],Y[K+nt])}break;case"triangles":for(W=0,O=ot.length;W<O;W+=3)ut(Q,xt,ot[W],ot[W+1],ot[W+2],Y[W],Y[W+1],Y[W+2]);break;default:throw new Error("illegal figure")}}class bt extends Yt{constructor(it){super(),this._coords=it[2],this._colors=it[3],this._figures=it[4],this._bounds=it[5],this._bbox=it[7],this._background=it[8],this.matrix=null}_createMeshCanvas(it,xt,ot){const nt=Math.floor(this._bounds[0]),J=Math.floor(this._bounds[1]),Ft=Math.ceil(this._bounds[2])-nt,K=Math.ceil(this._bounds[3])-J,pt=Math.min(Math.ceil(Math.abs(Ft*it[0]*1.1)),3e3),Tt=Math.min(Math.ceil(Math.abs(K*it[1]*1.1)),3e3),Xt=Ft/pt,Lt=K/Tt,Bt={coords:this._coords,colors:this._colors,offsetX:-nt,offsetY:-J,scaleX:1/Xt,scaleY:1/Lt},Mt=pt+2*2,Vt=Tt+2*2,Et=ot.getCanvas("mesh",Mt,Vt,!1),Dt=Et.context,Nt=Dt.createImageData(pt,Tt);if(xt){const q=Nt.data;for(let G=0,tt=q.length;G<tt;G+=4)q[G]=xt[0],q[G+1]=xt[1],q[G+2]=xt[2],q[G+3]=255}for(const q of this._figures)Z(Nt,q,Bt);return Dt.putImageData(Nt,2,2),{canvas:Et.canvas,offsetX:nt-2*Xt,offsetY:J-2*Lt,scaleX:Xt,scaleY:Lt}}getPattern(it,xt,ot,Y){dt(it,this._bbox);let W;if(Y===yt.SHADING)W=F.Util.singularValueDecompose2dScale((0,U.getCurrentTransform)(it));else if(W=F.Util.singularValueDecompose2dScale(xt.baseTransform),this.matrix){const nt=F.Util.singularValueDecompose2dScale(this.matrix);W=[W[0]*nt[0],W[1]*nt[1]]}const O=this._createMeshCanvas(W,Y===yt.SHADING?null:this._background,xt.cachedCanvases);return Y!==yt.SHADING&&(it.setTransform(...xt.baseTransform),this.matrix&&it.transform(...this.matrix)),it.translate(O.offsetX,O.offsetY),it.scale(O.scaleX,O.scaleY),it.createPattern(O.canvas,"no-repeat")}}class Ct extends Yt{getPattern(){return"hotpink"}}function at(Q){switch(Q[0]){case"RadialAxial":return new At(Q);case"Mesh":return new bt(Q);case"Dummy":return new Ct}throw new Error(`Unknown IR type: ${Q[0]}`)}const lt={COLORED:1,UNCOLORED:2},et=class et{constructor(it,xt,ot,Y,W){this.operatorList=it[2],this.matrix=it[3]||[1,0,0,1,0,0],this.bbox=it[4],this.xstep=it[5],this.ystep=it[6],this.paintType=it[7],this.tilingType=it[8],this.color=xt,this.ctx=ot,this.canvasGraphicsFactory=Y,this.baseTransform=W}createPatternCanvas(it){const xt=this.operatorList,ot=this.bbox,Y=this.xstep,W=this.ystep,O=this.paintType,nt=this.tilingType,J=this.color,Ft=this.canvasGraphicsFactory;(0,F.info)("TilingType: "+nt);const K=ot[0],pt=ot[1],Tt=ot[2],Xt=ot[3],Lt=F.Util.singularValueDecompose2dScale(this.matrix),Bt=F.Util.singularValueDecompose2dScale(this.baseTransform),Mt=[Lt[0]*Bt[0],Lt[1]*Bt[1]],Vt=this.getSizeAndScale(Y,this.ctx.canvas.width,Mt[0]),Et=this.getSizeAndScale(W,this.ctx.canvas.height,Mt[1]),Dt=it.cachedCanvases.getCanvas("pattern",Vt.size,Et.size,!0),Nt=Dt.context,ht=Ft.createCanvasGraphics(Nt);ht.groupLevel=it.groupLevel,this.setFillAndStrokeStyleToContext(ht,O,J);let q=K,G=pt,tt=Tt,mt=Xt;return K<0&&(q=0,tt+=Math.abs(K)),pt<0&&(G=0,mt+=Math.abs(pt)),Nt.translate(-(Vt.scale*q),-(Et.scale*G)),ht.transform(Vt.scale,0,0,Et.scale,0,0),Nt.save(),this.clipBbox(ht,q,G,tt,mt),ht.baseTransform=(0,U.getCurrentTransform)(ht.ctx),ht.executeOperatorList(xt),ht.endDrawing(),{canvas:Dt.canvas,scaleX:Vt.scale,scaleY:Et.scale,offsetX:q,offsetY:G}}getSizeAndScale(it,xt,ot){it=Math.abs(it);const Y=Math.max(et.MAX_PATTERN_SIZE,xt);let W=Math.ceil(it*ot);return W>=Y?W=Y:ot=W/it,{scale:ot,size:W}}clipBbox(it,xt,ot,Y,W){const O=Y-xt,nt=W-ot;it.ctx.rect(xt,ot,O,nt),it.current.updateRectMinMax((0,U.getCurrentTransform)(it.ctx),[xt,ot,Y,W]),it.clip(),it.endPath()}setFillAndStrokeStyleToContext(it,xt,ot){const Y=it.ctx,W=it.current;switch(xt){case lt.COLORED:const O=this.ctx;Y.fillStyle=O.fillStyle,Y.strokeStyle=O.strokeStyle,W.fillColor=O.fillStyle,W.strokeColor=O.strokeStyle;break;case lt.UNCOLORED:const nt=F.Util.makeHexColor(ot[0],ot[1],ot[2]);Y.fillStyle=nt,Y.strokeStyle=nt,W.fillColor=nt,W.strokeColor=nt;break;default:throw new F.FormatError(`Unsupported paint type: ${xt}`)}}getPattern(it,xt,ot,Y){let W=ot;Y!==yt.SHADING&&(W=F.Util.transform(W,xt.baseTransform),this.matrix&&(W=F.Util.transform(W,this.matrix)));const O=this.createPatternCanvas(xt);let nt=new DOMMatrix(W);nt=nt.translate(O.offsetX,O.offsetY),nt=nt.scale(1/O.scaleX,1/O.scaleY);const J=it.createPattern(O.canvas,"repeat");return J.setTransform(nt),J}};Oe(et,"MAX_PATTERN_SIZE",3e3);let gt=et;w.TilingPattern=gt},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.convertBlackAndWhiteToRGBA=yt,w.convertToRGBA=U,w.grayToRGBA=Yt;var F=X(1);function U(At){switch(At.kind){case F.ImageKind.GRAYSCALE_1BPP:return yt(At);case F.ImageKind.RGB_24BPP:return dt(At)}return null}function yt({src:At,srcPos:ut=0,dest:Z,width:bt,height:Ct,nonBlackColor:at=4294967295,inverseDecode:lt=!1}){const gt=F.FeatureTest.isLittleEndian?4278190080:255,[et,Q]=lt?[at,gt]:[gt,at],it=bt>>3,xt=bt&7,ot=At.length;Z=new Uint32Array(Z.buffer);let Y=0;for(let W=0;W<Ct;W++){for(const nt=ut+it;ut<nt;ut++){const J=ut<ot?At[ut]:255;Z[Y++]=J&128?Q:et,Z[Y++]=J&64?Q:et,Z[Y++]=J&32?Q:et,Z[Y++]=J&16?Q:et,Z[Y++]=J&8?Q:et,Z[Y++]=J&4?Q:et,Z[Y++]=J&2?Q:et,Z[Y++]=J&1?Q:et}if(xt===0)continue;const O=ut<ot?At[ut++]:255;for(let nt=0;nt<xt;nt++)Z[Y++]=O&1<<7-nt?Q:et}return{srcPos:ut,destPos:Y}}function dt({src:At,srcPos:ut=0,dest:Z,destPos:bt=0,width:Ct,height:at}){let lt=0;const gt=At.length>>2,et=new Uint32Array(At.buffer,ut,gt);if(F.FeatureTest.isLittleEndian){for(;lt<gt-2;lt+=3,bt+=4){const Q=et[lt],it=et[lt+1],xt=et[lt+2];Z[bt]=Q|4278190080,Z[bt+1]=Q>>>24|it<<8|4278190080,Z[bt+2]=it>>>16|xt<<16|4278190080,Z[bt+3]=xt>>>8|4278190080}for(let Q=lt*4,it=At.length;Q<it;Q+=3)Z[bt++]=At[Q]|At[Q+1]<<8|At[Q+2]<<16|4278190080}else{for(;lt<gt-2;lt+=3,bt+=4){const Q=et[lt],it=et[lt+1],xt=et[lt+2];Z[bt]=Q|255,Z[bt+1]=Q<<24|it>>>8|255,Z[bt+2]=it<<16|xt>>>16|255,Z[bt+3]=xt<<8|255}for(let Q=lt*4,it=At.length;Q<it;Q+=3)Z[bt++]=At[Q]<<24|At[Q+1]<<16|At[Q+2]<<8|255}return{srcPos:ut,destPos:bt}}function Yt(At,ut){if(F.FeatureTest.isLittleEndian)for(let Z=0,bt=At.length;Z<bt;Z++)ut[Z]=At[Z]*65793|4278190080;else for(let Z=0,bt=At.length;Z<bt;Z++)ut[Z]=At[Z]*16843008|255}},(rt,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.GlobalWorkerOptions=void 0;const X=Object.create(null);w.GlobalWorkerOptions=X,X.workerPort=null,X.workerSrc=""},(rt,w,X)=>{var At,hi,di,ls;Object.defineProperty(w,"__esModule",{value:!0}),w.MessageHandler=void 0;var F=X(1);const U={DATA:1,ERROR:2},yt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function dt(Ct){switch(Ct instanceof Error||typeof Ct=="object"&&Ct!==null||(0,F.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),Ct.name){case"AbortException":return new F.AbortException(Ct.message);case"MissingPDFException":return new F.MissingPDFException(Ct.message);case"PasswordException":return new F.PasswordException(Ct.message,Ct.code);case"UnexpectedResponseException":return new F.UnexpectedResponseException(Ct.message,Ct.status);case"UnknownErrorException":return new F.UnknownErrorException(Ct.message,Ct.details);default:return new F.UnknownErrorException(Ct.message,Ct.toString())}}class Yt{constructor(at,lt,gt){Ht(this,At);this.sourceName=at,this.targetName=lt,this.comObj=gt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=et=>{const Q=et.data;if(Q.targetName!==this.sourceName)return;if(Q.stream){Rt(this,At,di).call(this,Q);return}if(Q.callback){const xt=Q.callbackId,ot=this.callbackCapabilities[xt];if(!ot)throw new Error(`Cannot resolve callback ${xt}`);if(delete this.callbackCapabilities[xt],Q.callback===U.DATA)ot.resolve(Q.data);else if(Q.callback===U.ERROR)ot.reject(dt(Q.reason));else throw new Error("Unexpected callback case");return}const it=this.actionHandler[Q.action];if(!it)throw new Error(`Unknown action from worker: ${Q.action}`);if(Q.callbackId){const xt=this.sourceName,ot=Q.sourceName;new Promise(function(Y){Y(it(Q.data))}).then(function(Y){gt.postMessage({sourceName:xt,targetName:ot,callback:U.DATA,callbackId:Q.callbackId,data:Y})},function(Y){gt.postMessage({sourceName:xt,targetName:ot,callback:U.ERROR,callbackId:Q.callbackId,reason:dt(Y)})});return}if(Q.streamId){Rt(this,At,hi).call(this,Q);return}it(Q.data)},gt.addEventListener("message",this._onComObjOnMessage)}on(at,lt){const gt=this.actionHandler;if(gt[at])throw new Error(`There is already an actionName called "${at}"`);gt[at]=lt}send(at,lt,gt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:at,data:lt},gt)}sendWithPromise(at,lt,gt){const et=this.callbackId++,Q=new F.PromiseCapability;this.callbackCapabilities[et]=Q;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:at,callbackId:et,data:lt},gt)}catch(it){Q.reject(it)}return Q.promise}sendWithStream(at,lt,gt,et){const Q=this.streamId++,it=this.sourceName,xt=this.targetName,ot=this.comObj;return new ReadableStream({start:Y=>{const W=new F.PromiseCapability;return this.streamControllers[Q]={controller:Y,startCall:W,pullCall:null,cancelCall:null,isClosed:!1},ot.postMessage({sourceName:it,targetName:xt,action:at,streamId:Q,data:lt,desiredSize:Y.desiredSize},et),W.promise},pull:Y=>{const W=new F.PromiseCapability;return this.streamControllers[Q].pullCall=W,ot.postMessage({sourceName:it,targetName:xt,stream:yt.PULL,streamId:Q,desiredSize:Y.desiredSize}),W.promise},cancel:Y=>{(0,F.assert)(Y instanceof Error,"cancel must have a valid reason");const W=new F.PromiseCapability;return this.streamControllers[Q].cancelCall=W,this.streamControllers[Q].isClosed=!0,ot.postMessage({sourceName:it,targetName:xt,stream:yt.CANCEL,streamId:Q,reason:dt(Y)}),W.promise}},gt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}At=new WeakSet,hi=function(at){const lt=at.streamId,gt=this.sourceName,et=at.sourceName,Q=this.comObj,it=this,xt=this.actionHandler[at.action],ot={enqueue(Y,W=1,O){if(this.isCancelled)return;const nt=this.desiredSize;this.desiredSize-=W,nt>0&&this.desiredSize<=0&&(this.sinkCapability=new F.PromiseCapability,this.ready=this.sinkCapability.promise),Q.postMessage({sourceName:gt,targetName:et,stream:yt.ENQUEUE,streamId:lt,chunk:Y},O)},close(){this.isCancelled||(this.isCancelled=!0,Q.postMessage({sourceName:gt,targetName:et,stream:yt.CLOSE,streamId:lt}),delete it.streamSinks[lt])},error(Y){(0,F.assert)(Y instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,Q.postMessage({sourceName:gt,targetName:et,stream:yt.ERROR,streamId:lt,reason:dt(Y)}))},sinkCapability:new F.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:at.desiredSize,ready:null};ot.sinkCapability.resolve(),ot.ready=ot.sinkCapability.promise,this.streamSinks[lt]=ot,new Promise(function(Y){Y(xt(at.data,ot))}).then(function(){Q.postMessage({sourceName:gt,targetName:et,stream:yt.START_COMPLETE,streamId:lt,success:!0})},function(Y){Q.postMessage({sourceName:gt,targetName:et,stream:yt.START_COMPLETE,streamId:lt,reason:dt(Y)})})},di=function(at){const lt=at.streamId,gt=this.sourceName,et=at.sourceName,Q=this.comObj,it=this.streamControllers[lt],xt=this.streamSinks[lt];switch(at.stream){case yt.START_COMPLETE:at.success?it.startCall.resolve():it.startCall.reject(dt(at.reason));break;case yt.PULL_COMPLETE:at.success?it.pullCall.resolve():it.pullCall.reject(dt(at.reason));break;case yt.PULL:if(!xt){Q.postMessage({sourceName:gt,targetName:et,stream:yt.PULL_COMPLETE,streamId:lt,success:!0});break}xt.desiredSize<=0&&at.desiredSize>0&&xt.sinkCapability.resolve(),xt.desiredSize=at.desiredSize,new Promise(function(ot){ot(xt.onPull?.())}).then(function(){Q.postMessage({sourceName:gt,targetName:et,stream:yt.PULL_COMPLETE,streamId:lt,success:!0})},function(ot){Q.postMessage({sourceName:gt,targetName:et,stream:yt.PULL_COMPLETE,streamId:lt,reason:dt(ot)})});break;case yt.ENQUEUE:if((0,F.assert)(it,"enqueue should have stream controller"),it.isClosed)break;it.controller.enqueue(at.chunk);break;case yt.CLOSE:if((0,F.assert)(it,"close should have stream controller"),it.isClosed)break;it.isClosed=!0,it.controller.close(),Rt(this,At,ls).call(this,it,lt);break;case yt.ERROR:(0,F.assert)(it,"error should have stream controller"),it.controller.error(dt(at.reason)),Rt(this,At,ls).call(this,it,lt);break;case yt.CANCEL_COMPLETE:at.success?it.cancelCall.resolve():it.cancelCall.reject(dt(at.reason)),Rt(this,At,ls).call(this,it,lt);break;case yt.CANCEL:if(!xt)break;new Promise(function(ot){ot(xt.onCancel?.(dt(at.reason)))}).then(function(){Q.postMessage({sourceName:gt,targetName:et,stream:yt.CANCEL_COMPLETE,streamId:lt,success:!0})},function(ot){Q.postMessage({sourceName:gt,targetName:et,stream:yt.CANCEL_COMPLETE,streamId:lt,reason:dt(ot)})}),xt.sinkCapability.reject(dt(at.reason)),xt.isCancelled=!0,delete this.streamSinks[lt];break;default:throw new Error("Unexpected stream case")}},ls=async function(at,lt){await Promise.allSettled([at.startCall?.promise,at.pullCall?.promise,at.cancelCall?.promise]),delete this.streamControllers[lt]},w.MessageHandler=Yt},(rt,w,X)=>{var yt,dt;Object.defineProperty(w,"__esModule",{value:!0}),w.Metadata=void 0;var F=X(1);class U{constructor({parsedData:At,rawData:ut}){Ht(this,yt);Ht(this,dt);Wt(this,yt,At),Wt(this,dt,ut)}getRaw(){return D(this,dt)}get(At){return D(this,yt).get(At)??null}getAll(){return(0,F.objectFromMap)(D(this,yt))}has(At){return D(this,yt).has(At)}}yt=new WeakMap,dt=new WeakMap,w.Metadata=U},(rt,w,X)=>{var At,ut,Z,bt,Ct,at,Is;Object.defineProperty(w,"__esModule",{value:!0}),w.OptionalContentConfig=void 0;var F=X(1),U=X(8);const yt=Symbol("INTERNAL");class dt{constructor(et,Q){Ht(this,At,!0);this.name=et,this.intent=Q}get visible(){return D(this,At)}_setVisible(et,Q){et!==yt&&(0,F.unreachable)("Internal method `_setVisible` called."),Wt(this,At,Q)}}At=new WeakMap;class Yt{constructor(et){Ht(this,at);Ht(this,ut,null);Ht(this,Z,new Map);Ht(this,bt,null);Ht(this,Ct,null);if(this.name=null,this.creator=null,et!==null){this.name=et.name,this.creator=et.creator,Wt(this,Ct,et.order);for(const Q of et.groups)D(this,Z).set(Q.id,new dt(Q.name,Q.intent));if(et.baseState==="OFF")for(const Q of D(this,Z).values())Q._setVisible(yt,!1);for(const Q of et.on)D(this,Z).get(Q)._setVisible(yt,!0);for(const Q of et.off)D(this,Z).get(Q)._setVisible(yt,!1);Wt(this,bt,this.getHash())}}isVisible(et){if(D(this,Z).size===0)return!0;if(!et)return(0,F.warn)("Optional content group not defined."),!0;if(et.type==="OCG")return D(this,Z).has(et.id)?D(this,Z).get(et.id).visible:((0,F.warn)(`Optional content group not found: ${et.id}`),!0);if(et.type==="OCMD"){if(et.expression)return Rt(this,at,Is).call(this,et.expression);if(!et.policy||et.policy==="AnyOn"){for(const Q of et.ids){if(!D(this,Z).has(Q))return(0,F.warn)(`Optional content group not found: ${Q}`),!0;if(D(this,Z).get(Q).visible)return!0}return!1}else if(et.policy==="AllOn"){for(const Q of et.ids){if(!D(this,Z).has(Q))return(0,F.warn)(`Optional content group not found: ${Q}`),!0;if(!D(this,Z).get(Q).visible)return!1}return!0}else if(et.policy==="AnyOff"){for(const Q of et.ids){if(!D(this,Z).has(Q))return(0,F.warn)(`Optional content group not found: ${Q}`),!0;if(!D(this,Z).get(Q).visible)return!0}return!1}else if(et.policy==="AllOff"){for(const Q of et.ids){if(!D(this,Z).has(Q))return(0,F.warn)(`Optional content group not found: ${Q}`),!0;if(D(this,Z).get(Q).visible)return!1}return!0}return(0,F.warn)(`Unknown optional content policy ${et.policy}.`),!0}return(0,F.warn)(`Unknown group type ${et.type}.`),!0}setVisibility(et,Q=!0){if(!D(this,Z).has(et)){(0,F.warn)(`Optional content group not found: ${et}`);return}D(this,Z).get(et)._setVisible(yt,!!Q),Wt(this,ut,null)}get hasInitialVisibility(){return D(this,bt)===null||this.getHash()===D(this,bt)}getOrder(){return D(this,Z).size?D(this,Ct)?D(this,Ct).slice():[...D(this,Z).keys()]:null}getGroups(){return D(this,Z).size>0?(0,F.objectFromMap)(D(this,Z)):null}getGroup(et){return D(this,Z).get(et)||null}getHash(){if(D(this,ut)!==null)return D(this,ut);const et=new U.MurmurHash3_64;for(const[Q,it]of D(this,Z))et.update(`${Q}:${it.visible}`);return Wt(this,ut,et.hexdigest())}}ut=new WeakMap,Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakSet,Is=function(et){const Q=et.length;if(Q<2)return!0;const it=et[0];for(let xt=1;xt<Q;xt++){const ot=et[xt];let Y;if(Array.isArray(ot))Y=Rt(this,at,Is).call(this,ot);else if(D(this,Z).has(ot))Y=D(this,Z).get(ot).visible;else return(0,F.warn)(`Optional content group not found: ${ot}`),!0;switch(it){case"And":if(!Y)return!1;break;case"Or":if(Y)return!0;break;case"Not":return!Y;default:return!0}}return it==="And"},w.OptionalContentConfig=Yt},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFDataTransportStream=void 0;var F=X(1),U=X(6);class yt{constructor({length:ut,initialData:Z,progressiveDone:bt=!1,contentDispositionFilename:Ct=null,disableRange:at=!1,disableStream:lt=!1},gt){if((0,F.assert)(gt,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=bt,this._contentDispositionFilename=Ct,Z?.length>0){const et=Z instanceof Uint8Array&&Z.byteLength===Z.buffer.byteLength?Z.buffer:new Uint8Array(Z).buffer;this._queuedChunks.push(et)}this._pdfDataRangeTransport=gt,this._isStreamingSupported=!lt,this._isRangeSupported=!at,this._contentLength=ut,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((et,Q)=>{this._onReceiveData({begin:et,chunk:Q})}),this._pdfDataRangeTransport.addProgressListener((et,Q)=>{this._onProgress({loaded:et,total:Q})}),this._pdfDataRangeTransport.addProgressiveReadListener(et=>{this._onReceiveData({chunk:et})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:ut,chunk:Z}){const bt=Z instanceof Uint8Array&&Z.byteLength===Z.buffer.byteLength?Z.buffer:new Uint8Array(Z).buffer;if(ut===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(bt):this._queuedChunks.push(bt);else{const Ct=this._rangeReaders.some(function(at){return at._begin!==ut?!1:(at._enqueue(bt),!0)});(0,F.assert)(Ct,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(ut){ut.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:ut.loaded}):this._fullRequestReader?.onProgress?.({loaded:ut.loaded,total:ut.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(ut){const Z=this._rangeReaders.indexOf(ut);Z>=0&&this._rangeReaders.splice(Z,1)}getFullReader(){(0,F.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const ut=this._queuedChunks;return this._queuedChunks=null,new dt(this,ut,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(ut,Z){if(Z<=this._progressiveDataLength)return null;const bt=new Yt(this,ut,Z);return this._pdfDataRangeTransport.requestDataRange(ut,Z),this._rangeReaders.push(bt),bt}cancelAllRequests(ut){this._fullRequestReader?.cancel(ut);for(const Z of this._rangeReaders.slice(0))Z.cancel(ut);this._pdfDataRangeTransport.abort()}}w.PDFDataTransportStream=yt;class dt{constructor(ut,Z,bt=!1,Ct=null){this._stream=ut,this._done=bt||!1,this._filename=(0,U.isPdfFile)(Ct)?Ct:null,this._queuedChunks=Z||[],this._loaded=0;for(const at of this._queuedChunks)this._loaded+=at.byteLength;this._requests=[],this._headersReady=Promise.resolve(),ut._fullRequestReader=this,this.onProgress=null}_enqueue(ut){this._done||(this._requests.length>0?this._requests.shift().resolve({value:ut,done:!1}):this._queuedChunks.push(ut),this._loaded+=ut.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const ut=new F.PromiseCapability;return this._requests.push(ut),ut.promise}cancel(ut){this._done=!0;for(const Z of this._requests)Z.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Yt{constructor(ut,Z,bt){this._stream=ut,this._begin=Z,this._end=bt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(ut){if(!this._done){if(this._requests.length===0)this._queuedChunk=ut;else{this._requests.shift().resolve({value:ut,done:!1});for(const bt of this._requests)bt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const Z=this._queuedChunk;return this._queuedChunk=null,{value:Z,done:!1}}if(this._done)return{value:void 0,done:!0};const ut=new F.PromiseCapability;return this._requests.push(ut),ut.promise}cancel(ut){this._done=!0;for(const Z of this._requests)Z.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFFetchStream=void 0;var F=X(1),U=X(20);function yt(bt,Ct,at){return{method:"GET",headers:bt,signal:at.signal,mode:"cors",credentials:Ct?"include":"same-origin",redirect:"follow"}}function dt(bt){const Ct=new Headers;for(const at in bt){const lt=bt[at];lt!==void 0&&Ct.append(at,lt)}return Ct}function Yt(bt){return bt instanceof Uint8Array?bt.buffer:bt instanceof ArrayBuffer?bt:((0,F.warn)(`getArrayBuffer - unexpected data format: ${bt}`),new Uint8Array(bt).buffer)}class At{constructor(Ct){this.source=Ct,this.isHttp=/^https?:/i.test(Ct.url),this.httpHeaders=this.isHttp&&Ct.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,F.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new ut(this),this._fullRequestReader}getRangeReader(Ct,at){if(at<=this._progressiveDataLength)return null;const lt=new Z(this,Ct,at);return this._rangeRequestReaders.push(lt),lt}cancelAllRequests(Ct){this._fullRequestReader?.cancel(Ct);for(const at of this._rangeRequestReaders.slice(0))at.cancel(Ct)}}w.PDFFetchStream=At;class ut{constructor(Ct){this._stream=Ct,this._reader=null,this._loaded=0,this._filename=null;const at=Ct.source;this._withCredentials=at.withCredentials||!1,this._contentLength=at.length,this._headersCapability=new F.PromiseCapability,this._disableRange=at.disableRange||!1,this._rangeChunkSize=at.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!at.disableStream,this._isRangeSupported=!at.disableRange,this._headers=dt(this._stream.httpHeaders);const lt=at.url;fetch(lt,yt(this._headers,this._withCredentials,this._abortController)).then(gt=>{if(!(0,U.validateResponseStatus)(gt.status))throw(0,U.createResponseStatusError)(gt.status,lt);this._reader=gt.body.getReader(),this._headersCapability.resolve();const et=xt=>gt.headers.get(xt),{allowRangeRequests:Q,suggestedLength:it}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:et,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Q,this._contentLength=it||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(et),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new F.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:Ct,done:at}=await this._reader.read();return at?{value:Ct,done:at}:(this._loaded+=Ct.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Yt(Ct),done:!1})}cancel(Ct){this._reader?.cancel(Ct),this._abortController.abort()}}class Z{constructor(Ct,at,lt){this._stream=Ct,this._reader=null,this._loaded=0;const gt=Ct.source;this._withCredentials=gt.withCredentials||!1,this._readCapability=new F.PromiseCapability,this._isStreamingSupported=!gt.disableStream,this._abortController=new AbortController,this._headers=dt(this._stream.httpHeaders),this._headers.append("Range",`bytes=${at}-${lt-1}`);const et=gt.url;fetch(et,yt(this._headers,this._withCredentials,this._abortController)).then(Q=>{if(!(0,U.validateResponseStatus)(Q.status))throw(0,U.createResponseStatusError)(Q.status,et);this._readCapability.resolve(),this._reader=Q.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:Ct,done:at}=await this._reader.read();return at?{value:Ct,done:at}:(this._loaded+=Ct.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Yt(Ct),done:!1})}cancel(Ct){this._reader?.cancel(Ct),this._abortController.abort()}}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.createResponseStatusError=At,w.extractFilenameFromHeader=Yt,w.validateRangeRequestCapabilities=dt,w.validateResponseStatus=ut;var F=X(1),U=X(21),yt=X(6);function dt({getResponseHeader:Z,isHttp:bt,rangeChunkSize:Ct,disableRange:at}){const lt={allowRangeRequests:!1,suggestedLength:void 0},gt=parseInt(Z("Content-Length"),10);return!Number.isInteger(gt)||(lt.suggestedLength=gt,gt<=2*Ct)||at||!bt||Z("Accept-Ranges")!=="bytes"||(Z("Content-Encoding")||"identity")!=="identity"||(lt.allowRangeRequests=!0),lt}function Yt(Z){const bt=Z("Content-Disposition");if(bt){let Ct=(0,U.getFilenameFromContentDispositionHeader)(bt);if(Ct.includes("%"))try{Ct=decodeURIComponent(Ct)}catch{}if((0,yt.isPdfFile)(Ct))return Ct}return null}function At(Z,bt){return Z===404||Z===0&&bt.startsWith("file:")?new F.MissingPDFException('Missing PDF "'+bt+'".'):new F.UnexpectedResponseException(`Unexpected server response (${Z}) while retrieving PDF "${bt}".`,Z)}function ut(Z){return Z===200||Z===206}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.getFilenameFromContentDispositionHeader=U;var F=X(1);function U(yt){let dt=!0,Yt=At("filename\\*","i").exec(yt);if(Yt){Yt=Yt[1];let gt=Ct(Yt);return gt=unescape(gt),gt=at(gt),gt=lt(gt),Z(gt)}if(Yt=bt(yt),Yt){const gt=lt(Yt);return Z(gt)}if(Yt=At("filename","i").exec(yt),Yt){Yt=Yt[1];let gt=Ct(Yt);return gt=lt(gt),Z(gt)}function At(gt,et){return new RegExp("(?:^|;)\\s*"+gt+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',et)}function ut(gt,et){if(gt){if(!/^[\x00-\xFF]+$/.test(et))return et;try{const Q=new TextDecoder(gt,{fatal:!0}),it=(0,F.stringToBytes)(et);et=Q.decode(it),dt=!1}catch{}}return et}function Z(gt){return dt&&/[\x80-\xff]/.test(gt)&&(gt=ut("utf-8",gt),dt&&(gt=ut("iso-8859-1",gt))),gt}function bt(gt){const et=[];let Q;const it=At("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(Q=it.exec(gt))!==null;){let[,ot,Y,W]=Q;if(ot=parseInt(ot,10),ot in et){if(ot===0)break;continue}et[ot]=[Y,W]}const xt=[];for(let ot=0;ot<et.length&&ot in et;++ot){let[Y,W]=et[ot];W=Ct(W),Y&&(W=unescape(W),ot===0&&(W=at(W))),xt.push(W)}return xt.join("")}function Ct(gt){if(gt.startsWith('"')){const et=gt.slice(1).split('\\"');for(let Q=0;Q<et.length;++Q){const it=et[Q].indexOf('"');it!==-1&&(et[Q]=et[Q].slice(0,it),et.length=Q+1),et[Q]=et[Q].replaceAll(/\\(.)/g,"$1")}gt=et.join('"')}return gt}function at(gt){const et=gt.indexOf("'");if(et===-1)return gt;const Q=gt.slice(0,et),xt=gt.slice(et+1).replace(/^[^']*'/,"");return ut(Q,xt)}function lt(gt){return!gt.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(gt)?gt:gt.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(et,Q,it,xt){if(it==="q"||it==="Q")return xt=xt.replaceAll("_"," "),xt=xt.replaceAll(/=([0-9a-fA-F]{2})/g,function(ot,Y){return String.fromCharCode(parseInt(Y,16))}),ut(Q,xt);try{xt=atob(xt)}catch{}return ut(Q,xt)})}return""}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFNetworkStream=void 0;var F=X(1),U=X(20);const yt=200,dt=206;function Yt(Ct){const at=Ct.response;return typeof at!="string"?at:(0,F.stringToBytes)(at).buffer}class At{constructor(at,lt={}){this.url=at,this.isHttp=/^https?:/i.test(at),this.httpHeaders=this.isHttp&&lt.httpHeaders||Object.create(null),this.withCredentials=lt.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(at,lt,gt){const et={begin:at,end:lt};for(const Q in gt)et[Q]=gt[Q];return this.request(et)}requestFull(at){return this.request(at)}request(at){const lt=new XMLHttpRequest,gt=this.currXhrId++,et=this.pendingRequests[gt]={xhr:lt};lt.open("GET",this.url),lt.withCredentials=this.withCredentials;for(const Q in this.httpHeaders){const it=this.httpHeaders[Q];it!==void 0&&lt.setRequestHeader(Q,it)}return this.isHttp&&"begin"in at&&"end"in at?(lt.setRequestHeader("Range",`bytes=${at.begin}-${at.end-1}`),et.expectedStatus=dt):et.expectedStatus=yt,lt.responseType="arraybuffer",at.onError&&(lt.onerror=function(Q){at.onError(lt.status)}),lt.onreadystatechange=this.onStateChange.bind(this,gt),lt.onprogress=this.onProgress.bind(this,gt),et.onHeadersReceived=at.onHeadersReceived,et.onDone=at.onDone,et.onError=at.onError,et.onProgress=at.onProgress,lt.send(null),gt}onProgress(at,lt){const gt=this.pendingRequests[at];gt&&gt.onProgress?.(lt)}onStateChange(at,lt){const gt=this.pendingRequests[at];if(!gt)return;const et=gt.xhr;if(et.readyState>=2&&gt.onHeadersReceived&&(gt.onHeadersReceived(),delete gt.onHeadersReceived),et.readyState!==4||!(at in this.pendingRequests))return;if(delete this.pendingRequests[at],et.status===0&&this.isHttp){gt.onError?.(et.status);return}const Q=et.status||yt;if(!(Q===yt&&gt.expectedStatus===dt)&&Q!==gt.expectedStatus){gt.onError?.(et.status);return}const xt=Yt(et);if(Q===dt){const ot=et.getResponseHeader("Content-Range"),Y=/bytes (\d+)-(\d+)\/(\d+)/.exec(ot);gt.onDone({begin:parseInt(Y[1],10),chunk:xt})}else xt?gt.onDone({begin:0,chunk:xt}):gt.onError?.(et.status)}getRequestXhr(at){return this.pendingRequests[at].xhr}isPendingRequest(at){return at in this.pendingRequests}abortRequest(at){const lt=this.pendingRequests[at].xhr;delete this.pendingRequests[at],lt.abort()}}class ut{constructor(at){this._source=at,this._manager=new At(at.url,{httpHeaders:at.httpHeaders,withCredentials:at.withCredentials}),this._rangeChunkSize=at.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(at){const lt=this._rangeRequestReaders.indexOf(at);lt>=0&&this._rangeRequestReaders.splice(lt,1)}getFullReader(){return(0,F.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Z(this._manager,this._source),this._fullRequestReader}getRangeReader(at,lt){const gt=new bt(this._manager,at,lt);return gt.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(gt),gt}cancelAllRequests(at){this._fullRequestReader?.cancel(at);for(const lt of this._rangeRequestReaders.slice(0))lt.cancel(at)}}w.PDFNetworkStream=ut;class Z{constructor(at,lt){this._manager=at;const gt={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=lt.url,this._fullRequestId=at.requestFull(gt),this._headersReceivedCapability=new F.PromiseCapability,this._disableRange=lt.disableRange||!1,this._contentLength=lt.length,this._rangeChunkSize=lt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const at=this._fullRequestId,lt=this._manager.getRequestXhr(at),gt=it=>lt.getResponseHeader(it),{allowRangeRequests:et,suggestedLength:Q}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:gt,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});et&&(this._isRangeSupported=!0),this._contentLength=Q||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(gt),this._isRangeSupported&&this._manager.abortRequest(at),this._headersReceivedCapability.resolve()}_onDone(at){if(at&&(this._requests.length>0?this._requests.shift().resolve({value:at.chunk,done:!1}):this._cachedChunks.push(at.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(at){this._storedError=(0,U.createResponseStatusError)(at,this._url),this._headersReceivedCapability.reject(this._storedError);for(const lt of this._requests)lt.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(at){this.onProgress?.({loaded:at.loaded,total:at.lengthComputable?at.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const at=new F.PromiseCapability;return this._requests.push(at),at.promise}cancel(at){this._done=!0,this._headersReceivedCapability.reject(at);for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class bt{constructor(at,lt,gt){this._manager=at;const et={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=at.url,this._requestId=at.requestRange(lt,gt,et),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(at){const lt=at.chunk;this._requests.length>0?this._requests.shift().resolve({value:lt,done:!1}):this._queuedChunk=lt,this._done=!0;for(const gt of this._requests)gt.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(at){this._storedError=(0,U.createResponseStatusError)(at,this._url);for(const lt of this._requests)lt.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(at){this.isStreamingSupported||this.onProgress?.({loaded:at.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const lt=this._queuedChunk;return this._queuedChunk=null,{value:lt,done:!1}}if(this._done)return{value:void 0,done:!0};const at=new F.PromiseCapability;return this._requests.push(at),at.promise}cancel(at){this._done=!0;for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.PDFNodeStream=void 0;var F=X(1),U=X(20);const yt=/^file:\/\/\/[a-zA-Z]:\//;function dt(gt){const et=require$$5,Q=et.parse(gt);return Q.protocol==="file:"||Q.host?Q:/^[a-z]:[/\\]/i.test(gt)?et.parse(`file:///${gt}`):(Q.host||(Q.protocol="file:"),Q)}class Yt{constructor(et){this.source=et,this.url=dt(et.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&et.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,F.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new at(this):new bt(this),this._fullRequestReader}getRangeReader(et,Q){if(Q<=this._progressiveDataLength)return null;const it=this.isFsUrl?new lt(this,et,Q):new Ct(this,et,Q);return this._rangeRequestReaders.push(it),it}cancelAllRequests(et){this._fullRequestReader?.cancel(et);for(const Q of this._rangeRequestReaders.slice(0))Q.cancel(et)}}w.PDFNodeStream=Yt;class At{constructor(et){this._url=et.url,this._done=!1,this._storedError=null,this.onProgress=null;const Q=et.source;this._contentLength=Q.length,this._loaded=0,this._filename=null,this._disableRange=Q.disableRange||!1,this._rangeChunkSize=Q.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!Q.disableStream,this._isRangeSupported=!Q.disableRange,this._readableStream=null,this._readCapability=new F.PromiseCapability,this._headersCapability=new F.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const et=this._readableStream.read();return et===null?(this._readCapability=new F.PromiseCapability,this.read()):(this._loaded+=et.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(et).buffer,done:!1})}cancel(et){if(!this._readableStream){this._error(et);return}this._readableStream.destroy(et)}_error(et){this._storedError=et,this._readCapability.resolve()}_setReadableStream(et){this._readableStream=et,et.on("readable",()=>{this._readCapability.resolve()}),et.on("end",()=>{et.destroy(),this._done=!0,this._readCapability.resolve()}),et.on("error",Q=>{this._error(Q)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new F.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ut{constructor(et){this._url=et.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new F.PromiseCapability;const Q=et.source;this._isStreamingSupported=!Q.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const et=this._readableStream.read();return et===null?(this._readCapability=new F.PromiseCapability,this.read()):(this._loaded+=et.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(et).buffer,done:!1})}cancel(et){if(!this._readableStream){this._error(et);return}this._readableStream.destroy(et)}_error(et){this._storedError=et,this._readCapability.resolve()}_setReadableStream(et){this._readableStream=et,et.on("readable",()=>{this._readCapability.resolve()}),et.on("end",()=>{et.destroy(),this._done=!0,this._readCapability.resolve()}),et.on("error",Q=>{this._error(Q)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Z(gt,et){return{protocol:gt.protocol,auth:gt.auth,host:gt.hostname,port:gt.port,path:gt.path,method:"GET",headers:et}}class bt extends At{constructor(et){super(et);const Q=it=>{if(it.statusCode===404){const W=new F.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=W,this._headersCapability.reject(W);return}this._headersCapability.resolve(),this._setReadableStream(it);const xt=W=>this._readableStream.headers[W.toLowerCase()],{allowRangeRequests:ot,suggestedLength:Y}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:xt,isHttp:et.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ot,this._contentLength=Y||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(xt)};if(this._request=null,this._url.protocol==="http:"){const it=require$$5;this._request=it.request(Z(this._url,et.httpHeaders),Q)}else{const it=require$$5;this._request=it.request(Z(this._url,et.httpHeaders),Q)}this._request.on("error",it=>{this._storedError=it,this._headersCapability.reject(it)}),this._request.end()}}class Ct extends ut{constructor(et,Q,it){super(et),this._httpHeaders={};for(const ot in et.httpHeaders){const Y=et.httpHeaders[ot];Y!==void 0&&(this._httpHeaders[ot]=Y)}this._httpHeaders.Range=`bytes=${Q}-${it-1}`;const xt=ot=>{if(ot.statusCode===404){const Y=new F.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Y;return}this._setReadableStream(ot)};if(this._request=null,this._url.protocol==="http:"){const ot=require$$5;this._request=ot.request(Z(this._url,this._httpHeaders),xt)}else{const ot=require$$5;this._request=ot.request(Z(this._url,this._httpHeaders),xt)}this._request.on("error",ot=>{this._storedError=ot}),this._request.end()}}class at extends At{constructor(et){super(et);let Q=decodeURIComponent(this._url.path);yt.test(this._url.href)&&(Q=Q.replace(/^\//,""));const it=require$$5;it.lstat(Q,(xt,ot)=>{if(xt){xt.code==="ENOENT"&&(xt=new F.MissingPDFException(`Missing PDF "${Q}".`)),this._storedError=xt,this._headersCapability.reject(xt);return}this._contentLength=ot.size,this._setReadableStream(it.createReadStream(Q)),this._headersCapability.resolve()})}}class lt extends ut{constructor(et,Q,it){super(et);let xt=decodeURIComponent(this._url.path);yt.test(this._url.href)&&(xt=xt.replace(/^\//,""));const ot=require$$5;this._setReadableStream(ot.createReadStream(xt,{start:Q,end:it-1}))}}},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.SVGGraphics=void 0;var F=X(6),U=X(1);const yt={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},dt="http://www.w3.org/XML/1998/namespace",Yt="http://www.w3.org/1999/xlink",At=["butt","round","square"],ut=["miter","round","bevel"],Z=function(ot,Y="",W=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!W)return URL.createObjectURL(new Blob([ot],{type:Y}));const O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let nt=`data:${Y};base64,`;for(let J=0,Ft=ot.length;J<Ft;J+=3){const K=ot[J]&255,pt=ot[J+1]&255,Tt=ot[J+2]&255,Xt=K>>2,Lt=(K&3)<<4|pt>>4,Bt=J+1<Ft?(pt&15)<<2|Tt>>6:64,Mt=J+2<Ft?Tt&63:64;nt+=O[Xt]+O[Lt]+O[Bt]+O[Mt]}return nt},bt=function(){const ot=new Uint8Array([137,80,78,71,13,10,26,10]),Y=12,W=new Int32Array(256);for(let Tt=0;Tt<256;Tt++){let Xt=Tt;for(let Lt=0;Lt<8;Lt++)Xt=Xt&1?3988292384^Xt>>1&2147483647:Xt>>1&2147483647;W[Tt]=Xt}function O(Tt,Xt,Lt){let Bt=-1;for(let Mt=Xt;Mt<Lt;Mt++){const Vt=(Bt^Tt[Mt])&255,Et=W[Vt];Bt=Bt>>>8^Et}return Bt^-1}function nt(Tt,Xt,Lt,Bt){let Mt=Bt;const Vt=Xt.length;Lt[Mt]=Vt>>24&255,Lt[Mt+1]=Vt>>16&255,Lt[Mt+2]=Vt>>8&255,Lt[Mt+3]=Vt&255,Mt+=4,Lt[Mt]=Tt.charCodeAt(0)&255,Lt[Mt+1]=Tt.charCodeAt(1)&255,Lt[Mt+2]=Tt.charCodeAt(2)&255,Lt[Mt+3]=Tt.charCodeAt(3)&255,Mt+=4,Lt.set(Xt,Mt),Mt+=Xt.length;const Et=O(Lt,Bt+4,Mt);Lt[Mt]=Et>>24&255,Lt[Mt+1]=Et>>16&255,Lt[Mt+2]=Et>>8&255,Lt[Mt+3]=Et&255}function J(Tt,Xt,Lt){let Bt=1,Mt=0;for(let Vt=Xt;Vt<Lt;++Vt)Bt=(Bt+(Tt[Vt]&255))%65521,Mt=(Mt+Bt)%65521;return Mt<<16|Bt}function Ft(Tt){if(!U.isNodeJS)return K(Tt);try{const Xt=parseInt(process.versions.node)>=8?Tt:Buffer.from(Tt),Lt=require$$5.deflateSync(Xt,{level:9});return Lt instanceof Uint8Array?Lt:new Uint8Array(Lt)}catch(Xt){(0,U.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Xt)}return K(Tt)}function K(Tt){let Xt=Tt.length;const Lt=65535,Bt=Math.ceil(Xt/Lt),Mt=new Uint8Array(2+Xt+Bt*5+4);let Vt=0;Mt[Vt++]=120,Mt[Vt++]=156;let Et=0;for(;Xt>Lt;)Mt[Vt++]=0,Mt[Vt++]=255,Mt[Vt++]=255,Mt[Vt++]=0,Mt[Vt++]=0,Mt.set(Tt.subarray(Et,Et+Lt),Vt),Vt+=Lt,Et+=Lt,Xt-=Lt;Mt[Vt++]=1,Mt[Vt++]=Xt&255,Mt[Vt++]=Xt>>8&255,Mt[Vt++]=~Xt&65535&255,Mt[Vt++]=(~Xt&65535)>>8&255,Mt.set(Tt.subarray(Et),Vt),Vt+=Tt.length-Et;const Dt=J(Tt,0,Tt.length);return Mt[Vt++]=Dt>>24&255,Mt[Vt++]=Dt>>16&255,Mt[Vt++]=Dt>>8&255,Mt[Vt++]=Dt&255,Mt}function pt(Tt,Xt,Lt,Bt){const Mt=Tt.width,Vt=Tt.height;let Et,Dt,Nt;const ht=Tt.data;switch(Xt){case U.ImageKind.GRAYSCALE_1BPP:Dt=0,Et=1,Nt=Mt+7>>3;break;case U.ImageKind.RGB_24BPP:Dt=2,Et=8,Nt=Mt*3;break;case U.ImageKind.RGBA_32BPP:Dt=6,Et=8,Nt=Mt*4;break;default:throw new Error("invalid format")}const q=new Uint8Array((1+Nt)*Vt);let G=0,tt=0;for(let Qt=0;Qt<Vt;++Qt)q[G++]=0,q.set(ht.subarray(tt,tt+Nt),G),tt+=Nt,G+=Nt;if(Xt===U.ImageKind.GRAYSCALE_1BPP&&Bt){G=0;for(let Qt=0;Qt<Vt;Qt++){G++;for(let te=0;te<Nt;te++)q[G++]^=255}}const mt=new Uint8Array([Mt>>24&255,Mt>>16&255,Mt>>8&255,Mt&255,Vt>>24&255,Vt>>16&255,Vt>>8&255,Vt&255,Et,Dt,0,0,0]),_t=Ft(q),vt=ot.length+Y*3+mt.length+_t.length,kt=new Uint8Array(vt);let zt=0;return kt.set(ot,zt),zt+=ot.length,nt("IHDR",mt,kt,zt),zt+=Y+mt.length,nt("IDATA",_t,kt,zt),zt+=Y+_t.length,nt("IEND",new Uint8Array(0),kt,zt),Z(kt,"image/png",Lt)}return function(Xt,Lt,Bt){const Mt=Xt.kind===void 0?U.ImageKind.GRAYSCALE_1BPP:Xt.kind;return pt(Xt,Mt,Lt,Bt)}}();class Ct{constructor(){this.fontSizeScale=1,this.fontWeight=yt.fontWeight,this.fontSize=0,this.textMatrix=U.IDENTITY_MATRIX,this.fontMatrix=U.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=U.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=yt.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(Y,W){this.x=Y,this.y=W}}function at(ot){let Y=[];const W=[];for(const O of ot){if(O.fn==="save"){Y.push({fnId:92,fn:"group",items:[]}),W.push(Y),Y=Y.at(-1).items;continue}O.fn==="restore"?Y=W.pop():Y.push(O)}return Y}function lt(ot){if(Number.isInteger(ot))return ot.toString();const Y=ot.toFixed(10);let W=Y.length-1;if(Y[W]!=="0")return Y;do W--;while(Y[W]==="0");return Y.substring(0,Y[W]==="."?W:W+1)}function gt(ot){if(ot[4]===0&&ot[5]===0){if(ot[1]===0&&ot[2]===0)return ot[0]===1&&ot[3]===1?"":`scale(${lt(ot[0])} ${lt(ot[3])})`;if(ot[0]===ot[3]&&ot[1]===-ot[2]){const Y=Math.acos(ot[0])*180/Math.PI;return`rotate(${lt(Y)})`}}else if(ot[0]===1&&ot[1]===0&&ot[2]===0&&ot[3]===1)return`translate(${lt(ot[4])} ${lt(ot[5])})`;return`matrix(${lt(ot[0])} ${lt(ot[1])} ${lt(ot[2])} ${lt(ot[3])} ${lt(ot[4])} ${lt(ot[5])})`}let et=0,Q=0,it=0;class xt{constructor(Y,W,O=!1){(0,F.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new F.DOMSVGFactory,this.current=new Ct,this.transformMatrix=U.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=Y,this.objs=W,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!O,this._operatorIdMapping=[];for(const nt in U.OPS)this._operatorIdMapping[U.OPS[nt]]=nt}getObject(Y,W=null){return typeof Y=="string"?Y.startsWith("g_")?this.commonObjs.get(Y):this.objs.get(Y):W}save(){this.transformStack.push(this.transformMatrix);const Y=this.current;this.extraStack.push(Y),this.current=Y.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(Y){this.save(),this.executeOpTree(Y),this.restore()}loadDependencies(Y){const W=Y.fnArray,O=Y.argsArray;for(let nt=0,J=W.length;nt<J;nt++)if(W[nt]===U.OPS.dependency)for(const Ft of O[nt]){const K=Ft.startsWith("g_")?this.commonObjs:this.objs,pt=new Promise(Tt=>{K.get(Ft,Tt)});this.current.dependencies.push(pt)}return Promise.all(this.current.dependencies)}transform(Y,W,O,nt,J,Ft){const K=[Y,W,O,nt,J,Ft];this.transformMatrix=U.Util.transform(this.transformMatrix,K),this.tgrp=null}getSVG(Y,W){this.viewport=W;const O=this._initialize(W);return this.loadDependencies(Y).then(()=>(this.transformMatrix=U.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(Y)),O))}convertOpList(Y){const W=this._operatorIdMapping,O=Y.argsArray,nt=Y.fnArray,J=[];for(let Ft=0,K=nt.length;Ft<K;Ft++){const pt=nt[Ft];J.push({fnId:pt,fn:W[pt],args:O[Ft]})}return at(J)}executeOpTree(Y){for(const W of Y){const O=W.fn,nt=W.fnId,J=W.args;switch(nt|0){case U.OPS.beginText:this.beginText();break;case U.OPS.dependency:break;case U.OPS.setLeading:this.setLeading(J);break;case U.OPS.setLeadingMoveText:this.setLeadingMoveText(J[0],J[1]);break;case U.OPS.setFont:this.setFont(J);break;case U.OPS.showText:this.showText(J[0]);break;case U.OPS.showSpacedText:this.showText(J[0]);break;case U.OPS.endText:this.endText();break;case U.OPS.moveText:this.moveText(J[0],J[1]);break;case U.OPS.setCharSpacing:this.setCharSpacing(J[0]);break;case U.OPS.setWordSpacing:this.setWordSpacing(J[0]);break;case U.OPS.setHScale:this.setHScale(J[0]);break;case U.OPS.setTextMatrix:this.setTextMatrix(J[0],J[1],J[2],J[3],J[4],J[5]);break;case U.OPS.setTextRise:this.setTextRise(J[0]);break;case U.OPS.setTextRenderingMode:this.setTextRenderingMode(J[0]);break;case U.OPS.setLineWidth:this.setLineWidth(J[0]);break;case U.OPS.setLineJoin:this.setLineJoin(J[0]);break;case U.OPS.setLineCap:this.setLineCap(J[0]);break;case U.OPS.setMiterLimit:this.setMiterLimit(J[0]);break;case U.OPS.setFillRGBColor:this.setFillRGBColor(J[0],J[1],J[2]);break;case U.OPS.setStrokeRGBColor:this.setStrokeRGBColor(J[0],J[1],J[2]);break;case U.OPS.setStrokeColorN:this.setStrokeColorN(J);break;case U.OPS.setFillColorN:this.setFillColorN(J);break;case U.OPS.shadingFill:this.shadingFill(J[0]);break;case U.OPS.setDash:this.setDash(J[0],J[1]);break;case U.OPS.setRenderingIntent:this.setRenderingIntent(J[0]);break;case U.OPS.setFlatness:this.setFlatness(J[0]);break;case U.OPS.setGState:this.setGState(J[0]);break;case U.OPS.fill:this.fill();break;case U.OPS.eoFill:this.eoFill();break;case U.OPS.stroke:this.stroke();break;case U.OPS.fillStroke:this.fillStroke();break;case U.OPS.eoFillStroke:this.eoFillStroke();break;case U.OPS.clip:this.clip("nonzero");break;case U.OPS.eoClip:this.clip("evenodd");break;case U.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case U.OPS.paintImageXObject:this.paintImageXObject(J[0]);break;case U.OPS.paintInlineImageXObject:this.paintInlineImageXObject(J[0]);break;case U.OPS.paintImageMaskXObject:this.paintImageMaskXObject(J[0]);break;case U.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(J[0],J[1]);break;case U.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case U.OPS.closePath:this.closePath();break;case U.OPS.closeStroke:this.closeStroke();break;case U.OPS.closeFillStroke:this.closeFillStroke();break;case U.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case U.OPS.nextLine:this.nextLine();break;case U.OPS.transform:this.transform(J[0],J[1],J[2],J[3],J[4],J[5]);break;case U.OPS.constructPath:this.constructPath(J[0],J[1]);break;case U.OPS.endPath:this.endPath();break;case 92:this.group(W.items);break;default:(0,U.warn)(`Unimplemented operator ${O}`);break}}}setWordSpacing(Y){this.current.wordSpacing=Y}setCharSpacing(Y){this.current.charSpacing=Y}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(Y,W,O,nt,J,Ft){const K=this.current;K.textMatrix=K.lineMatrix=[Y,W,O,nt,J,Ft],K.textMatrixScale=Math.hypot(Y,W),K.x=K.lineX=0,K.y=K.lineY=0,K.xcoords=[],K.ycoords=[],K.tspan=this.svgFactory.createElement("svg:tspan"),K.tspan.setAttributeNS(null,"font-family",K.fontFamily),K.tspan.setAttributeNS(null,"font-size",`${lt(K.fontSize)}px`),K.tspan.setAttributeNS(null,"y",lt(-K.y)),K.txtElement=this.svgFactory.createElement("svg:text"),K.txtElement.append(K.tspan)}beginText(){const Y=this.current;Y.x=Y.lineX=0,Y.y=Y.lineY=0,Y.textMatrix=U.IDENTITY_MATRIX,Y.lineMatrix=U.IDENTITY_MATRIX,Y.textMatrixScale=1,Y.tspan=this.svgFactory.createElement("svg:tspan"),Y.txtElement=this.svgFactory.createElement("svg:text"),Y.txtgrp=this.svgFactory.createElement("svg:g"),Y.xcoords=[],Y.ycoords=[]}moveText(Y,W){const O=this.current;O.x=O.lineX+=Y,O.y=O.lineY+=W,O.xcoords=[],O.ycoords=[],O.tspan=this.svgFactory.createElement("svg:tspan"),O.tspan.setAttributeNS(null,"font-family",O.fontFamily),O.tspan.setAttributeNS(null,"font-size",`${lt(O.fontSize)}px`),O.tspan.setAttributeNS(null,"y",lt(-O.y))}showText(Y){const W=this.current,O=W.font,nt=W.fontSize;if(nt===0)return;const J=W.fontSizeScale,Ft=W.charSpacing,K=W.wordSpacing,pt=W.fontDirection,Tt=W.textHScale*pt,Xt=O.vertical,Lt=Xt?1:-1,Bt=O.defaultVMetrics,Mt=nt*W.fontMatrix[0];let Vt=0;for(const Nt of Y){if(Nt===null){Vt+=pt*K;continue}else if(typeof Nt=="number"){Vt+=Lt*Nt*nt/1e3;continue}const ht=(Nt.isSpace?K:0)+Ft,q=Nt.fontChar;let G,tt,mt=Nt.width;if(Xt){let vt;const kt=Nt.vmetric||Bt;vt=Nt.vmetric?kt[1]:mt*.5,vt=-vt*Mt;const zt=kt[2]*Mt;mt=kt?-kt[0]:mt,G=vt/J,tt=(Vt+zt)/J}else G=Vt/J,tt=0;(Nt.isInFont||O.missingFile)&&(W.xcoords.push(W.x+G),Xt&&W.ycoords.push(-W.y+tt),W.tspan.textContent+=q);const _t=Xt?mt*Mt-ht*pt:mt*Mt+ht*pt;Vt+=_t}W.tspan.setAttributeNS(null,"x",W.xcoords.map(lt).join(" ")),Xt?W.tspan.setAttributeNS(null,"y",W.ycoords.map(lt).join(" ")):W.tspan.setAttributeNS(null,"y",lt(-W.y)),Xt?W.y-=Vt:W.x+=Vt*Tt,W.tspan.setAttributeNS(null,"font-family",W.fontFamily),W.tspan.setAttributeNS(null,"font-size",`${lt(W.fontSize)}px`),W.fontStyle!==yt.fontStyle&&W.tspan.setAttributeNS(null,"font-style",W.fontStyle),W.fontWeight!==yt.fontWeight&&W.tspan.setAttributeNS(null,"font-weight",W.fontWeight);const Et=W.textRenderingMode&U.TextRenderingMode.FILL_STROKE_MASK;if(Et===U.TextRenderingMode.FILL||Et===U.TextRenderingMode.FILL_STROKE?(W.fillColor!==yt.fillColor&&W.tspan.setAttributeNS(null,"fill",W.fillColor),W.fillAlpha<1&&W.tspan.setAttributeNS(null,"fill-opacity",W.fillAlpha)):W.textRenderingMode===U.TextRenderingMode.ADD_TO_PATH?W.tspan.setAttributeNS(null,"fill","transparent"):W.tspan.setAttributeNS(null,"fill","none"),Et===U.TextRenderingMode.STROKE||Et===U.TextRenderingMode.FILL_STROKE){const Nt=1/(W.textMatrixScale||1);this._setStrokeAttributes(W.tspan,Nt)}let Dt=W.textMatrix;W.textRise!==0&&(Dt=Dt.slice(),Dt[5]+=W.textRise),W.txtElement.setAttributeNS(null,"transform",`${gt(Dt)} scale(${lt(Tt)}, -1)`),W.txtElement.setAttributeNS(dt,"xml:space","preserve"),W.txtElement.append(W.tspan),W.txtgrp.append(W.txtElement),this._ensureTransformGroup().append(W.txtElement)}setLeadingMoveText(Y,W){this.setLeading(-W),this.moveText(Y,W)}addFontStyle(Y){if(!Y.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const W=Z(Y.data,Y.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${Y.loadedName}"; src: url(${W}); }
`}setFont(Y){const W=this.current,O=this.commonObjs.get(Y[0]);let nt=Y[1];W.font=O,this.embedFonts&&!O.missingFile&&!this.embeddedFonts[O.loadedName]&&(this.addFontStyle(O),this.embeddedFonts[O.loadedName]=O),W.fontMatrix=O.fontMatrix||U.FONT_IDENTITY_MATRIX;let J="normal";O.black?J="900":O.bold&&(J="bold");const Ft=O.italic?"italic":"normal";nt<0?(nt=-nt,W.fontDirection=-1):W.fontDirection=1,W.fontSize=nt,W.fontFamily=O.loadedName,W.fontWeight=J,W.fontStyle=Ft,W.tspan=this.svgFactory.createElement("svg:tspan"),W.tspan.setAttributeNS(null,"y",lt(-W.y)),W.xcoords=[],W.ycoords=[]}endText(){const Y=this.current;Y.textRenderingMode&U.TextRenderingMode.ADD_TO_PATH_FLAG&&Y.txtElement?.hasChildNodes()&&(Y.element=Y.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(Y){Y>0&&(this.current.lineWidth=Y)}setLineCap(Y){this.current.lineCap=At[Y]}setLineJoin(Y){this.current.lineJoin=ut[Y]}setMiterLimit(Y){this.current.miterLimit=Y}setStrokeAlpha(Y){this.current.strokeAlpha=Y}setStrokeRGBColor(Y,W,O){this.current.strokeColor=U.Util.makeHexColor(Y,W,O)}setFillAlpha(Y){this.current.fillAlpha=Y}setFillRGBColor(Y,W,O){this.current.fillColor=U.Util.makeHexColor(Y,W,O),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(Y){this.current.strokeColor=this._makeColorN_Pattern(Y)}setFillColorN(Y){this.current.fillColor=this._makeColorN_Pattern(Y)}shadingFill(Y){const{width:W,height:O}=this.viewport,nt=U.Util.inverseTransform(this.transformMatrix),[J,Ft,K,pt]=U.Util.getAxialAlignedBoundingBox([0,0,W,O],nt),Tt=this.svgFactory.createElement("svg:rect");Tt.setAttributeNS(null,"x",J),Tt.setAttributeNS(null,"y",Ft),Tt.setAttributeNS(null,"width",K-J),Tt.setAttributeNS(null,"height",pt-Ft),Tt.setAttributeNS(null,"fill",this._makeShadingPattern(Y)),this.current.fillAlpha<1&&Tt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Tt)}_makeColorN_Pattern(Y){return Y[0]==="TilingPattern"?this._makeTilingPattern(Y):this._makeShadingPattern(Y)}_makeTilingPattern(Y){const W=Y[1],O=Y[2],nt=Y[3]||U.IDENTITY_MATRIX,[J,Ft,K,pt]=Y[4],Tt=Y[5],Xt=Y[6],Lt=Y[7],Bt=`shading${it++}`,[Mt,Vt,Et,Dt]=U.Util.normalizeRect([...U.Util.applyTransform([J,Ft],nt),...U.Util.applyTransform([K,pt],nt)]),[Nt,ht]=U.Util.singularValueDecompose2dScale(nt),q=Tt*Nt,G=Xt*ht,tt=this.svgFactory.createElement("svg:pattern");tt.setAttributeNS(null,"id",Bt),tt.setAttributeNS(null,"patternUnits","userSpaceOnUse"),tt.setAttributeNS(null,"width",q),tt.setAttributeNS(null,"height",G),tt.setAttributeNS(null,"x",`${Mt}`),tt.setAttributeNS(null,"y",`${Vt}`);const mt=this.svg,_t=this.transformMatrix,vt=this.current.fillColor,kt=this.current.strokeColor,zt=this.svgFactory.create(Et-Mt,Dt-Vt);if(this.svg=zt,this.transformMatrix=nt,Lt===2){const Qt=U.Util.makeHexColor(...W);this.current.fillColor=Qt,this.current.strokeColor=Qt}return this.executeOpTree(this.convertOpList(O)),this.svg=mt,this.transformMatrix=_t,this.current.fillColor=vt,this.current.strokeColor=kt,tt.append(zt.childNodes[0]),this.defs.append(tt),`url(#${Bt})`}_makeShadingPattern(Y){switch(typeof Y=="string"&&(Y=this.objs.get(Y)),Y[0]){case"RadialAxial":const W=`shading${it++}`,O=Y[3];let nt;switch(Y[1]){case"axial":const J=Y[4],Ft=Y[5];nt=this.svgFactory.createElement("svg:linearGradient"),nt.setAttributeNS(null,"id",W),nt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),nt.setAttributeNS(null,"x1",J[0]),nt.setAttributeNS(null,"y1",J[1]),nt.setAttributeNS(null,"x2",Ft[0]),nt.setAttributeNS(null,"y2",Ft[1]);break;case"radial":const K=Y[4],pt=Y[5],Tt=Y[6],Xt=Y[7];nt=this.svgFactory.createElement("svg:radialGradient"),nt.setAttributeNS(null,"id",W),nt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),nt.setAttributeNS(null,"cx",pt[0]),nt.setAttributeNS(null,"cy",pt[1]),nt.setAttributeNS(null,"r",Xt),nt.setAttributeNS(null,"fx",K[0]),nt.setAttributeNS(null,"fy",K[1]),nt.setAttributeNS(null,"fr",Tt);break;default:throw new Error(`Unknown RadialAxial type: ${Y[1]}`)}for(const J of O){const Ft=this.svgFactory.createElement("svg:stop");Ft.setAttributeNS(null,"offset",J[0]),Ft.setAttributeNS(null,"stop-color",J[1]),nt.append(Ft)}return this.defs.append(nt),`url(#${W})`;case"Mesh":return(0,U.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${Y[0]}`)}}setDash(Y,W){this.current.dashArray=Y,this.current.dashPhase=W}constructPath(Y,W){const O=this.current;let nt=O.x,J=O.y,Ft=[],K=0;for(const pt of Y)switch(pt|0){case U.OPS.rectangle:nt=W[K++],J=W[K++];const Tt=W[K++],Xt=W[K++],Lt=nt+Tt,Bt=J+Xt;Ft.push("M",lt(nt),lt(J),"L",lt(Lt),lt(J),"L",lt(Lt),lt(Bt),"L",lt(nt),lt(Bt),"Z");break;case U.OPS.moveTo:nt=W[K++],J=W[K++],Ft.push("M",lt(nt),lt(J));break;case U.OPS.lineTo:nt=W[K++],J=W[K++],Ft.push("L",lt(nt),lt(J));break;case U.OPS.curveTo:nt=W[K+4],J=W[K+5],Ft.push("C",lt(W[K]),lt(W[K+1]),lt(W[K+2]),lt(W[K+3]),lt(nt),lt(J)),K+=6;break;case U.OPS.curveTo2:Ft.push("C",lt(nt),lt(J),lt(W[K]),lt(W[K+1]),lt(W[K+2]),lt(W[K+3])),nt=W[K+2],J=W[K+3],K+=4;break;case U.OPS.curveTo3:nt=W[K+2],J=W[K+3],Ft.push("C",lt(W[K]),lt(W[K+1]),lt(nt),lt(J),lt(nt),lt(J)),K+=4;break;case U.OPS.closePath:Ft.push("Z");break}Ft=Ft.join(" "),O.path&&Y.length>0&&Y[0]!==U.OPS.rectangle&&Y[0]!==U.OPS.moveTo?Ft=O.path.getAttributeNS(null,"d")+Ft:(O.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(O.path)),O.path.setAttributeNS(null,"d",Ft),O.path.setAttributeNS(null,"fill","none"),O.element=O.path,O.setCurrentPoint(nt,J)}endPath(){const Y=this.current;if(Y.path=null,!this.pendingClip)return;if(!Y.element){this.pendingClip=null;return}const W=`clippath${et++}`,O=this.svgFactory.createElement("svg:clipPath");O.setAttributeNS(null,"id",W),O.setAttributeNS(null,"transform",gt(this.transformMatrix));const nt=Y.element.cloneNode(!0);if(this.pendingClip==="evenodd"?nt.setAttributeNS(null,"clip-rule","evenodd"):nt.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,O.append(nt),this.defs.append(O),Y.activeClipUrl){Y.clipGroup=null;for(const J of this.extraStack)J.clipGroup=null;O.setAttributeNS(null,"clip-path",Y.activeClipUrl)}Y.activeClipUrl=`url(#${W})`,this.tgrp=null}clip(Y){this.pendingClip=Y}closePath(){const Y=this.current;if(Y.path){const W=`${Y.path.getAttributeNS(null,"d")}Z`;Y.path.setAttributeNS(null,"d",W)}}setLeading(Y){this.current.leading=-Y}setTextRise(Y){this.current.textRise=Y}setTextRenderingMode(Y){this.current.textRenderingMode=Y}setHScale(Y){this.current.textHScale=Y/100}setRenderingIntent(Y){}setFlatness(Y){}setGState(Y){for(const[W,O]of Y)switch(W){case"LW":this.setLineWidth(O);break;case"LC":this.setLineCap(O);break;case"LJ":this.setLineJoin(O);break;case"ML":this.setMiterLimit(O);break;case"D":this.setDash(O[0],O[1]);break;case"RI":this.setRenderingIntent(O);break;case"FL":this.setFlatness(O);break;case"Font":this.setFont(O);break;case"CA":this.setStrokeAlpha(O);break;case"ca":this.setFillAlpha(O);break;default:(0,U.warn)(`Unimplemented graphic state operator ${W}`);break}}fill(){const Y=this.current;Y.element&&(Y.element.setAttributeNS(null,"fill",Y.fillColor),Y.element.setAttributeNS(null,"fill-opacity",Y.fillAlpha),this.endPath())}stroke(){const Y=this.current;Y.element&&(this._setStrokeAttributes(Y.element),Y.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(Y,W=1){const O=this.current;let nt=O.dashArray;W!==1&&nt.length>0&&(nt=nt.map(function(J){return W*J})),Y.setAttributeNS(null,"stroke",O.strokeColor),Y.setAttributeNS(null,"stroke-opacity",O.strokeAlpha),Y.setAttributeNS(null,"stroke-miterlimit",lt(O.miterLimit)),Y.setAttributeNS(null,"stroke-linecap",O.lineCap),Y.setAttributeNS(null,"stroke-linejoin",O.lineJoin),Y.setAttributeNS(null,"stroke-width",lt(W*O.lineWidth)+"px"),Y.setAttributeNS(null,"stroke-dasharray",nt.map(lt).join(" ")),Y.setAttributeNS(null,"stroke-dashoffset",lt(W*O.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x","0"),Y.setAttributeNS(null,"y","0"),Y.setAttributeNS(null,"width","1px"),Y.setAttributeNS(null,"height","1px"),Y.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(Y)}paintImageXObject(Y){const W=this.getObject(Y);if(!W){(0,U.warn)(`Dependent image with object ID ${Y} is not ready yet`);return}this.paintInlineImageXObject(W)}paintInlineImageXObject(Y,W){const O=Y.width,nt=Y.height,J=bt(Y,this.forceDataSchema,!!W),Ft=this.svgFactory.createElement("svg:rect");Ft.setAttributeNS(null,"x","0"),Ft.setAttributeNS(null,"y","0"),Ft.setAttributeNS(null,"width",lt(O)),Ft.setAttributeNS(null,"height",lt(nt)),this.current.element=Ft,this.clip("nonzero");const K=this.svgFactory.createElement("svg:image");K.setAttributeNS(Yt,"xlink:href",J),K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y",lt(-nt)),K.setAttributeNS(null,"width",lt(O)+"px"),K.setAttributeNS(null,"height",lt(nt)+"px"),K.setAttributeNS(null,"transform",`scale(${lt(1/O)} ${lt(-1/nt)})`),W?W.append(K):this._ensureTransformGroup().append(K)}paintImageMaskXObject(Y){const W=this.getObject(Y.data,Y);if(W.bitmap){(0,U.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const O=this.current,nt=W.width,J=W.height,Ft=O.fillColor;O.maskId=`mask${Q++}`;const K=this.svgFactory.createElement("svg:mask");K.setAttributeNS(null,"id",O.maskId);const pt=this.svgFactory.createElement("svg:rect");pt.setAttributeNS(null,"x","0"),pt.setAttributeNS(null,"y","0"),pt.setAttributeNS(null,"width",lt(nt)),pt.setAttributeNS(null,"height",lt(J)),pt.setAttributeNS(null,"fill",Ft),pt.setAttributeNS(null,"mask",`url(#${O.maskId})`),this.defs.append(K),this._ensureTransformGroup().append(pt),this.paintInlineImageXObject(W,K)}paintFormXObjectBegin(Y,W){if(Array.isArray(Y)&&Y.length===6&&this.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),W){const O=W[2]-W[0],nt=W[3]-W[1],J=this.svgFactory.createElement("svg:rect");J.setAttributeNS(null,"x",W[0]),J.setAttributeNS(null,"y",W[1]),J.setAttributeNS(null,"width",lt(O)),J.setAttributeNS(null,"height",lt(nt)),this.current.element=J,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(Y){const W=this.svgFactory.create(Y.width,Y.height),O=this.svgFactory.createElement("svg:defs");W.append(O),this.defs=O;const nt=this.svgFactory.createElement("svg:g");return nt.setAttributeNS(null,"transform",gt(Y.transform)),W.append(nt),this.svg=nt,W}_ensureClipGroup(){if(!this.current.clipGroup){const Y=this.svgFactory.createElement("svg:g");Y.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(Y),this.current.clipGroup=Y}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",gt(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}w.SVGGraphics=xt},(rt,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.XfaText=void 0;class X{static textContent(U){const yt=[],dt={items:yt,styles:Object.create(null)};function Yt(At){if(!At)return;let ut=null;const Z=At.name;if(Z==="#text")ut=At.value;else if(X.shouldBuildText(Z))At?.attributes?.textContent?ut=At.attributes.textContent:At.value&&(ut=At.value);else return;if(ut!==null&&yt.push({str:ut}),!!At.children)for(const bt of At.children)Yt(bt)}return Yt(U),dt}static shouldBuildText(U){return!(U==="textarea"||U==="input"||U==="option"||U==="select")}}w.XfaText=X},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.TextLayerRenderTask=void 0,w.renderTextLayer=gt,w.updateTextLayer=et;var F=X(1),U=X(6);const yt=1e5,dt=30,Yt=.8,At=new Map;function ut(Q,it){let xt;if(it&&F.FeatureTest.isOffscreenCanvasSupported)xt=new OffscreenCanvas(Q,Q).getContext("2d",{alpha:!1});else{const ot=document.createElement("canvas");ot.width=ot.height=Q,xt=ot.getContext("2d",{alpha:!1})}return xt}function Z(Q,it){const xt=At.get(Q);if(xt)return xt;const ot=ut(dt,it);ot.font=`${dt}px ${Q}`;const Y=ot.measureText("");let W=Y.fontBoundingBoxAscent,O=Math.abs(Y.fontBoundingBoxDescent);if(W){const J=W/(W+O);return At.set(Q,J),ot.canvas.width=ot.canvas.height=0,J}ot.strokeStyle="red",ot.clearRect(0,0,dt,dt),ot.strokeText("g",0,0);let nt=ot.getImageData(0,0,dt,dt).data;O=0;for(let J=nt.length-1-3;J>=0;J-=4)if(nt[J]>0){O=Math.ceil(J/4/dt);break}ot.clearRect(0,0,dt,dt),ot.strokeText("A",0,dt),nt=ot.getImageData(0,0,dt,dt).data,W=0;for(let J=0,Ft=nt.length;J<Ft;J+=4)if(nt[J]>0){W=dt-Math.floor(J/4/dt);break}if(ot.canvas.width=ot.canvas.height=0,W){const J=W/(W+O);return At.set(Q,J),J}return At.set(Q,Yt),Yt}function bt(Q,it,xt){const ot=document.createElement("span"),Y={angle:0,canvasWidth:0,hasText:it.str!=="",hasEOL:it.hasEOL,fontSize:0};Q._textDivs.push(ot);const W=F.Util.transform(Q._transform,it.transform);let O=Math.atan2(W[1],W[0]);const nt=xt[it.fontName];nt.vertical&&(O+=Math.PI/2);const J=Math.hypot(W[2],W[3]),Ft=J*Z(nt.fontFamily,Q._isOffscreenCanvasSupported);let K,pt;O===0?(K=W[4],pt=W[5]-Ft):(K=W[4]+Ft*Math.sin(O),pt=W[5]-Ft*Math.cos(O));const Tt="calc(var(--scale-factor)*",Xt=ot.style;Q._container===Q._rootContainer?(Xt.left=`${(100*K/Q._pageWidth).toFixed(2)}%`,Xt.top=`${(100*pt/Q._pageHeight).toFixed(2)}%`):(Xt.left=`${Tt}${K.toFixed(2)}px)`,Xt.top=`${Tt}${pt.toFixed(2)}px)`),Xt.fontSize=`${Tt}${J.toFixed(2)}px)`,Xt.fontFamily=nt.fontFamily,Y.fontSize=J,ot.setAttribute("role","presentation"),ot.textContent=it.str,ot.dir=it.dir,Q._fontInspectorEnabled&&(ot.dataset.fontName=it.fontName),O!==0&&(Y.angle=O*(180/Math.PI));let Lt=!1;if(it.str.length>1)Lt=!0;else if(it.str!==" "&&it.transform[0]!==it.transform[3]){const Bt=Math.abs(it.transform[0]),Mt=Math.abs(it.transform[3]);Bt!==Mt&&Math.max(Bt,Mt)/Math.min(Bt,Mt)>1.5&&(Lt=!0)}Lt&&(Y.canvasWidth=nt.vertical?it.height:it.width),Q._textDivProperties.set(ot,Y),Q._isReadableStream&&Q._layoutText(ot)}function Ct(Q){const{div:it,scale:xt,properties:ot,ctx:Y,prevFontSize:W,prevFontFamily:O}=Q,{style:nt}=it;let J="";if(ot.canvasWidth!==0&&ot.hasText){const{fontFamily:Ft}=nt,{canvasWidth:K,fontSize:pt}=ot;(W!==pt||O!==Ft)&&(Y.font=`${pt*xt}px ${Ft}`,Q.prevFontSize=pt,Q.prevFontFamily=Ft);const{width:Tt}=Y.measureText(it.textContent);Tt>0&&(J=`scaleX(${K*xt/Tt})`)}ot.angle!==0&&(J=`rotate(${ot.angle}deg) ${J}`),J.length>0&&(nt.transform=J)}function at(Q){if(Q._canceled)return;const it=Q._textDivs,xt=Q._capability;if(it.length>yt){xt.resolve();return}if(!Q._isReadableStream)for(const Y of it)Q._layoutText(Y);xt.resolve()}class lt{constructor({textContentSource:it,container:xt,viewport:ot,textDivs:Y,textDivProperties:W,textContentItemsStr:O,isOffscreenCanvasSupported:nt}){this._textContentSource=it,this._isReadableStream=it instanceof ReadableStream,this._container=this._rootContainer=xt,this._textDivs=Y||[],this._textContentItemsStr=O||[],this._isOffscreenCanvasSupported=nt,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=W||new WeakMap,this._canceled=!1,this._capability=new F.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:ot.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:ut(0,nt)};const{pageWidth:J,pageHeight:Ft,pageX:K,pageY:pt}=ot.rawDims;this._transform=[1,0,0,-1,-K,pt+Ft],this._pageWidth=J,this._pageHeight=Ft,(0,U.setLayerDimensions)(xt,ot),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new F.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new F.AbortException("TextLayer task cancelled."))}_processItems(it,xt){for(const ot of it){if(ot.str===void 0){if(ot.type==="beginMarkedContentProps"||ot.type==="beginMarkedContent"){const Y=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),ot.id!==null&&this._container.setAttribute("id",`${ot.id}`),Y.append(this._container)}else ot.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(ot.str),bt(this,ot,xt)}}_layoutText(it){const xt=this._layoutTextParams.properties=this._textDivProperties.get(it);if(this._layoutTextParams.div=it,Ct(this._layoutTextParams),xt.hasText&&this._container.append(it),xt.hasEOL){const ot=document.createElement("br");ot.setAttribute("role","presentation"),this._container.append(ot)}}_render(){const it=new F.PromiseCapability;let xt=Object.create(null);if(this._isReadableStream){const ot=()=>{this._reader.read().then(({value:Y,done:W})=>{if(W){it.resolve();return}Object.assign(xt,Y.styles),this._processItems(Y.items,xt),ot()},it.reject)};this._reader=this._textContentSource.getReader(),ot()}else if(this._textContentSource){const{items:ot,styles:Y}=this._textContentSource;this._processItems(ot,Y),it.resolve()}else throw new Error('No "textContentSource" parameter specified.');it.promise.then(()=>{xt=null,at(this)},this._capability.reject)}}w.TextLayerRenderTask=lt;function gt(Q){!Q.textContentSource&&(Q.textContent||Q.textContentStream)&&((0,U.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),Q.textContentSource=Q.textContent||Q.textContentStream);const{container:it,viewport:xt}=Q,ot=getComputedStyle(it),Y=ot.getPropertyValue("visibility"),W=parseFloat(ot.getPropertyValue("--scale-factor"));Y==="visible"&&(!W||Math.abs(W-xt.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const O=new lt(Q);return O._render(),O}function et({container:Q,viewport:it,textDivs:xt,textDivProperties:ot,isOffscreenCanvasSupported:Y,mustRotate:W=!0,mustRescale:O=!0}){if(W&&(0,U.setLayerDimensions)(Q,{rotation:it.rotation}),O){const nt=ut(0,Y),Ft={prevFontSize:null,prevFontFamily:null,div:null,scale:it.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:nt};for(const K of xt)Ft.properties=ot.get(K),Ft.div=K,Ct(Ft)}}},(rt,w,X)=>{var Z,bt,Ct,at,lt,gt,et,Q,it,xt,ot,Os,cs,Ls,Ns;Object.defineProperty(w,"__esModule",{value:!0}),w.AnnotationEditorLayer=void 0;var F=X(1),U=X(4),yt=X(28),dt=X(33),Yt=X(6),At=X(34);const J=class J{constructor({uiManager:K,pageIndex:pt,div:Tt,accessibilityManager:Xt,annotationLayer:Lt,viewport:Bt,l10n:Mt}){Ht(this,ot);Ht(this,Z);Ht(this,bt,!1);Ht(this,Ct,null);Ht(this,at,this.pointerup.bind(this));Ht(this,lt,this.pointerdown.bind(this));Ht(this,gt,new Map);Ht(this,et,!1);Ht(this,Q,!1);Ht(this,it,!1);Ht(this,xt);const Vt=[yt.FreeTextEditor,dt.InkEditor,At.StampEditor];if(!J._initialized){J._initialized=!0;for(const Et of Vt)Et.initialize(Mt)}K.registerEditorTypes(Vt),Wt(this,xt,K),this.pageIndex=pt,this.div=Tt,Wt(this,Z,Xt),Wt(this,Ct,Lt),this.viewport=Bt,D(this,xt).addLayer(this)}get isEmpty(){return D(this,gt).size===0}updateToolbar(K){D(this,xt).updateToolbar(K)}updateMode(K=D(this,xt).getMode()){Rt(this,ot,Ns).call(this),K===F.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),K!==F.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",K===F.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",K===F.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",K===F.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(K){if(!K&&D(this,xt).getMode()!==F.AnnotationEditorType.INK)return;if(!K){for(const Tt of D(this,gt).values())if(Tt.isEmpty()){Tt.setInBackground();return}}Rt(this,ot,cs).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(K){D(this,xt).setEditingState(K)}addCommands(K){D(this,xt).addCommands(K)}enable(){this.div.style.pointerEvents="auto";const K=new Set;for(const Tt of D(this,gt).values())Tt.enableEditing(),Tt.annotationElementId&&K.add(Tt.annotationElementId);if(!D(this,Ct))return;const pt=D(this,Ct).getEditableAnnotations();for(const Tt of pt){if(Tt.hide(),D(this,xt).isDeletedAnnotationElement(Tt.data.id)||K.has(Tt.data.id))continue;const Xt=this.deserialize(Tt);Xt&&(this.addOrRebuild(Xt),Xt.enableEditing())}}disable(){Wt(this,it,!0),this.div.style.pointerEvents="none";const K=new Set;for(const pt of D(this,gt).values()){if(pt.disableEditing(),!pt.annotationElementId||pt.serialize()!==null){K.add(pt.annotationElementId);continue}this.getEditableAnnotation(pt.annotationElementId)?.show(),pt.remove()}if(D(this,Ct)){const pt=D(this,Ct).getEditableAnnotations();for(const Tt of pt){const{id:Xt}=Tt.data;K.has(Xt)||D(this,xt).isDeletedAnnotationElement(Xt)||Tt.show()}}Rt(this,ot,Ns).call(this),this.isEmpty&&(this.div.hidden=!0),Wt(this,it,!1)}getEditableAnnotation(K){return D(this,Ct)?.getEditableAnnotation(K)||null}setActiveEditor(K){D(this,xt).getActive()!==K&&D(this,xt).setActiveEditor(K)}enableClick(){this.div.addEventListener("pointerdown",D(this,lt)),this.div.addEventListener("pointerup",D(this,at))}disableClick(){this.div.removeEventListener("pointerdown",D(this,lt)),this.div.removeEventListener("pointerup",D(this,at))}attach(K){D(this,gt).set(K.id,K);const{annotationElementId:pt}=K;pt&&D(this,xt).isDeletedAnnotationElement(pt)&&D(this,xt).removeDeletedAnnotationElement(K)}detach(K){D(this,gt).delete(K.id),D(this,Z)?.removePointerInTextLayer(K.contentDiv),!D(this,it)&&K.annotationElementId&&D(this,xt).addDeletedAnnotationElement(K)}remove(K){this.detach(K),D(this,xt).removeEditor(K),K.div.contains(document.activeElement)&&setTimeout(()=>{D(this,xt).focusMainContainer()},0),K.div.remove(),K.isAttachedToDOM=!1,D(this,Q)||this.addInkEditorIfNeeded(!1)}changeParent(K){K.parent!==this&&(K.annotationElementId&&(D(this,xt).addDeletedAnnotationElement(K.annotationElementId),U.AnnotationEditor.deleteAnnotationElement(K),K.annotationElementId=null),this.attach(K),K.parent?.detach(K),K.setParent(this),K.div&&K.isAttachedToDOM&&(K.div.remove(),this.div.append(K.div)))}add(K){if(this.changeParent(K),D(this,xt).addEditor(K),this.attach(K),!K.isAttachedToDOM){const pt=K.render();this.div.append(pt),K.isAttachedToDOM=!0}K.fixAndSetPosition(),K.onceAdded(),D(this,xt).addToAnnotationStorage(K)}moveEditorInDOM(K){if(!K.isAttachedToDOM)return;const{activeElement:pt}=document;K.div.contains(pt)&&(K._focusEventsAllowed=!1,setTimeout(()=>{K.div.contains(document.activeElement)?K._focusEventsAllowed=!0:(K.div.addEventListener("focusin",()=>{K._focusEventsAllowed=!0},{once:!0}),pt.focus())},0)),K._structTreeParentId=D(this,Z)?.moveElementInDOM(this.div,K.div,K.contentDiv,!0)}addOrRebuild(K){K.needsToBeRebuilt()?K.rebuild():this.add(K)}addUndoableEditor(K){const pt=()=>K._uiManager.rebuild(K),Tt=()=>{K.remove()};this.addCommands({cmd:pt,undo:Tt,mustExec:!1})}getNextId(){return D(this,xt).getId()}pasteEditor(K,pt){D(this,xt).updateToolbar(K),D(this,xt).updateMode(K);const{offsetX:Tt,offsetY:Xt}=Rt(this,ot,Ls).call(this),Lt=this.getNextId(),Bt=Rt(this,ot,Os).call(this,{parent:this,id:Lt,x:Tt,y:Xt,uiManager:D(this,xt),isCentered:!0,...pt});Bt&&this.add(Bt)}deserialize(K){switch(K.annotationType??K.annotationEditorType){case F.AnnotationEditorType.FREETEXT:return yt.FreeTextEditor.deserialize(K,this,D(this,xt));case F.AnnotationEditorType.INK:return dt.InkEditor.deserialize(K,this,D(this,xt));case F.AnnotationEditorType.STAMP:return At.StampEditor.deserialize(K,this,D(this,xt))}return null}addNewEditor(){Rt(this,ot,cs).call(this,Rt(this,ot,Ls).call(this),!0)}setSelected(K){D(this,xt).setSelected(K)}toggleSelected(K){D(this,xt).toggleSelected(K)}isSelected(K){return D(this,xt).isSelected(K)}unselect(K){D(this,xt).unselect(K)}pointerup(K){const{isMac:pt}=F.FeatureTest.platform;if(!(K.button!==0||K.ctrlKey&&pt)&&K.target===this.div&&D(this,et)){if(Wt(this,et,!1),!D(this,bt)){Wt(this,bt,!0);return}if(D(this,xt).getMode()===F.AnnotationEditorType.STAMP){D(this,xt).unselectAll();return}Rt(this,ot,cs).call(this,K,!1)}}pointerdown(K){if(D(this,et)){Wt(this,et,!1);return}const{isMac:pt}=F.FeatureTest.platform;if(K.button!==0||K.ctrlKey&&pt||K.target!==this.div)return;Wt(this,et,!0);const Tt=D(this,xt).getActive();Wt(this,bt,!Tt||Tt.isEmpty())}findNewParent(K,pt,Tt){const Xt=D(this,xt).findParent(pt,Tt);return Xt===null||Xt===this?!1:(Xt.changeParent(K),!0)}destroy(){D(this,xt).getActive()?.parent===this&&(D(this,xt).commitOrRemove(),D(this,xt).setActiveEditor(null));for(const K of D(this,gt).values())D(this,Z)?.removePointerInTextLayer(K.contentDiv),K.setParent(null),K.isAttachedToDOM=!1,K.div.remove();this.div=null,D(this,gt).clear(),D(this,xt).removeLayer(this)}render({viewport:K}){this.viewport=K,(0,Yt.setLayerDimensions)(this.div,K);for(const pt of D(this,xt).getEditors(this.pageIndex))this.add(pt);this.updateMode()}update({viewport:K}){D(this,xt).commitOrRemove(),this.viewport=K,(0,Yt.setLayerDimensions)(this.div,{rotation:K.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:K,pageHeight:pt}=this.viewport.rawDims;return[K,pt]}};Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakMap,lt=new WeakMap,gt=new WeakMap,et=new WeakMap,Q=new WeakMap,it=new WeakMap,xt=new WeakMap,ot=new WeakSet,Os=function(K){switch(D(this,xt).getMode()){case F.AnnotationEditorType.FREETEXT:return new yt.FreeTextEditor(K);case F.AnnotationEditorType.INK:return new dt.InkEditor(K);case F.AnnotationEditorType.STAMP:return new At.StampEditor(K)}return null},cs=function(K,pt){const Tt=this.getNextId(),Xt=Rt(this,ot,Os).call(this,{parent:this,id:Tt,x:K.offsetX,y:K.offsetY,uiManager:D(this,xt),isCentered:pt});return Xt&&this.add(Xt),Xt},Ls=function(){const{x:K,y:pt,width:Tt,height:Xt}=this.div.getBoundingClientRect(),Lt=Math.max(0,K),Bt=Math.max(0,pt),Mt=Math.min(window.innerWidth,K+Tt),Vt=Math.min(window.innerHeight,pt+Xt),Et=(Lt+Mt)/2-K,Dt=(Bt+Vt)/2-pt,[Nt,ht]=this.viewport.rotation%180===0?[Et,Dt]:[Dt,Et];return{offsetX:Nt,offsetY:ht}},Ns=function(){Wt(this,Q,!0);for(const K of D(this,gt).values())K.isEmpty()&&K.remove();Wt(this,Q,!1)},Oe(J,"_initialized",!1);let ut=J;w.AnnotationEditorLayer=ut},(rt,w,X)=>{var At,ut,Z,bt,Ct,at,lt,gt,et,Q,ui,pi,fi,ts,$s,gi,Us;Object.defineProperty(w,"__esModule",{value:!0}),w.FreeTextEditor=void 0;var F=X(1),U=X(5),yt=X(4),dt=X(29);const J=class J extends yt.AnnotationEditor{constructor(pt){super({...pt,name:"freeTextEditor"});Ht(this,Q);Ht(this,At,this.editorDivBlur.bind(this));Ht(this,ut,this.editorDivFocus.bind(this));Ht(this,Z,this.editorDivInput.bind(this));Ht(this,bt,this.editorDivKeydown.bind(this));Ht(this,Ct);Ht(this,at,"");Ht(this,lt,`${this.id}-editor`);Ht(this,gt);Ht(this,et,null);Wt(this,Ct,pt.color||J._defaultColor||yt.AnnotationEditor._defaultLineColor),Wt(this,gt,pt.fontSize||J._defaultFontSize)}static get _keyboardManager(){const pt=J.prototype,Tt=Bt=>Bt.isEmpty(),Xt=U.AnnotationEditorUIManager.TRANSLATE_SMALL,Lt=U.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,F.shadow)(this,"_keyboardManager",new U.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],pt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],pt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],pt._translateEmpty,{args:[-Xt,0],checker:Tt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],pt._translateEmpty,{args:[-Lt,0],checker:Tt}],[["ArrowRight","mac+ArrowRight"],pt._translateEmpty,{args:[Xt,0],checker:Tt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],pt._translateEmpty,{args:[Lt,0],checker:Tt}],[["ArrowUp","mac+ArrowUp"],pt._translateEmpty,{args:[0,-Xt],checker:Tt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],pt._translateEmpty,{args:[0,-Lt],checker:Tt}],[["ArrowDown","mac+ArrowDown"],pt._translateEmpty,{args:[0,Xt],checker:Tt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],pt._translateEmpty,{args:[0,Lt],checker:Tt}]]))}static initialize(pt){yt.AnnotationEditor.initialize(pt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Tt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Tt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(pt,Tt){switch(pt){case F.AnnotationEditorParamsType.FREETEXT_SIZE:J._defaultFontSize=Tt;break;case F.AnnotationEditorParamsType.FREETEXT_COLOR:J._defaultColor=Tt;break}}updateParams(pt,Tt){switch(pt){case F.AnnotationEditorParamsType.FREETEXT_SIZE:Rt(this,Q,ui).call(this,Tt);break;case F.AnnotationEditorParamsType.FREETEXT_COLOR:Rt(this,Q,pi).call(this,Tt);break}}static get defaultPropertiesToUpdate(){return[[F.AnnotationEditorParamsType.FREETEXT_SIZE,J._defaultFontSize],[F.AnnotationEditorParamsType.FREETEXT_COLOR,J._defaultColor||yt.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[F.AnnotationEditorParamsType.FREETEXT_SIZE,D(this,gt)],[F.AnnotationEditorParamsType.FREETEXT_COLOR,D(this,Ct)]]}_translateEmpty(pt,Tt){this._uiManager.translateSelectedEditors(pt,Tt,!0)}getInitialTranslation(){const pt=this.parentScale;return[-J._internalPadding*pt,-(J._internalPadding+D(this,gt))*pt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(F.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",D(this,bt)),this.editorDiv.addEventListener("focus",D(this,ut)),this.editorDiv.addEventListener("blur",D(this,At)),this.editorDiv.addEventListener("input",D(this,Z)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",D(this,lt)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",D(this,bt)),this.editorDiv.removeEventListener("focus",D(this,ut)),this.editorDiv.removeEventListener("blur",D(this,At)),this.editorDiv.removeEventListener("input",D(this,Z)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(pt){this._focusEventsAllowed&&(super.focusin(pt),pt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){Rt(this,Q,Us).call(this);return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const pt=D(this,at),Tt=Wt(this,at,Rt(this,Q,fi).call(this).trimEnd());if(pt===Tt)return;const Xt=Lt=>{if(Wt(this,at,Lt),!Lt){this.remove();return}Rt(this,Q,$s).call(this),this._uiManager.rebuild(this),Rt(this,Q,ts).call(this)};this.addCommands({cmd:()=>{Xt(Tt)},undo:()=>{Xt(pt)},mustExec:!1}),Rt(this,Q,ts).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(pt){this.enterInEditMode()}keydown(pt){pt.target===this.div&&pt.key==="Enter"&&(this.enterInEditMode(),pt.preventDefault())}editorDivKeydown(pt){J._keyboardManager.exec(this,pt)}editorDivFocus(pt){this.isEditing=!0}editorDivBlur(pt){this.isEditing=!1}editorDivInput(pt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let pt,Tt;this.width&&(pt=this.x,Tt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",D(this,lt)),this.enableEditing(),yt.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Lt=>this.editorDiv?.setAttribute("aria-label",Lt)),yt.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Lt=>this.editorDiv?.setAttribute("default-content",Lt)),this.editorDiv.contentEditable=!0;const{style:Xt}=this.editorDiv;if(Xt.fontSize=`calc(${D(this,gt)}px * var(--scale-factor))`,Xt.color=D(this,Ct),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,U.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Lt,Bt]=this.parentDimensions;if(this.annotationElementId){const{position:Mt}=D(this,et);let[Vt,Et]=this.getInitialTranslation();[Vt,Et]=this.pageTranslationToScreen(Vt,Et);const[Dt,Nt]=this.pageDimensions,[ht,q]=this.pageTranslation;let G,tt;switch(this.rotation){case 0:G=pt+(Mt[0]-ht)/Dt,tt=Tt+this.height-(Mt[1]-q)/Nt;break;case 90:G=pt+(Mt[0]-ht)/Dt,tt=Tt-(Mt[1]-q)/Nt,[Vt,Et]=[Et,-Vt];break;case 180:G=pt-this.width+(Mt[0]-ht)/Dt,tt=Tt-(Mt[1]-q)/Nt,[Vt,Et]=[-Vt,-Et];break;case 270:G=pt+(Mt[0]-ht-this.height*Nt)/Dt,tt=Tt+(Mt[1]-q-this.width*Dt)/Nt,[Vt,Et]=[-Et,Vt];break}this.setAt(G*Lt,tt*Bt,Vt,Et)}else this.setAt(pt*Lt,Tt*Bt,this.width*Lt,this.height*Bt);Rt(this,Q,$s).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(pt,Tt,Xt){let Lt=null;if(pt instanceof dt.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Mt,fontColor:Vt},rect:Et,rotation:Dt,id:Nt},textContent:ht,textPosition:q,parent:{page:{pageNumber:G}}}=pt;if(!ht||ht.length===0)return null;Lt=pt={annotationType:F.AnnotationEditorType.FREETEXT,color:Array.from(Vt),fontSize:Mt,value:ht.join(`
`),position:q,pageIndex:G-1,rect:Et,rotation:Dt,id:Nt,deleted:!1}}const Bt=super.deserialize(pt,Tt,Xt);return Wt(Bt,gt,pt.fontSize),Wt(Bt,Ct,F.Util.makeHexColor(...pt.color)),Wt(Bt,at,pt.value),Bt.annotationElementId=pt.id||null,Wt(Bt,et,Lt),Bt}serialize(pt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Tt=J._internalPadding*this.parentScale,Xt=this.getRect(Tt,Tt),Lt=yt.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:D(this,Ct)),Bt={annotationType:F.AnnotationEditorType.FREETEXT,color:Lt,fontSize:D(this,gt),value:D(this,at),pageIndex:this.pageIndex,rect:Xt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return pt?Bt:this.annotationElementId&&!Rt(this,Q,gi).call(this,Bt)?null:(Bt.id=this.annotationElementId,Bt)}};At=new WeakMap,ut=new WeakMap,Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakMap,lt=new WeakMap,gt=new WeakMap,et=new WeakMap,Q=new WeakSet,ui=function(pt){const Tt=Lt=>{this.editorDiv.style.fontSize=`calc(${Lt}px * var(--scale-factor))`,this.translate(0,-(Lt-D(this,gt))*this.parentScale),Wt(this,gt,Lt),Rt(this,Q,ts).call(this)},Xt=D(this,gt);this.addCommands({cmd:()=>{Tt(pt)},undo:()=>{Tt(Xt)},mustExec:!0,type:F.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},pi=function(pt){const Tt=D(this,Ct);this.addCommands({cmd:()=>{Wt(this,Ct,this.editorDiv.style.color=pt)},undo:()=>{Wt(this,Ct,this.editorDiv.style.color=Tt)},mustExec:!0,type:F.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},fi=function(){const pt=this.editorDiv.getElementsByTagName("div");if(pt.length===0)return this.editorDiv.innerText;const Tt=[];for(const Xt of pt)Tt.push(Xt.innerText.replace(/\r\n?|\n/,""));return Tt.join(`
`)},ts=function(){const[pt,Tt]=this.parentDimensions;let Xt;if(this.isAttachedToDOM)Xt=this.div.getBoundingClientRect();else{const{currentLayer:Lt,div:Bt}=this,Mt=Bt.style.display;Bt.style.display="hidden",Lt.div.append(this.div),Xt=Bt.getBoundingClientRect(),Bt.remove(),Bt.style.display=Mt}this.rotation%180===this.parentRotation%180?(this.width=Xt.width/pt,this.height=Xt.height/Tt):(this.width=Xt.height/pt,this.height=Xt.width/Tt),this.fixAndSetPosition()},$s=function(){if(this.editorDiv.replaceChildren(),!!D(this,at))for(const pt of D(this,at).split(`
`)){const Tt=document.createElement("div");Tt.append(pt?document.createTextNode(pt):document.createElement("br")),this.editorDiv.append(Tt)}},gi=function(pt){const{value:Tt,fontSize:Xt,color:Lt,rect:Bt,pageIndex:Mt}=D(this,et);return pt.value!==Tt||pt.fontSize!==Xt||pt.rect.some((Vt,Et)=>Math.abs(Vt-Bt[Et])>=1)||pt.color.some((Vt,Et)=>Vt!==Lt[Et])||pt.pageIndex!==Mt},Us=function(pt=!1){if(!this.annotationElementId)return;if(Rt(this,Q,ts).call(this),!pt&&(this.width===0||this.height===0)){setTimeout(()=>Rt(this,Q,Us).call(this,!0),0);return}const Tt=J._internalPadding*this.parentScale;D(this,et).rect=this.getRect(Tt,Tt)},Oe(J,"_freeTextDefaultContent",""),Oe(J,"_internalPadding",0),Oe(J,"_defaultColor",null),Oe(J,"_defaultFontSize",10),Oe(J,"_type","freetext");let Yt=J;w.FreeTextEditor=Yt},(rt,w,X)=>{var tt,_t,je,mi,zt,Qt,te,se,ne,ae,$t,Ut,st,St,It,jt,Zt,re,oe,Ot,he,de,bi,hs,Bs,js,we,ke,Fe,le,Gt,qt,me,Hs,Te,wt,ie,ue,_i,Ws;Object.defineProperty(w,"__esModule",{value:!0}),w.StampAnnotationElement=w.InkAnnotationElement=w.FreeTextAnnotationElement=w.AnnotationLayer=void 0;var F=X(1),U=X(6),yt=X(3),dt=X(30),Yt=X(31),At=X(32);const ut=1e3,Z=9,bt=new WeakSet;function Ct(ge){return{width:ge[2]-ge[0],height:ge[3]-ge[1]}}class at{static create(ft){switch(ft.data.annotationType){case F.AnnotationType.LINK:return new gt(ft);case F.AnnotationType.TEXT:return new et(ft);case F.AnnotationType.WIDGET:switch(ft.data.fieldType){case"Tx":return new it(ft);case"Btn":return ft.data.radioButton?new Y(ft):ft.data.checkBox?new ot(ft):new W(ft);case"Ch":return new O(ft);case"Sig":return new xt(ft)}return new Q(ft);case F.AnnotationType.POPUP:return new nt(ft);case F.AnnotationType.FREETEXT:return new Ft(ft);case F.AnnotationType.LINE:return new K(ft);case F.AnnotationType.SQUARE:return new pt(ft);case F.AnnotationType.CIRCLE:return new Tt(ft);case F.AnnotationType.POLYLINE:return new Xt(ft);case F.AnnotationType.CARET:return new Bt(ft);case F.AnnotationType.INK:return new Mt(ft);case F.AnnotationType.POLYGON:return new Lt(ft);case F.AnnotationType.HIGHLIGHT:return new Vt(ft);case F.AnnotationType.UNDERLINE:return new Et(ft);case F.AnnotationType.SQUIGGLY:return new Dt(ft);case F.AnnotationType.STRIKEOUT:return new Nt(ft);case F.AnnotationType.STAMP:return new ht(ft);case F.AnnotationType.FILEATTACHMENT:return new q(ft);default:return new lt(ft)}}}const mt=class mt{constructor(ft,{isRenderable:ct=!1,ignoreBorder:Pt=!1,createQuadrilaterals:Kt=!1}={}){Ht(this,tt,!1);this.isRenderable=ct,this.data=ft.data,this.layer=ft.layer,this.linkService=ft.linkService,this.downloadManager=ft.downloadManager,this.imageResourcesPath=ft.imageResourcesPath,this.renderForms=ft.renderForms,this.svgFactory=ft.svgFactory,this.annotationStorage=ft.annotationStorage,this.enableScripting=ft.enableScripting,this.hasJSActions=ft.hasJSActions,this._fieldObjects=ft.fieldObjects,this.parent=ft.parent,ct&&(this.container=this._createContainer(Pt)),Kt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:ft,contentsObj:ct,richText:Pt}){return!!(ft?.str||ct?.str||Pt?.str)}get hasPopupData(){return mt._hasPopupData(this.data)}_createContainer(ft){const{data:ct,parent:{page:Pt,viewport:Kt}}=this,Jt=document.createElement("section");Jt.setAttribute("data-annotation-id",ct.id),this instanceof Q||(Jt.tabIndex=ut),Jt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Jt.setAttribute("aria-haspopup","dialog"),ct.noRotate&&Jt.classList.add("norotate");const{pageWidth:ee,pageHeight:ce,pageX:pe,pageY:Se}=Kt.rawDims;if(!ct.rect||this instanceof nt){const{rotation:Pe}=ct;return!ct.hasOwnCanvas&&Pe!==0&&this.setRotation(Pe,Jt),Jt}const{width:Ae,height:fe}=Ct(ct.rect),_e=F.Util.normalizeRect([ct.rect[0],Pt.view[3]-ct.rect[1]+Pt.view[1],ct.rect[2],Pt.view[3]-ct.rect[3]+Pt.view[1]]);if(!ft&&ct.borderStyle.width>0){Jt.style.borderWidth=`${ct.borderStyle.width}px`;const Pe=ct.borderStyle.horizontalCornerRadius,Ie=ct.borderStyle.verticalCornerRadius;if(Pe>0||Ie>0){const Le=`calc(${Pe}px * var(--scale-factor)) / calc(${Ie}px * var(--scale-factor))`;Jt.style.borderRadius=Le}else if(this instanceof Y){const Le=`calc(${Ae}px * var(--scale-factor)) / calc(${fe}px * var(--scale-factor))`;Jt.style.borderRadius=Le}switch(ct.borderStyle.style){case F.AnnotationBorderStyleType.SOLID:Jt.style.borderStyle="solid";break;case F.AnnotationBorderStyleType.DASHED:Jt.style.borderStyle="dashed";break;case F.AnnotationBorderStyleType.BEVELED:(0,F.warn)("Unimplemented border style: beveled");break;case F.AnnotationBorderStyleType.INSET:(0,F.warn)("Unimplemented border style: inset");break;case F.AnnotationBorderStyleType.UNDERLINE:Jt.style.borderBottomStyle="solid";break}const De=ct.borderColor||null;De?(Wt(this,tt,!0),Jt.style.borderColor=F.Util.makeHexColor(De[0]|0,De[1]|0,De[2]|0)):Jt.style.borderWidth=0}Jt.style.left=`${100*(_e[0]-pe)/ee}%`,Jt.style.top=`${100*(_e[1]-Se)/ce}%`;const{rotation:Ee}=ct;return ct.hasOwnCanvas||Ee===0?(Jt.style.width=`${100*Ae/ee}%`,Jt.style.height=`${100*fe/ce}%`):this.setRotation(Ee,Jt),Jt}setRotation(ft,ct=this.container){if(!this.data.rect)return;const{pageWidth:Pt,pageHeight:Kt}=this.parent.viewport.rawDims,{width:Jt,height:ee}=Ct(this.data.rect);let ce,pe;ft%180===0?(ce=100*Jt/Pt,pe=100*ee/Kt):(ce=100*ee/Pt,pe=100*Jt/Kt),ct.style.width=`${ce}%`,ct.style.height=`${pe}%`,ct.setAttribute("data-main-rotation",(360-ft)%360)}get _commonActions(){const ft=(ct,Pt,Kt)=>{const Jt=Kt.detail[ct],ee=Jt[0],ce=Jt.slice(1);Kt.target.style[Pt]=dt.ColorConverters[`${ee}_HTML`](ce),this.annotationStorage.setValue(this.data.id,{[Pt]:dt.ColorConverters[`${ee}_rgb`](ce)})};return(0,F.shadow)(this,"_commonActions",{display:ct=>{const{display:Pt}=ct.detail,Kt=Pt%2===1;this.container.style.visibility=Kt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Kt,noPrint:Pt===1||Pt===2})},print:ct=>{this.annotationStorage.setValue(this.data.id,{noPrint:!ct.detail.print})},hidden:ct=>{const{hidden:Pt}=ct.detail;this.container.style.visibility=Pt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Pt,noView:Pt})},focus:ct=>{setTimeout(()=>ct.target.focus({preventScroll:!1}),0)},userName:ct=>{ct.target.title=ct.detail.userName},readonly:ct=>{ct.target.disabled=ct.detail.readonly},required:ct=>{this._setRequired(ct.target,ct.detail.required)},bgColor:ct=>{ft("bgColor","backgroundColor",ct)},fillColor:ct=>{ft("fillColor","backgroundColor",ct)},fgColor:ct=>{ft("fgColor","color",ct)},textColor:ct=>{ft("textColor","color",ct)},borderColor:ct=>{ft("borderColor","borderColor",ct)},strokeColor:ct=>{ft("strokeColor","borderColor",ct)},rotation:ct=>{const Pt=ct.detail.rotation;this.setRotation(Pt),this.annotationStorage.setValue(this.data.id,{rotation:Pt})}})}_dispatchEventFromSandbox(ft,ct){const Pt=this._commonActions;for(const Kt of Object.keys(ct.detail))(ft[Kt]||Pt[Kt])?.(ct)}_setDefaultPropertiesFromJS(ft){if(!this.enableScripting)return;const ct=this.annotationStorage.getRawValue(this.data.id);if(!ct)return;const Pt=this._commonActions;for(const[Kt,Jt]of Object.entries(ct)){const ee=Pt[Kt];if(ee){const ce={detail:{[Kt]:Jt},target:ft};ee(ce),delete ct[Kt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:ft}=this.data;if(!ft)return;const[ct,Pt,Kt,Jt]=this.data.rect;if(ft.length===1){const[,{x:Ie,y:De},{x:Le,y:Ue}]=ft[0];if(Kt===Ie&&Jt===De&&ct===Le&&Pt===Ue)return}const{style:ee}=this.container;let ce;if(D(this,tt)){const{borderColor:Ie,borderWidth:De}=ee;ee.borderWidth=0,ce=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ie}" stroke-width="${De}">`],this.container.classList.add("hasBorder")}const pe=Kt-ct,Se=Jt-Pt,{svgFactory:Ae}=this,fe=Ae.createElement("svg");fe.classList.add("quadrilateralsContainer"),fe.setAttribute("width",0),fe.setAttribute("height",0);const _e=Ae.createElement("defs");fe.append(_e);const Ee=Ae.createElement("clipPath"),Pe=`clippath_${this.data.id}`;Ee.setAttribute("id",Pe),Ee.setAttribute("clipPathUnits","objectBoundingBox"),_e.append(Ee);for(const[,{x:Ie,y:De},{x:Le,y:Ue}]of ft){const Ne=Ae.createElement("rect"),Ve=(Le-ct)/pe,Xe=(Jt-De)/Se,Qs=(Ie-Le)/pe,Zs=(De-Ue)/Se;Ne.setAttribute("x",Ve),Ne.setAttribute("y",Xe),Ne.setAttribute("width",Qs),Ne.setAttribute("height",Zs),Ee.append(Ne),ce?.push(`<rect vector-effect="non-scaling-stroke" x="${Ve}" y="${Xe}" width="${Qs}" height="${Zs}"/>`)}D(this,tt)&&(ce.push("</g></svg>')"),ee.backgroundImage=ce.join("")),this.container.append(fe),this.container.style.clipPath=`url(#${Pe})`}_createPopup(){const{container:ft,data:ct}=this;ft.setAttribute("aria-haspopup","dialog");const Pt=new nt({data:{color:ct.color,titleObj:ct.titleObj,modificationDate:ct.modificationDate,contentsObj:ct.contentsObj,richText:ct.richText,parentRect:ct.rect,borderStyle:0,id:`popup_${ct.id}`,rotation:ct.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Pt.render())}render(){(0,F.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(ft,ct=null){const Pt=[];if(this._fieldObjects){const Kt=this._fieldObjects[ft];if(Kt)for(const{page:Jt,id:ee,exportValues:ce}of Kt){if(Jt===-1||ee===ct)continue;const pe=typeof ce=="string"?ce:null,Se=document.querySelector(`[data-element-id="${ee}"]`);if(Se&&!bt.has(Se)){(0,F.warn)(`_getElementsByName - element not allowed: ${ee}`);continue}Pt.push({id:ee,exportValue:pe,domElement:Se})}return Pt}for(const Kt of document.getElementsByName(ft)){const{exportValue:Jt}=Kt,ee=Kt.getAttribute("data-element-id");ee!==ct&&bt.has(Kt)&&Pt.push({id:ee,exportValue:Jt,domElement:Kt})}return Pt}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const ft=this.getElementsToTriggerPopup();if(Array.isArray(ft))for(const ct of ft)ct.classList.add("highlightArea");else ft.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:ft,data:{id:ct}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:ft,editId:ct})})}};tt=new WeakMap;let lt=mt;class gt extends lt{constructor(ct,Pt=null){super(ct,{isRenderable:!0,ignoreBorder:!!Pt?.ignoreBorder,createQuadrilaterals:!0});Ht(this,_t);this.isTooltipOnly=ct.data.isTooltipOnly}render(){const{data:ct,linkService:Pt}=this,Kt=document.createElement("a");Kt.setAttribute("data-element-id",ct.id);let Jt=!1;return ct.url?(Pt.addLinkAttributes(Kt,ct.url,ct.newWindow),Jt=!0):ct.action?(this._bindNamedAction(Kt,ct.action),Jt=!0):ct.attachment?(this._bindAttachment(Kt,ct.attachment),Jt=!0):ct.setOCGState?(Rt(this,_t,mi).call(this,Kt,ct.setOCGState),Jt=!0):ct.dest?(this._bindLink(Kt,ct.dest),Jt=!0):(ct.actions&&(ct.actions.Action||ct.actions["Mouse Up"]||ct.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Kt,ct),Jt=!0),ct.resetForm?(this._bindResetFormAction(Kt,ct.resetForm),Jt=!0):this.isTooltipOnly&&!Jt&&(this._bindLink(Kt,""),Jt=!0)),this.container.classList.add("linkAnnotation"),Jt&&this.container.append(Kt),this.container}_bindLink(ct,Pt){ct.href=this.linkService.getDestinationHash(Pt),ct.onclick=()=>(Pt&&this.linkService.goToDestination(Pt),!1),(Pt||Pt==="")&&Rt(this,_t,je).call(this)}_bindNamedAction(ct,Pt){ct.href=this.linkService.getAnchorUrl(""),ct.onclick=()=>(this.linkService.executeNamedAction(Pt),!1),Rt(this,_t,je).call(this)}_bindAttachment(ct,Pt){ct.href=this.linkService.getAnchorUrl(""),ct.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,Pt.content,Pt.filename),!1),Rt(this,_t,je).call(this)}_bindJSAction(ct,Pt){ct.href=this.linkService.getAnchorUrl("");const Kt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Jt of Object.keys(Pt.actions)){const ee=Kt.get(Jt);ee&&(ct[ee]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Pt.id,name:Jt}}),!1))}ct.onclick||(ct.onclick=()=>!1),Rt(this,_t,je).call(this)}_bindResetFormAction(ct,Pt){const Kt=ct.onclick;if(Kt||(ct.href=this.linkService.getAnchorUrl("")),Rt(this,_t,je).call(this),!this._fieldObjects){(0,F.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Kt||(ct.onclick=()=>!1);return}ct.onclick=()=>{Kt?.();const{fields:Jt,refs:ee,include:ce}=Pt,pe=[];if(Jt.length!==0||ee.length!==0){const fe=new Set(ee);for(const _e of Jt){const Ee=this._fieldObjects[_e]||[];for(const{id:Pe}of Ee)fe.add(Pe)}for(const _e of Object.values(this._fieldObjects))for(const Ee of _e)fe.has(Ee.id)===ce&&pe.push(Ee)}else for(const fe of Object.values(this._fieldObjects))pe.push(...fe);const Se=this.annotationStorage,Ae=[];for(const fe of pe){const{id:_e}=fe;switch(Ae.push(_e),fe.type){case"text":{const Pe=fe.defaultValue||"";Se.setValue(_e,{value:Pe});break}case"checkbox":case"radiobutton":{const Pe=fe.defaultValue===fe.exportValues;Se.setValue(_e,{value:Pe});break}case"combobox":case"listbox":{const Pe=fe.defaultValue||"";Se.setValue(_e,{value:Pe});break}default:continue}const Ee=document.querySelector(`[data-element-id="${_e}"]`);if(Ee){if(!bt.has(Ee)){(0,F.warn)(`_bindResetFormAction - element not allowed: ${_e}`);continue}}else continue;Ee.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Ae,name:"ResetForm"}}),!1}}}_t=new WeakSet,je=function(){this.container.setAttribute("data-internal-link","")},mi=function(ct,Pt){ct.href=this.linkService.getAnchorUrl(""),ct.onclick=()=>(this.linkService.executeSetOCGState(Pt),!1),Rt(this,_t,je).call(this)};class et extends lt{constructor(ft){super(ft,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const ft=document.createElement("img");return ft.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",ft.alt="[{{type}} Annotation]",ft.dataset.l10nId="text_annotation_type",ft.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(ft),this.container}}class Q extends lt{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(ft){this.data.hasOwnCanvas&&(ft.previousSibling?.nodeName==="CANVAS"&&(ft.previousSibling.hidden=!0),ft.hidden=!1)}_getKeyModifier(ft){const{isWin:ct,isMac:Pt}=F.FeatureTest.platform;return ct&&ft.ctrlKey||Pt&&ft.metaKey}_setEventListener(ft,ct,Pt,Kt,Jt){Pt.includes("mouse")?ft.addEventListener(Pt,ee=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Kt,value:Jt(ee),shift:ee.shiftKey,modifier:this._getKeyModifier(ee)}})}):ft.addEventListener(Pt,ee=>{if(Pt==="blur"){if(!ct.focused||!ee.relatedTarget)return;ct.focused=!1}else if(Pt==="focus"){if(ct.focused)return;ct.focused=!0}Jt&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Kt,value:Jt(ee)}})})}_setEventListeners(ft,ct,Pt,Kt){for(const[Jt,ee]of Pt)(ee==="Action"||this.data.actions?.[ee])&&((ee==="Focus"||ee==="Blur")&&(ct||(ct={focused:!1})),this._setEventListener(ft,ct,Jt,ee,Kt),ee==="Focus"&&!this.data.actions?.Blur?this._setEventListener(ft,ct,"blur","Blur",null):ee==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(ft,ct,"focus","Focus",null))}_setBackgroundColor(ft){const ct=this.data.backgroundColor||null;ft.style.backgroundColor=ct===null?"transparent":F.Util.makeHexColor(ct[0],ct[1],ct[2])}_setTextStyle(ft){const ct=["left","center","right"],{fontColor:Pt}=this.data.defaultAppearanceData,Kt=this.data.defaultAppearanceData.fontSize||Z,Jt=ft.style;let ee;const ce=2,pe=Se=>Math.round(10*Se)/10;if(this.data.multiLine){const Se=Math.abs(this.data.rect[3]-this.data.rect[1]-ce),Ae=Math.round(Se/(F.LINE_FACTOR*Kt))||1,fe=Se/Ae;ee=Math.min(Kt,pe(fe/F.LINE_FACTOR))}else{const Se=Math.abs(this.data.rect[3]-this.data.rect[1]-ce);ee=Math.min(Kt,pe(Se/F.LINE_FACTOR))}Jt.fontSize=`calc(${ee}px * var(--scale-factor))`,Jt.color=F.Util.makeHexColor(Pt[0],Pt[1],Pt[2]),this.data.textAlignment!==null&&(Jt.textAlign=ct[this.data.textAlignment])}_setRequired(ft,ct){ct?ft.setAttribute("required",!0):ft.removeAttribute("required"),ft.setAttribute("aria-required",ct)}}class it extends Q{constructor(ft){const ct=ft.renderForms||!ft.data.hasAppearance&&!!ft.data.fieldValue;super(ft,{isRenderable:ct})}setPropertyOnSiblings(ft,ct,Pt,Kt){const Jt=this.annotationStorage;for(const ee of this._getElementsByName(ft.name,ft.id))ee.domElement&&(ee.domElement[ct]=Pt),Jt.setValue(ee.id,{[Kt]:Pt})}render(){const ft=this.annotationStorage,ct=this.data.id;this.container.classList.add("textWidgetAnnotation");let Pt=null;if(this.renderForms){const Kt=ft.getValue(ct,{value:this.data.fieldValue});let Jt=Kt.value||"";const ee=ft.getValue(ct,{charLimit:this.data.maxLen}).charLimit;ee&&Jt.length>ee&&(Jt=Jt.slice(0,ee));let ce=Kt.formattedValue||this.data.textContent?.join(`
`)||null;ce&&this.data.comb&&(ce=ce.replaceAll(/\s+/g,""));const pe={userValue:Jt,formattedValue:ce,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Pt=document.createElement("textarea"),Pt.textContent=ce??Jt,this.data.doNotScroll&&(Pt.style.overflowY="hidden")):(Pt=document.createElement("input"),Pt.type="text",Pt.setAttribute("value",ce??Jt),this.data.doNotScroll&&(Pt.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Pt.hidden=!0),bt.add(Pt),Pt.setAttribute("data-element-id",ct),Pt.disabled=this.data.readOnly,Pt.name=this.data.fieldName,Pt.tabIndex=ut,this._setRequired(Pt,this.data.required),ee&&(Pt.maxLength=ee),Pt.addEventListener("input",Ae=>{ft.setValue(ct,{value:Ae.target.value}),this.setPropertyOnSiblings(Pt,"value",Ae.target.value,"value"),pe.formattedValue=null}),Pt.addEventListener("resetform",Ae=>{const fe=this.data.defaultFieldValue??"";Pt.value=pe.userValue=fe,pe.formattedValue=null});let Se=Ae=>{const{formattedValue:fe}=pe;fe!=null&&(Ae.target.value=fe),Ae.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Pt.addEventListener("focus",fe=>{if(pe.focused)return;const{target:_e}=fe;pe.userValue&&(_e.value=pe.userValue),pe.lastCommittedValue=_e.value,pe.commitKey=1,pe.focused=!0}),Pt.addEventListener("updatefromsandbox",fe=>{this.showElementAndHideCanvas(fe.target);const _e={value(Ee){pe.userValue=Ee.detail.value??"",ft.setValue(ct,{value:pe.userValue.toString()}),Ee.target.value=pe.userValue},formattedValue(Ee){const{formattedValue:Pe}=Ee.detail;pe.formattedValue=Pe,Pe!=null&&Ee.target!==document.activeElement&&(Ee.target.value=Pe),ft.setValue(ct,{formattedValue:Pe})},selRange(Ee){Ee.target.setSelectionRange(...Ee.detail.selRange)},charLimit:Ee=>{const{charLimit:Pe}=Ee.detail,{target:Ie}=Ee;if(Pe===0){Ie.removeAttribute("maxLength");return}Ie.setAttribute("maxLength",Pe);let De=pe.userValue;!De||De.length<=Pe||(De=De.slice(0,Pe),Ie.value=pe.userValue=De,ft.setValue(ct,{value:De}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ct,name:"Keystroke",value:De,willCommit:!0,commitKey:1,selStart:Ie.selectionStart,selEnd:Ie.selectionEnd}}))}};this._dispatchEventFromSandbox(_e,fe)}),Pt.addEventListener("keydown",fe=>{pe.commitKey=1;let _e=-1;if(fe.key==="Escape"?_e=0:fe.key==="Enter"&&!this.data.multiLine?_e=2:fe.key==="Tab"&&(pe.commitKey=3),_e===-1)return;const{value:Ee}=fe.target;pe.lastCommittedValue!==Ee&&(pe.lastCommittedValue=Ee,pe.userValue=Ee,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ct,name:"Keystroke",value:Ee,willCommit:!0,commitKey:_e,selStart:fe.target.selectionStart,selEnd:fe.target.selectionEnd}}))});const Ae=Se;Se=null,Pt.addEventListener("blur",fe=>{if(!pe.focused||!fe.relatedTarget)return;pe.focused=!1;const{value:_e}=fe.target;pe.userValue=_e,pe.lastCommittedValue!==_e&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ct,name:"Keystroke",value:_e,willCommit:!0,commitKey:pe.commitKey,selStart:fe.target.selectionStart,selEnd:fe.target.selectionEnd}}),Ae(fe)}),this.data.actions?.Keystroke&&Pt.addEventListener("beforeinput",fe=>{pe.lastCommittedValue=null;const{data:_e,target:Ee}=fe,{value:Pe,selectionStart:Ie,selectionEnd:De}=Ee;let Le=Ie,Ue=De;switch(fe.inputType){case"deleteWordBackward":{const Ne=Pe.substring(0,Ie).match(/\w*[^\w]*$/);Ne&&(Le-=Ne[0].length);break}case"deleteWordForward":{const Ne=Pe.substring(Ie).match(/^[^\w]*\w*/);Ne&&(Ue+=Ne[0].length);break}case"deleteContentBackward":Ie===De&&(Le-=1);break;case"deleteContentForward":Ie===De&&(Ue+=1);break}fe.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ct,name:"Keystroke",value:Pe,change:_e||"",willCommit:!1,selStart:Le,selEnd:Ue}})}),this._setEventListeners(Pt,pe,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],fe=>fe.target.value)}if(Se&&Pt.addEventListener("blur",Se),this.data.comb){const fe=(this.data.rect[2]-this.data.rect[0])/ee;Pt.classList.add("comb"),Pt.style.letterSpacing=`calc(${fe}px * var(--scale-factor) - 1ch)`}}else Pt=document.createElement("div"),Pt.textContent=this.data.fieldValue,Pt.style.verticalAlign="middle",Pt.style.display="table-cell";return this._setTextStyle(Pt),this._setBackgroundColor(Pt),this._setDefaultPropertiesFromJS(Pt),this.container.append(Pt),this.container}}class xt extends Q{constructor(ft){super(ft,{isRenderable:!!ft.data.hasOwnCanvas})}}class ot extends Q{constructor(ft){super(ft,{isRenderable:ft.renderForms})}render(){const ft=this.annotationStorage,ct=this.data,Pt=ct.id;let Kt=ft.getValue(Pt,{value:ct.exportValue===ct.fieldValue}).value;typeof Kt=="string"&&(Kt=Kt!=="Off",ft.setValue(Pt,{value:Kt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Jt=document.createElement("input");return bt.add(Jt),Jt.setAttribute("data-element-id",Pt),Jt.disabled=ct.readOnly,this._setRequired(Jt,this.data.required),Jt.type="checkbox",Jt.name=ct.fieldName,Kt&&Jt.setAttribute("checked",!0),Jt.setAttribute("exportValue",ct.exportValue),Jt.tabIndex=ut,Jt.addEventListener("change",ee=>{const{name:ce,checked:pe}=ee.target;for(const Se of this._getElementsByName(ce,Pt)){const Ae=pe&&Se.exportValue===ct.exportValue;Se.domElement&&(Se.domElement.checked=Ae),ft.setValue(Se.id,{value:Ae})}ft.setValue(Pt,{value:pe})}),Jt.addEventListener("resetform",ee=>{const ce=ct.defaultFieldValue||"Off";ee.target.checked=ce===ct.exportValue}),this.enableScripting&&this.hasJSActions&&(Jt.addEventListener("updatefromsandbox",ee=>{const ce={value(pe){pe.target.checked=pe.detail.value!=="Off",ft.setValue(Pt,{value:pe.target.checked})}};this._dispatchEventFromSandbox(ce,ee)}),this._setEventListeners(Jt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ee=>ee.target.checked)),this._setBackgroundColor(Jt),this._setDefaultPropertiesFromJS(Jt),this.container.append(Jt),this.container}}class Y extends Q{constructor(ft){super(ft,{isRenderable:ft.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const ft=this.annotationStorage,ct=this.data,Pt=ct.id;let Kt=ft.getValue(Pt,{value:ct.fieldValue===ct.buttonValue}).value;typeof Kt=="string"&&(Kt=Kt!==ct.buttonValue,ft.setValue(Pt,{value:Kt}));const Jt=document.createElement("input");if(bt.add(Jt),Jt.setAttribute("data-element-id",Pt),Jt.disabled=ct.readOnly,this._setRequired(Jt,this.data.required),Jt.type="radio",Jt.name=ct.fieldName,Kt&&Jt.setAttribute("checked",!0),Jt.tabIndex=ut,Jt.addEventListener("change",ee=>{const{name:ce,checked:pe}=ee.target;for(const Se of this._getElementsByName(ce,Pt))ft.setValue(Se.id,{value:!1});ft.setValue(Pt,{value:pe})}),Jt.addEventListener("resetform",ee=>{const ce=ct.defaultFieldValue;ee.target.checked=ce!=null&&ce===ct.buttonValue}),this.enableScripting&&this.hasJSActions){const ee=ct.buttonValue;Jt.addEventListener("updatefromsandbox",ce=>{const pe={value:Se=>{const Ae=ee===Se.detail.value;for(const fe of this._getElementsByName(Se.target.name)){const _e=Ae&&fe.id===Pt;fe.domElement&&(fe.domElement.checked=_e),ft.setValue(fe.id,{value:_e})}}};this._dispatchEventFromSandbox(pe,ce)}),this._setEventListeners(Jt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ce=>ce.target.checked)}return this._setBackgroundColor(Jt),this._setDefaultPropertiesFromJS(Jt),this.container.append(Jt),this.container}}class W extends gt{constructor(ft){super(ft,{ignoreBorder:ft.data.hasAppearance})}render(){const ft=super.render();ft.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(ft.title=this.data.alternativeText);const ct=ft.lastChild;return this.enableScripting&&this.hasJSActions&&ct&&(this._setDefaultPropertiesFromJS(ct),ct.addEventListener("updatefromsandbox",Pt=>{this._dispatchEventFromSandbox({},Pt)})),ft}}class O extends Q{constructor(ft){super(ft,{isRenderable:ft.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const ft=this.annotationStorage,ct=this.data.id,Pt=ft.getValue(ct,{value:this.data.fieldValue}),Kt=document.createElement("select");bt.add(Kt),Kt.setAttribute("data-element-id",ct),Kt.disabled=this.data.readOnly,this._setRequired(Kt,this.data.required),Kt.name=this.data.fieldName,Kt.tabIndex=ut;let Jt=this.data.combo&&this.data.options.length>0;this.data.combo||(Kt.size=this.data.options.length,this.data.multiSelect&&(Kt.multiple=!0)),Kt.addEventListener("resetform",Ae=>{const fe=this.data.defaultFieldValue;for(const _e of Kt.options)_e.selected=_e.value===fe});for(const Ae of this.data.options){const fe=document.createElement("option");fe.textContent=Ae.displayValue,fe.value=Ae.exportValue,Pt.value.includes(Ae.exportValue)&&(fe.setAttribute("selected",!0),Jt=!1),Kt.append(fe)}let ee=null;if(Jt){const Ae=document.createElement("option");Ae.value=" ",Ae.setAttribute("hidden",!0),Ae.setAttribute("selected",!0),Kt.prepend(Ae),ee=()=>{Ae.remove(),Kt.removeEventListener("input",ee),ee=null},Kt.addEventListener("input",ee)}const ce=Ae=>{const fe=Ae?"value":"textContent",{options:_e,multiple:Ee}=Kt;return Ee?Array.prototype.filter.call(_e,Pe=>Pe.selected).map(Pe=>Pe[fe]):_e.selectedIndex===-1?null:_e[_e.selectedIndex][fe]};let pe=ce(!1);const Se=Ae=>{const fe=Ae.target.options;return Array.prototype.map.call(fe,_e=>({displayValue:_e.textContent,exportValue:_e.value}))};return this.enableScripting&&this.hasJSActions?(Kt.addEventListener("updatefromsandbox",Ae=>{const fe={value(_e){ee?.();const Ee=_e.detail.value,Pe=new Set(Array.isArray(Ee)?Ee:[Ee]);for(const Ie of Kt.options)Ie.selected=Pe.has(Ie.value);ft.setValue(ct,{value:ce(!0)}),pe=ce(!1)},multipleSelection(_e){Kt.multiple=!0},remove(_e){const Ee=Kt.options,Pe=_e.detail.remove;Ee[Pe].selected=!1,Kt.remove(Pe),Ee.length>0&&Array.prototype.findIndex.call(Ee,De=>De.selected)===-1&&(Ee[0].selected=!0),ft.setValue(ct,{value:ce(!0),items:Se(_e)}),pe=ce(!1)},clear(_e){for(;Kt.length!==0;)Kt.remove(0);ft.setValue(ct,{value:null,items:[]}),pe=ce(!1)},insert(_e){const{index:Ee,displayValue:Pe,exportValue:Ie}=_e.detail.insert,De=Kt.children[Ee],Le=document.createElement("option");Le.textContent=Pe,Le.value=Ie,De?De.before(Le):Kt.append(Le),ft.setValue(ct,{value:ce(!0),items:Se(_e)}),pe=ce(!1)},items(_e){const{items:Ee}=_e.detail;for(;Kt.length!==0;)Kt.remove(0);for(const Pe of Ee){const{displayValue:Ie,exportValue:De}=Pe,Le=document.createElement("option");Le.textContent=Ie,Le.value=De,Kt.append(Le)}Kt.options.length>0&&(Kt.options[0].selected=!0),ft.setValue(ct,{value:ce(!0),items:Se(_e)}),pe=ce(!1)},indices(_e){const Ee=new Set(_e.detail.indices);for(const Pe of _e.target.options)Pe.selected=Ee.has(Pe.index);ft.setValue(ct,{value:ce(!0)}),pe=ce(!1)},editable(_e){_e.target.disabled=!_e.detail.editable}};this._dispatchEventFromSandbox(fe,Ae)}),Kt.addEventListener("input",Ae=>{const fe=ce(!0);ft.setValue(ct,{value:fe}),Ae.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ct,name:"Keystroke",value:pe,changeEx:fe,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Kt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Ae=>Ae.target.value)):Kt.addEventListener("input",function(Ae){ft.setValue(ct,{value:ce(!0)})}),this.data.combo&&this._setTextStyle(Kt),this._setBackgroundColor(Kt),this._setDefaultPropertiesFromJS(Kt),this.container.append(Kt),this.container}}class nt extends lt{constructor(ft){const{data:ct,elements:Pt}=ft;super(ft,{isRenderable:lt._hasPopupData(ct)}),this.elements=Pt}render(){this.container.classList.add("popupAnnotation");const ft=new J({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),ct=[];for(const Pt of this.elements)Pt.popup=ft,ct.push(Pt.data.id),Pt.addHighlightArea();return this.container.setAttribute("aria-controls",ct.map(Pt=>`${F.AnnotationPrefix}${Pt}`).join(",")),this.container}}class J{constructor({container:ft,color:ct,elements:Pt,titleObj:Kt,modificationDate:Jt,contentsObj:ee,richText:ce,parent:pe,rect:Se,parentRect:Ae,open:fe}){Ht(this,de);Ht(this,zt,null);Ht(this,Qt,Rt(this,de,bi).bind(this));Ht(this,te,Rt(this,de,js).bind(this));Ht(this,se,Rt(this,de,Bs).bind(this));Ht(this,ne,Rt(this,de,hs).bind(this));Ht(this,ae,null);Ht(this,$t,null);Ht(this,Ut,null);Ht(this,st,null);Ht(this,St,null);Ht(this,It,null);Ht(this,jt,!1);Ht(this,Zt,null);Ht(this,re,null);Ht(this,oe,null);Ht(this,Ot,null);Ht(this,he,!1);Wt(this,$t,ft),Wt(this,Ot,Kt),Wt(this,Ut,ee),Wt(this,oe,ce),Wt(this,St,pe),Wt(this,ae,ct),Wt(this,re,Se),Wt(this,It,Ae),Wt(this,st,Pt);const _e=U.PDFDateString.toDateObject(Jt);_e&&Wt(this,zt,pe.l10n.get("annotation_date_string",{date:_e.toLocaleDateString(),time:_e.toLocaleTimeString()})),this.trigger=Pt.flatMap(Ee=>Ee.getElementsToTriggerPopup());for(const Ee of this.trigger)Ee.addEventListener("click",D(this,ne)),Ee.addEventListener("mouseenter",D(this,se)),Ee.addEventListener("mouseleave",D(this,te)),Ee.classList.add("popupTriggerArea");for(const Ee of Pt)Ee.container?.addEventListener("keydown",D(this,Qt));D(this,$t).hidden=!0,fe&&Rt(this,de,hs).call(this)}render(){if(D(this,Zt))return;const{page:{view:ft},viewport:{rawDims:{pageWidth:ct,pageHeight:Pt,pageX:Kt,pageY:Jt}}}=D(this,St),ee=Wt(this,Zt,document.createElement("div"));if(ee.className="popup",D(this,ae)){const Ne=ee.style.outlineColor=F.Util.makeHexColor(...D(this,ae));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ee.style.backgroundColor=`color-mix(in srgb, ${Ne} 30%, white)`:ee.style.backgroundColor=F.Util.makeHexColor(...D(this,ae).map(Xe=>Math.floor(.7*(255-Xe)+Xe)))}const ce=document.createElement("span");ce.className="header";const pe=document.createElement("h1");if(ce.append(pe),{dir:pe.dir,str:pe.textContent}=D(this,Ot),ee.append(ce),D(this,zt)){const Ne=document.createElement("span");Ne.classList.add("popupDate"),D(this,zt).then(Ve=>{Ne.textContent=Ve}),ce.append(Ne)}const Se=D(this,Ut),Ae=D(this,oe);if(Ae?.str&&(!Se?.str||Se.str===Ae.str))At.XfaLayer.render({xfaHtml:Ae.html,intent:"richText",div:ee}),ee.lastChild.classList.add("richText","popupContent");else{const Ne=this._formatContents(Se);ee.append(Ne)}let fe=!!D(this,It),_e=fe?D(this,It):D(this,re);for(const Ne of D(this,st))if(!_e||F.Util.intersect(Ne.data.rect,_e)!==null){_e=Ne.data.rect,fe=!0;break}const Ee=F.Util.normalizeRect([_e[0],ft[3]-_e[1]+ft[1],_e[2],ft[3]-_e[3]+ft[1]]),Ie=fe?_e[2]-_e[0]+5:0,De=Ee[0]+Ie,Le=Ee[1],{style:Ue}=D(this,$t);Ue.left=`${100*(De-Kt)/ct}%`,Ue.top=`${100*(Le-Jt)/Pt}%`,D(this,$t).append(ee)}_formatContents({str:ft,dir:ct}){const Pt=document.createElement("p");Pt.classList.add("popupContent"),Pt.dir=ct;const Kt=ft.split(/(?:\r\n?|\n)/);for(let Jt=0,ee=Kt.length;Jt<ee;++Jt){const ce=Kt[Jt];Pt.append(document.createTextNode(ce)),Jt<ee-1&&Pt.append(document.createElement("br"))}return Pt}forceHide(){Wt(this,he,this.isVisible),D(this,he)&&(D(this,$t).hidden=!0)}maybeShow(){D(this,he)&&(Wt(this,he,!1),D(this,$t).hidden=!1)}get isVisible(){return D(this,$t).hidden===!1}}zt=new WeakMap,Qt=new WeakMap,te=new WeakMap,se=new WeakMap,ne=new WeakMap,ae=new WeakMap,$t=new WeakMap,Ut=new WeakMap,st=new WeakMap,St=new WeakMap,It=new WeakMap,jt=new WeakMap,Zt=new WeakMap,re=new WeakMap,oe=new WeakMap,Ot=new WeakMap,he=new WeakMap,de=new WeakSet,bi=function(ft){ft.altKey||ft.shiftKey||ft.ctrlKey||ft.metaKey||(ft.key==="Enter"||ft.key==="Escape"&&D(this,jt))&&Rt(this,de,hs).call(this)},hs=function(){Wt(this,jt,!D(this,jt)),D(this,jt)?(Rt(this,de,Bs).call(this),D(this,$t).addEventListener("click",D(this,ne)),D(this,$t).addEventListener("keydown",D(this,Qt))):(Rt(this,de,js).call(this),D(this,$t).removeEventListener("click",D(this,ne)),D(this,$t).removeEventListener("keydown",D(this,Qt)))},Bs=function(){D(this,Zt)||this.render(),this.isVisible?D(this,jt)&&D(this,$t).classList.add("focused"):(D(this,$t).hidden=!1,D(this,$t).style.zIndex=parseInt(D(this,$t).style.zIndex)+1e3)},js=function(){D(this,$t).classList.remove("focused"),!(D(this,jt)||!this.isVisible)&&(D(this,$t).hidden=!0,D(this,$t).style.zIndex=parseInt(D(this,$t).style.zIndex)-1e3)};class Ft extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0}),this.textContent=ft.data.textContent,this.textPosition=ft.data.textPosition,this.annotationEditorType=F.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const ft=document.createElement("div");ft.classList.add("annotationTextContent"),ft.setAttribute("role","comment");for(const ct of this.textContent){const Pt=document.createElement("span");Pt.textContent=ct,ft.append(Pt)}this.container.append(ft)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}w.FreeTextAnnotationElement=Ft;class K extends lt{constructor(ct){super(ct,{isRenderable:!0,ignoreBorder:!0});Ht(this,we,null)}render(){this.container.classList.add("lineAnnotation");const ct=this.data,{width:Pt,height:Kt}=Ct(ct.rect),Jt=this.svgFactory.create(Pt,Kt,!0),ee=Wt(this,we,this.svgFactory.createElement("svg:line"));return ee.setAttribute("x1",ct.rect[2]-ct.lineCoordinates[0]),ee.setAttribute("y1",ct.rect[3]-ct.lineCoordinates[1]),ee.setAttribute("x2",ct.rect[2]-ct.lineCoordinates[2]),ee.setAttribute("y2",ct.rect[3]-ct.lineCoordinates[3]),ee.setAttribute("stroke-width",ct.borderStyle.width||1),ee.setAttribute("stroke","transparent"),ee.setAttribute("fill","transparent"),Jt.append(ee),this.container.append(Jt),!ct.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,we)}addHighlightArea(){this.container.classList.add("highlightArea")}}we=new WeakMap;class pt extends lt{constructor(ct){super(ct,{isRenderable:!0,ignoreBorder:!0});Ht(this,ke,null)}render(){this.container.classList.add("squareAnnotation");const ct=this.data,{width:Pt,height:Kt}=Ct(ct.rect),Jt=this.svgFactory.create(Pt,Kt,!0),ee=ct.borderStyle.width,ce=Wt(this,ke,this.svgFactory.createElement("svg:rect"));return ce.setAttribute("x",ee/2),ce.setAttribute("y",ee/2),ce.setAttribute("width",Pt-ee),ce.setAttribute("height",Kt-ee),ce.setAttribute("stroke-width",ee||1),ce.setAttribute("stroke","transparent"),ce.setAttribute("fill","transparent"),Jt.append(ce),this.container.append(Jt),!ct.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,ke)}addHighlightArea(){this.container.classList.add("highlightArea")}}ke=new WeakMap;class Tt extends lt{constructor(ct){super(ct,{isRenderable:!0,ignoreBorder:!0});Ht(this,Fe,null)}render(){this.container.classList.add("circleAnnotation");const ct=this.data,{width:Pt,height:Kt}=Ct(ct.rect),Jt=this.svgFactory.create(Pt,Kt,!0),ee=ct.borderStyle.width,ce=Wt(this,Fe,this.svgFactory.createElement("svg:ellipse"));return ce.setAttribute("cx",Pt/2),ce.setAttribute("cy",Kt/2),ce.setAttribute("rx",Pt/2-ee/2),ce.setAttribute("ry",Kt/2-ee/2),ce.setAttribute("stroke-width",ee||1),ce.setAttribute("stroke","transparent"),ce.setAttribute("fill","transparent"),Jt.append(ce),this.container.append(Jt),!ct.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,Fe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fe=new WeakMap;class Xt extends lt{constructor(ct){super(ct,{isRenderable:!0,ignoreBorder:!0});Ht(this,le,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const ct=this.data,{width:Pt,height:Kt}=Ct(ct.rect),Jt=this.svgFactory.create(Pt,Kt,!0);let ee=[];for(const pe of ct.vertices){const Se=pe.x-ct.rect[0],Ae=ct.rect[3]-pe.y;ee.push(Se+","+Ae)}ee=ee.join(" ");const ce=Wt(this,le,this.svgFactory.createElement(this.svgElementName));return ce.setAttribute("points",ee),ce.setAttribute("stroke-width",ct.borderStyle.width||1),ce.setAttribute("stroke","transparent"),ce.setAttribute("fill","transparent"),Jt.append(ce),this.container.append(Jt),!ct.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,le)}addHighlightArea(){this.container.classList.add("highlightArea")}}le=new WeakMap;class Lt extends Xt{constructor(ft){super(ft),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Bt extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Mt extends lt{constructor(ct){super(ct,{isRenderable:!0,ignoreBorder:!0});Ht(this,Gt,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=F.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const ct=this.data,{width:Pt,height:Kt}=Ct(ct.rect),Jt=this.svgFactory.create(Pt,Kt,!0);for(const ee of ct.inkLists){let ce=[];for(const Se of ee){const Ae=Se.x-ct.rect[0],fe=ct.rect[3]-Se.y;ce.push(`${Ae},${fe}`)}ce=ce.join(" ");const pe=this.svgFactory.createElement(this.svgElementName);D(this,Gt).push(pe),pe.setAttribute("points",ce),pe.setAttribute("stroke-width",ct.borderStyle.width||1),pe.setAttribute("stroke","transparent"),pe.setAttribute("fill","transparent"),!ct.popupRef&&this.hasPopupData&&this._createPopup(),Jt.append(pe)}return this.container.append(Jt),this.container}getElementsToTriggerPopup(){return D(this,Gt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gt=new WeakMap,w.InkAnnotationElement=Mt;class Vt extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Et extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Dt extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Nt extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ht extends lt{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}w.StampAnnotationElement=ht;class q extends lt{constructor(ct){super(ct,{isRenderable:!0});Ht(this,me);Ht(this,qt,null);const{filename:Pt,content:Kt}=this.data.file;this.filename=(0,U.getFilenameFromUrl)(Pt,!0),this.content=Kt,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:Pt,content:Kt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:ct,data:Pt}=this;let Kt;Pt.hasAppearance||Pt.fillAlpha===0?Kt=document.createElement("div"):(Kt=document.createElement("img"),Kt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Pt.name)?"paperclip":"pushpin"}.svg`,Pt.fillAlpha&&Pt.fillAlpha<1&&(Kt.style=`filter: opacity(${Math.round(Pt.fillAlpha*100)}%);`)),Kt.addEventListener("dblclick",Rt(this,me,Hs).bind(this)),Wt(this,qt,Kt);const{isMac:Jt}=F.FeatureTest.platform;return ct.addEventListener("keydown",ee=>{ee.key==="Enter"&&(Jt?ee.metaKey:ee.ctrlKey)&&Rt(this,me,Hs).call(this)}),!Pt.popupRef&&this.hasPopupData?this._createPopup():Kt.classList.add("popupTriggerArea"),ct.append(Kt),ct}getElementsToTriggerPopup(){return D(this,qt)}addHighlightArea(){this.container.classList.add("highlightArea")}}qt=new WeakMap,me=new WeakSet,Hs=function(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)};class G{constructor({div:ft,accessibilityManager:ct,annotationCanvasMap:Pt,l10n:Kt,page:Jt,viewport:ee}){Ht(this,ue);Ht(this,Te,null);Ht(this,wt,null);Ht(this,ie,new Map);this.div=ft,Wt(this,Te,ct),Wt(this,wt,Pt),this.l10n=Kt,this.page=Jt,this.viewport=ee,this.zIndex=0,this.l10n||(this.l10n=Yt.NullL10n)}async render(ft){const{annotations:ct}=ft,Pt=this.div;(0,U.setLayerDimensions)(Pt,this.viewport);const Kt=new Map,Jt={data:null,layer:Pt,linkService:ft.linkService,downloadManager:ft.downloadManager,imageResourcesPath:ft.imageResourcesPath||"",renderForms:ft.renderForms!==!1,svgFactory:new U.DOMSVGFactory,annotationStorage:ft.annotationStorage||new yt.AnnotationStorage,enableScripting:ft.enableScripting===!0,hasJSActions:ft.hasJSActions,fieldObjects:ft.fieldObjects,parent:this,elements:null};for(const ee of ct){if(ee.noHTML)continue;const ce=ee.annotationType===F.AnnotationType.POPUP;if(ce){const Ae=Kt.get(ee.id);if(!Ae)continue;Jt.elements=Ae}else{const{width:Ae,height:fe}=Ct(ee.rect);if(Ae<=0||fe<=0)continue}Jt.data=ee;const pe=at.create(Jt);if(!pe.isRenderable)continue;if(!ce&&ee.popupRef){const Ae=Kt.get(ee.popupRef);Ae?Ae.push(pe):Kt.set(ee.popupRef,[pe])}pe.annotationEditorType>0&&D(this,ie).set(pe.data.id,pe);const Se=pe.render();ee.hidden&&(Se.style.visibility="hidden"),Rt(this,ue,_i).call(this,Se,ee.id)}Rt(this,ue,Ws).call(this),await this.l10n.translate(Pt)}update({viewport:ft}){const ct=this.div;this.viewport=ft,(0,U.setLayerDimensions)(ct,{rotation:ft.rotation}),Rt(this,ue,Ws).call(this),ct.hidden=!1}getEditableAnnotations(){return Array.from(D(this,ie).values())}getEditableAnnotation(ft){return D(this,ie).get(ft)}}Te=new WeakMap,wt=new WeakMap,ie=new WeakMap,ue=new WeakSet,_i=function(ft,ct){const Pt=ft.firstChild||ft;Pt.id=`${F.AnnotationPrefix}${ct}`,this.div.append(ft),D(this,Te)?.moveElementInDOM(this.div,ft,Pt,!1)},Ws=function(){if(!D(this,wt))return;const ft=this.div;for(const[ct,Pt]of D(this,wt)){const Kt=ft.querySelector(`[data-annotation-id="${ct}"]`);if(!Kt)continue;const{firstChild:Jt}=Kt;Jt?Jt.nodeName==="CANVAS"?Jt.replaceWith(Pt):Jt.before(Pt):Kt.append(Pt)}D(this,wt).clear()},w.AnnotationLayer=G},(rt,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.ColorConverters=void 0;function X(yt){return Math.floor(Math.max(0,Math.min(1,yt))*255).toString(16).padStart(2,"0")}function F(yt){return Math.max(0,Math.min(255,255*yt))}class U{static CMYK_G([dt,Yt,At,ut]){return["G",1-Math.min(1,.3*dt+.59*At+.11*Yt+ut)]}static G_CMYK([dt]){return["CMYK",0,0,0,1-dt]}static G_RGB([dt]){return["RGB",dt,dt,dt]}static G_rgb([dt]){return dt=F(dt),[dt,dt,dt]}static G_HTML([dt]){const Yt=X(dt);return`#${Yt}${Yt}${Yt}`}static RGB_G([dt,Yt,At]){return["G",.3*dt+.59*Yt+.11*At]}static RGB_rgb(dt){return dt.map(F)}static RGB_HTML(dt){return`#${dt.map(X).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([dt,Yt,At,ut]){return["RGB",1-Math.min(1,dt+ut),1-Math.min(1,At+ut),1-Math.min(1,Yt+ut)]}static CMYK_rgb([dt,Yt,At,ut]){return[F(1-Math.min(1,dt+ut)),F(1-Math.min(1,At+ut)),F(1-Math.min(1,Yt+ut))]}static CMYK_HTML(dt){const Yt=this.CMYK_RGB(dt).slice(1);return this.RGB_HTML(Yt)}static RGB_CMYK([dt,Yt,At]){const ut=1-dt,Z=1-Yt,bt=1-At,Ct=Math.min(ut,Z,bt);return["CMYK",ut,Z,bt,Ct]}}w.ColorConverters=U},(rt,w)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.NullL10n=void 0,w.getL10nFallback=F;const X={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};X.print_progress_percent="{{progress}}%";function F(dt,Yt){switch(dt){case"find_match_count":dt=`find_match_count[${Yt.total===1?"one":"other"}]`;break;case"find_match_count_limit":dt=`find_match_count_limit[${Yt.limit===1?"one":"other"}]`;break}return X[dt]||""}function U(dt,Yt){return Yt?dt.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(At,ut)=>ut in Yt?Yt[ut]:"{{"+ut+"}}"):dt}const yt={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(dt,Yt=null,At=F(dt,Yt)){return U(At,Yt)},async translate(dt){}};w.NullL10n=yt},(rt,w,X)=>{Object.defineProperty(w,"__esModule",{value:!0}),w.XfaLayer=void 0;var F=X(25);class U{static setupStorage(dt,Yt,At,ut,Z){const bt=ut.getValue(Yt,{value:null});switch(At.name){case"textarea":if(bt.value!==null&&(dt.textContent=bt.value),Z==="print")break;dt.addEventListener("input",Ct=>{ut.setValue(Yt,{value:Ct.target.value})});break;case"input":if(At.attributes.type==="radio"||At.attributes.type==="checkbox"){if(bt.value===At.attributes.xfaOn?dt.setAttribute("checked",!0):bt.value===At.attributes.xfaOff&&dt.removeAttribute("checked"),Z==="print")break;dt.addEventListener("change",Ct=>{ut.setValue(Yt,{value:Ct.target.checked?Ct.target.getAttribute("xfaOn"):Ct.target.getAttribute("xfaOff")})})}else{if(bt.value!==null&&dt.setAttribute("value",bt.value),Z==="print")break;dt.addEventListener("input",Ct=>{ut.setValue(Yt,{value:Ct.target.value})})}break;case"select":if(bt.value!==null){dt.setAttribute("value",bt.value);for(const Ct of At.children)Ct.attributes.value===bt.value?Ct.attributes.selected=!0:Ct.attributes.hasOwnProperty("selected")&&delete Ct.attributes.selected}dt.addEventListener("input",Ct=>{const at=Ct.target.options,lt=at.selectedIndex===-1?"":at[at.selectedIndex].value;ut.setValue(Yt,{value:lt})});break}}static setAttributes({html:dt,element:Yt,storage:At=null,intent:ut,linkService:Z}){const{attributes:bt}=Yt,Ct=dt instanceof HTMLAnchorElement;bt.type==="radio"&&(bt.name=`${bt.name}-${ut}`);for(const[at,lt]of Object.entries(bt))if(lt!=null)switch(at){case"class":lt.length&&dt.setAttribute(at,lt.join(" "));break;case"dataId":break;case"id":dt.setAttribute("data-element-id",lt);break;case"style":Object.assign(dt.style,lt);break;case"textContent":dt.textContent=lt;break;default:(!Ct||at!=="href"&&at!=="newWindow")&&dt.setAttribute(at,lt)}Ct&&Z.addLinkAttributes(dt,bt.href,bt.newWindow),At&&bt.dataId&&this.setupStorage(dt,bt.dataId,Yt,At)}static render(dt){const Yt=dt.annotationStorage,At=dt.linkService,ut=dt.xfaHtml,Z=dt.intent||"display",bt=document.createElement(ut.name);ut.attributes&&this.setAttributes({html:bt,element:ut,intent:Z,linkService:At});const Ct=[[ut,-1,bt]],at=dt.div;if(at.append(bt),dt.viewport){const gt=`matrix(${dt.viewport.transform.join(",")})`;at.style.transform=gt}Z!=="richText"&&at.setAttribute("class","xfaLayer xfaFont");const lt=[];for(;Ct.length>0;){const[gt,et,Q]=Ct.at(-1);if(et+1===gt.children.length){Ct.pop();continue}const it=gt.children[++Ct.at(-1)[1]];if(it===null)continue;const{name:xt}=it;if(xt==="#text"){const Y=document.createTextNode(it.value);lt.push(Y),Q.append(Y);continue}const ot=it?.attributes?.xmlns?document.createElementNS(it.attributes.xmlns,xt):document.createElement(xt);if(Q.append(ot),it.attributes&&this.setAttributes({html:ot,element:it,storage:Yt,intent:Z,linkService:At}),it.children&&it.children.length>0)Ct.push([it,-1,ot]);else if(it.value){const Y=document.createTextNode(it.value);F.XfaText.shouldBuildText(xt)&&lt.push(Y),ot.append(Y)}}for(const gt of at.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))gt.setAttribute("readOnly",!0);return{textDivs:lt}}static update(dt){const Yt=`matrix(${dt.viewport.transform.join(",")})`;dt.div.style.transform=Yt,dt.div.hidden=!1}}w.XfaLayer=U},(rt,w,X)=>{var ut,Z,bt,Ct,at,lt,gt,et,Q,it,xt,ot,Y,W,O,yi,Ai,vi,Si,zs,Ei,qs,xi,wi,Ci,Ti,Pi,Be,Gs,ds,us,qe,Vs,ps,_t,ki,Xs,Mi,Ri,Ys,fs,Ge;Object.defineProperty(w,"__esModule",{value:!0}),w.InkEditor=void 0;var F=X(1),U=X(4),yt=X(29),dt=X(6),Yt=X(5);const ae=class ae extends U.AnnotationEditor{constructor(st){super({...st,name:"inkEditor"});Ht(this,O);Ht(this,ut,0);Ht(this,Z,0);Ht(this,bt,this.canvasPointermove.bind(this));Ht(this,Ct,this.canvasPointerleave.bind(this));Ht(this,at,this.canvasPointerup.bind(this));Ht(this,lt,this.canvasPointerdown.bind(this));Ht(this,gt,new Path2D);Ht(this,et,!1);Ht(this,Q,!1);Ht(this,it,!1);Ht(this,xt,null);Ht(this,ot,0);Ht(this,Y,0);Ht(this,W,null);this.color=st.color||null,this.thickness=st.thickness||null,this.opacity=st.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(st){U.AnnotationEditor.initialize(st,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(st,St){switch(st){case F.AnnotationEditorParamsType.INK_THICKNESS:ae._defaultThickness=St;break;case F.AnnotationEditorParamsType.INK_COLOR:ae._defaultColor=St;break;case F.AnnotationEditorParamsType.INK_OPACITY:ae._defaultOpacity=St/100;break}}updateParams(st,St){switch(st){case F.AnnotationEditorParamsType.INK_THICKNESS:Rt(this,O,yi).call(this,St);break;case F.AnnotationEditorParamsType.INK_COLOR:Rt(this,O,Ai).call(this,St);break;case F.AnnotationEditorParamsType.INK_OPACITY:Rt(this,O,vi).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[F.AnnotationEditorParamsType.INK_THICKNESS,ae._defaultThickness],[F.AnnotationEditorParamsType.INK_COLOR,ae._defaultColor||U.AnnotationEditor._defaultLineColor],[F.AnnotationEditorParamsType.INK_OPACITY,Math.round(ae._defaultOpacity*100)]]}get propertiesToUpdate(){return[[F.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ae._defaultThickness],[F.AnnotationEditorParamsType.INK_COLOR,this.color||ae._defaultColor||U.AnnotationEditor._defaultLineColor],[F.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ae._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Rt(this,O,ds).call(this),Rt(this,O,us).call(this)),this.isAttachedToDOM||(this.parent.add(this),Rt(this,O,qe).call(this)),Rt(this,O,Ge).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,D(this,xt).disconnect(),Wt(this,xt,null),super.remove())}setParent(st){!this.parent&&st?this._uiManager.removeShouldRescale(this):this.parent&&st===null&&this._uiManager.addShouldRescale(this),super.setParent(st)}onScaleChanging(){const[st,St]=this.parentDimensions,It=this.width*st,jt=this.height*St;this.setDimensions(It,jt)}enableEditMode(){D(this,et)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",D(this,lt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",D(this,lt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){D(this,et)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Wt(this,et,!0),this.div.classList.add("disabled"),Rt(this,O,Ge).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(st){this._focusEventsAllowed&&(super.focusin(st),this.enableEditMode())}canvasPointerdown(st){st.button!==0||!this.isInEditMode()||D(this,et)||(this.setInForeground(),st.preventDefault(),st.type!=="mouse"&&this.div.focus(),Rt(this,O,Ei).call(this,st.offsetX,st.offsetY))}canvasPointermove(st){st.preventDefault(),Rt(this,O,qs).call(this,st.offsetX,st.offsetY)}canvasPointerup(st){st.preventDefault(),Rt(this,O,Gs).call(this,st)}canvasPointerleave(st){Rt(this,O,Gs).call(this,st)}get isResizable(){return!this.isEmpty()&&D(this,et)}render(){if(this.div)return this.div;let st,St;this.width&&(st=this.x,St=this.y),super.render(),U.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(oe=>this.div?.setAttribute("aria-label",oe));const[It,jt,Zt,re]=Rt(this,O,Si).call(this);if(this.setAt(It,jt,0,0),this.setDims(Zt,re),Rt(this,O,ds).call(this),this.width){const[oe,Ot]=this.parentDimensions;this.setAspectRatio(this.width*oe,this.height*Ot),this.setAt(st*oe,St*Ot,this.width*oe,this.height*Ot),Wt(this,it,!0),Rt(this,O,qe).call(this),this.setDims(this.width*oe,this.height*Ot),Rt(this,O,Be).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Rt(this,O,us).call(this),this.div}setDimensions(st,St){const It=Math.round(st),jt=Math.round(St);if(D(this,ot)===It&&D(this,Y)===jt)return;Wt(this,ot,It),Wt(this,Y,jt),this.canvas.style.visibility="hidden";const[Zt,re]=this.parentDimensions;this.width=st/Zt,this.height=St/re,this.fixAndSetPosition(),D(this,et)&&Rt(this,O,Vs).call(this,st,St),Rt(this,O,qe).call(this),Rt(this,O,Be).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(st,St,It){var we,ke,Fe;if(st instanceof yt.InkAnnotationElement)return null;const jt=super.deserialize(st,St,It);jt.thickness=st.thickness,jt.color=F.Util.makeHexColor(...st.color),jt.opacity=st.opacity;const[Zt,re]=jt.pageDimensions,oe=jt.width*Zt,Ot=jt.height*re,he=jt.parentScale,de=st.thickness/2;Wt(jt,et,!0),Wt(jt,ot,Math.round(oe)),Wt(jt,Y,Math.round(Ot));const{paths:Ce,rect:xe,rotation:Re}=st;for(let{bezier:le}of Ce){le=Rt(we=ae,_t,Mi).call(we,le,xe,Re);const Gt=[];jt.paths.push(Gt);let qt=he*(le[0]-de),me=he*(le[1]-de);for(let Te=2,wt=le.length;Te<wt;Te+=6){const ie=he*(le[Te]-de),ue=he*(le[Te+1]-de),ye=he*(le[Te+2]-de),ve=he*(le[Te+3]-de),ge=he*(le[Te+4]-de),ft=he*(le[Te+5]-de);Gt.push([[qt,me],[ie,ue],[ye,ve],[ge,ft]]),qt=ge,me=ft}const Me=Rt(this,_t,ki).call(this,Gt);jt.bezierPath2D.push(Me)}const be=Rt(ke=jt,O,Ys).call(ke);return Wt(jt,Z,Math.max(U.AnnotationEditor.MIN_SIZE,be[2]-be[0])),Wt(jt,ut,Math.max(U.AnnotationEditor.MIN_SIZE,be[3]-be[1])),Rt(Fe=jt,O,Vs).call(Fe,oe,Ot),jt}serialize(){if(this.isEmpty())return null;const st=this.getRect(0,0),St=U.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:F.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:Rt(this,O,Ri).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,st),pageIndex:this.pageIndex,rect:st,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};ut=new WeakMap,Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakMap,lt=new WeakMap,gt=new WeakMap,et=new WeakMap,Q=new WeakMap,it=new WeakMap,xt=new WeakMap,ot=new WeakMap,Y=new WeakMap,W=new WeakMap,O=new WeakSet,yi=function(st){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=st,Rt(this,O,Ge).call(this)},undo:()=>{this.thickness=St,Rt(this,O,Ge).call(this)},mustExec:!0,type:F.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ai=function(st){const St=this.color;this.addCommands({cmd:()=>{this.color=st,Rt(this,O,Be).call(this)},undo:()=>{this.color=St,Rt(this,O,Be).call(this)},mustExec:!0,type:F.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},vi=function(st){st/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=st,Rt(this,O,Be).call(this)},undo:()=>{this.opacity=St,Rt(this,O,Be).call(this)},mustExec:!0,type:F.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Si=function(){const{parentRotation:st,parentDimensions:[St,It]}=this;switch(st){case 90:return[0,It,It,St];case 180:return[St,It,St,It];case 270:return[St,0,It,St];default:return[0,0,St,It]}},zs=function(){const{ctx:st,color:St,opacity:It,thickness:jt,parentScale:Zt,scaleFactor:re}=this;st.lineWidth=jt*Zt/re,st.lineCap="round",st.lineJoin="round",st.miterLimit=10,st.strokeStyle=`${St}${(0,Yt.opacityToHex)(It)}`},Ei=function(st,St){this.canvas.addEventListener("contextmenu",dt.noContextMenu),this.canvas.addEventListener("pointerleave",D(this,Ct)),this.canvas.addEventListener("pointermove",D(this,bt)),this.canvas.addEventListener("pointerup",D(this,at)),this.canvas.removeEventListener("pointerdown",D(this,lt)),this.isEditing=!0,D(this,it)||(Wt(this,it,!0),Rt(this,O,qe).call(this),this.thickness||(this.thickness=ae._defaultThickness),this.color||(this.color=ae._defaultColor||U.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ae._defaultOpacity)),this.currentPath.push([st,St]),Wt(this,Q,!1),Rt(this,O,zs).call(this),Wt(this,W,()=>{Rt(this,O,Ci).call(this),D(this,W)&&window.requestAnimationFrame(D(this,W))}),window.requestAnimationFrame(D(this,W))},qs=function(st,St){const[It,jt]=this.currentPath.at(-1);if(this.currentPath.length>1&&st===It&&St===jt)return;const Zt=this.currentPath;let re=D(this,gt);if(Zt.push([st,St]),Wt(this,Q,!0),Zt.length<=2){re.moveTo(...Zt[0]),re.lineTo(st,St);return}Zt.length===3&&(Wt(this,gt,re=new Path2D),re.moveTo(...Zt[0])),Rt(this,O,Ti).call(this,re,...Zt.at(-3),...Zt.at(-2),st,St)},xi=function(){if(this.currentPath.length===0)return;const st=this.currentPath.at(-1);D(this,gt).lineTo(...st)},wi=function(st,St){Wt(this,W,null),st=Math.min(Math.max(st,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),Rt(this,O,qs).call(this,st,St),Rt(this,O,xi).call(this);let It;if(this.currentPath.length!==1)It=Rt(this,O,Pi).call(this);else{const Ot=[st,St];It=[[Ot,Ot.slice(),Ot.slice(),Ot]]}const jt=D(this,gt),Zt=this.currentPath;this.currentPath=[],Wt(this,gt,new Path2D);const re=()=>{this.allRawPaths.push(Zt),this.paths.push(It),this.bezierPath2D.push(jt),this.rebuild()},oe=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Rt(this,O,ds).call(this),Rt(this,O,us).call(this)),Rt(this,O,Ge).call(this))};this.addCommands({cmd:re,undo:oe,mustExec:!0})},Ci=function(){if(!D(this,Q))return;Wt(this,Q,!1);const st=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),It=St.map(re=>re[0]),jt=St.map(re=>re[1]);Math.min(...It)-st,Math.max(...It)+st,Math.min(...jt)-st,Math.max(...jt)+st;const{ctx:Zt}=this;Zt.save(),Zt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const re of this.bezierPath2D)Zt.stroke(re);Zt.stroke(D(this,gt)),Zt.restore()},Ti=function(st,St,It,jt,Zt,re,oe){const Ot=(St+jt)/2,he=(It+Zt)/2,de=(jt+re)/2,Ce=(Zt+oe)/2;st.bezierCurveTo(Ot+2*(jt-Ot)/3,he+2*(Zt-he)/3,de+2*(jt-de)/3,Ce+2*(Zt-Ce)/3,de,Ce)},Pi=function(){const st=this.currentPath;if(st.length<=2)return[[st[0],st[0],st.at(-1),st.at(-1)]];const St=[];let It,[jt,Zt]=st[0];for(It=1;It<st.length-2;It++){const[xe,Re]=st[It],[be,we]=st[It+1],ke=(xe+be)/2,Fe=(Re+we)/2,le=[jt+2*(xe-jt)/3,Zt+2*(Re-Zt)/3],Gt=[ke+2*(xe-ke)/3,Fe+2*(Re-Fe)/3];St.push([[jt,Zt],le,Gt,[ke,Fe]]),[jt,Zt]=[ke,Fe]}const[re,oe]=st[It],[Ot,he]=st[It+1],de=[jt+2*(re-jt)/3,Zt+2*(oe-Zt)/3],Ce=[Ot+2*(re-Ot)/3,he+2*(oe-he)/3];return St.push([[jt,Zt],de,Ce,[Ot,he]]),St},Be=function(){if(this.isEmpty()){Rt(this,O,ps).call(this);return}Rt(this,O,zs).call(this);const{canvas:st,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,st.width,st.height),Rt(this,O,ps).call(this);for(const It of this.bezierPath2D)St.stroke(It)},Gs=function(st){this.canvas.removeEventListener("pointerleave",D(this,Ct)),this.canvas.removeEventListener("pointermove",D(this,bt)),this.canvas.removeEventListener("pointerup",D(this,at)),this.canvas.addEventListener("pointerdown",D(this,lt)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",dt.noContextMenu)},10),Rt(this,O,wi).call(this,st.offsetX,st.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ds=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",U.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(st=>this.canvas?.setAttribute("aria-label",st)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},us=function(){Wt(this,xt,new ResizeObserver(st=>{const St=st[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),D(this,xt).observe(this.div)},qe=function(){if(!D(this,it))return;const[st,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*st),this.canvas.height=Math.ceil(this.height*St),Rt(this,O,ps).call(this)},Vs=function(st,St){const It=Rt(this,O,fs).call(this),jt=(st-It)/D(this,Z),Zt=(St-It)/D(this,ut);this.scaleFactor=Math.min(jt,Zt)},ps=function(){const st=Rt(this,O,fs).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+st,this.translationY*this.scaleFactor+st)},_t=new WeakSet,ki=function(st){const St=new Path2D;for(let It=0,jt=st.length;It<jt;It++){const[Zt,re,oe,Ot]=st[It];It===0&&St.moveTo(...Zt),St.bezierCurveTo(re[0],re[1],oe[0],oe[1],Ot[0],Ot[1])}return St},Xs=function(st,St,It){const[jt,Zt,re,oe]=St;switch(It){case 0:for(let Ot=0,he=st.length;Ot<he;Ot+=2)st[Ot]+=jt,st[Ot+1]=oe-st[Ot+1];break;case 90:for(let Ot=0,he=st.length;Ot<he;Ot+=2){const de=st[Ot];st[Ot]=st[Ot+1]+jt,st[Ot+1]=de+Zt}break;case 180:for(let Ot=0,he=st.length;Ot<he;Ot+=2)st[Ot]=re-st[Ot],st[Ot+1]+=Zt;break;case 270:for(let Ot=0,he=st.length;Ot<he;Ot+=2){const de=st[Ot];st[Ot]=re-st[Ot+1],st[Ot+1]=oe-de}break;default:throw new Error("Invalid rotation")}return st},Mi=function(st,St,It){const[jt,Zt,re,oe]=St;switch(It){case 0:for(let Ot=0,he=st.length;Ot<he;Ot+=2)st[Ot]-=jt,st[Ot+1]=oe-st[Ot+1];break;case 90:for(let Ot=0,he=st.length;Ot<he;Ot+=2){const de=st[Ot];st[Ot]=st[Ot+1]-Zt,st[Ot+1]=de-jt}break;case 180:for(let Ot=0,he=st.length;Ot<he;Ot+=2)st[Ot]=re-st[Ot],st[Ot+1]-=Zt;break;case 270:for(let Ot=0,he=st.length;Ot<he;Ot+=2){const de=st[Ot];st[Ot]=oe-st[Ot+1],st[Ot+1]=re-de}break;default:throw new Error("Invalid rotation")}return st},Ri=function(st,St,It,jt){var he,de;const Zt=[],re=this.thickness/2,oe=st*St+re,Ot=st*It+re;for(const Ce of this.paths){const xe=[],Re=[];for(let be=0,we=Ce.length;be<we;be++){const[ke,Fe,le,Gt]=Ce[be],qt=st*ke[0]+oe,me=st*ke[1]+Ot,Me=st*Fe[0]+oe,Te=st*Fe[1]+Ot,wt=st*le[0]+oe,ie=st*le[1]+Ot,ue=st*Gt[0]+oe,ye=st*Gt[1]+Ot;be===0&&(xe.push(qt,me),Re.push(qt,me)),xe.push(Me,Te,wt,ie,ue,ye),Re.push(Me,Te),be===we-1&&Re.push(ue,ye)}Zt.push({bezier:Rt(he=ae,_t,Xs).call(he,xe,jt,this.rotation),points:Rt(de=ae,_t,Xs).call(de,Re,jt,this.rotation)})}return Zt},Ys=function(){let st=1/0,St=-1/0,It=1/0,jt=-1/0;for(const Zt of this.paths)for(const[re,oe,Ot,he]of Zt){const de=F.Util.bezierBoundingBox(...re,...oe,...Ot,...he);st=Math.min(st,de[0]),It=Math.min(It,de[1]),St=Math.max(St,de[2]),jt=Math.max(jt,de[3])}return[st,It,St,jt]},fs=function(){return D(this,et)?Math.ceil(this.thickness*this.parentScale):0},Ge=function(st=!1){if(this.isEmpty())return;if(!D(this,et)){Rt(this,O,Be).call(this);return}const St=Rt(this,O,Ys).call(this),It=Rt(this,O,fs).call(this);Wt(this,Z,Math.max(U.AnnotationEditor.MIN_SIZE,St[2]-St[0])),Wt(this,ut,Math.max(U.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const jt=Math.ceil(It+D(this,Z)*this.scaleFactor),Zt=Math.ceil(It+D(this,ut)*this.scaleFactor),[re,oe]=this.parentDimensions;this.width=jt/re,this.height=Zt/oe,this.setAspectRatio(jt,Zt);const Ot=this.translationX,he=this.translationY;this.translationX=-St[0],this.translationY=-St[1],Rt(this,O,qe).call(this),Rt(this,O,Be).call(this),Wt(this,ot,jt),Wt(this,Y,Zt),this.setDims(jt,Zt);const de=st?It/this.scaleFactor/2:0;this.translate(Ot-this.translationX-de,he-this.translationY-de)},Ht(ae,_t),Oe(ae,"_defaultColor",null),Oe(ae,"_defaultOpacity",1),Oe(ae,"_defaultThickness",1),Oe(ae,"_type","ink");let At=ae;w.InkEditor=At},(rt,w,X)=>{var At,ut,Z,bt,Ct,at,lt,gt,et,Q,it,es,ss,gs,Ks,Fi,Di,Js,ms,Ii;Object.defineProperty(w,"__esModule",{value:!0}),w.StampEditor=void 0;var F=X(1),U=X(4),yt=X(6),dt=X(29);const pt=class pt extends U.AnnotationEditor{constructor(Lt){super({...Lt,name:"stampEditor"});Ht(this,it);Ht(this,At,null);Ht(this,ut,null);Ht(this,Z,null);Ht(this,bt,null);Ht(this,Ct,null);Ht(this,at,null);Ht(this,lt,null);Ht(this,gt,null);Ht(this,et,!1);Ht(this,Q,!1);Wt(this,bt,Lt.bitmapUrl),Wt(this,Ct,Lt.bitmapFile)}static initialize(Lt){U.AnnotationEditor.initialize(Lt)}static get supportedTypes(){const Lt=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,F.shadow)(this,"supportedTypes",Lt.map(Bt=>`image/${Bt}`))}static get supportedTypesStr(){return(0,F.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Lt){return this.supportedTypes.includes(Lt)}static paste(Lt,Bt){Bt.pasteEditor(F.AnnotationEditorType.STAMP,{bitmapFile:Lt.getAsFile()})}remove(){D(this,ut)&&(Wt(this,At,null),this._uiManager.imageManager.deleteId(D(this,ut)),D(this,at)?.remove(),Wt(this,at,null),D(this,lt)?.disconnect(),Wt(this,lt,null)),super.remove()}rebuild(){if(!this.parent){D(this,ut)&&Rt(this,it,gs).call(this);return}super.rebuild(),this.div!==null&&(D(this,ut)&&Rt(this,it,gs).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(D(this,Z)||D(this,At)||D(this,bt)||D(this,Ct))}get isResizable(){return!0}render(){if(this.div)return this.div;let Lt,Bt;if(this.width&&(Lt=this.x,Bt=this.y),super.render(),this.div.hidden=!0,D(this,At)?Rt(this,it,Ks).call(this):Rt(this,it,gs).call(this),this.width){const[Mt,Vt]=this.parentDimensions;this.setAt(Lt*Mt,Bt*Vt,this.width*Mt,this.height*Vt)}return this.div}static deserialize(Lt,Bt,Mt){if(Lt instanceof dt.StampAnnotationElement)return null;const Vt=super.deserialize(Lt,Bt,Mt),{rect:Et,bitmapUrl:Dt,bitmapId:Nt,isSvg:ht,accessibilityData:q}=Lt;Nt&&Mt.imageManager.isValidId(Nt)?Wt(Vt,ut,Nt):Wt(Vt,bt,Dt),Wt(Vt,et,ht);const[G,tt]=Vt.pageDimensions;return Vt.width=(Et[2]-Et[0])/G,Vt.height=(Et[3]-Et[1])/tt,q&&(Vt.altTextData=q),Vt}serialize(Lt=!1,Bt=null){if(this.isEmpty())return null;const Mt={annotationType:F.AnnotationEditorType.STAMP,bitmapId:D(this,ut),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:D(this,et),structTreeParentId:this._structTreeParentId};if(Lt)return Mt.bitmapUrl=Rt(this,it,ms).call(this,!0),Mt.accessibilityData=this.altTextData,Mt;const{decorative:Vt,altText:Et}=this.altTextData;if(!Vt&&Et&&(Mt.accessibilityData={type:"Figure",alt:Et}),Bt===null)return Mt;Bt.stamps||(Bt.stamps=new Map);const Dt=D(this,et)?(Mt.rect[2]-Mt.rect[0])*(Mt.rect[3]-Mt.rect[1]):null;if(!Bt.stamps.has(D(this,ut)))Bt.stamps.set(D(this,ut),{area:Dt,serialized:Mt}),Mt.bitmap=Rt(this,it,ms).call(this,!1);else if(D(this,et)){const Nt=Bt.stamps.get(D(this,ut));Dt>Nt.area&&(Nt.area=Dt,Nt.serialized.bitmap.close(),Nt.serialized.bitmap=Rt(this,it,ms).call(this,!1))}return Mt}};At=new WeakMap,ut=new WeakMap,Z=new WeakMap,bt=new WeakMap,Ct=new WeakMap,at=new WeakMap,lt=new WeakMap,gt=new WeakMap,et=new WeakMap,Q=new WeakMap,it=new WeakSet,es=function(Lt,Bt=!1){if(!Lt){this.remove();return}Wt(this,At,Lt.bitmap),Bt||(Wt(this,ut,Lt.id),Wt(this,et,Lt.isSvg)),Rt(this,it,Ks).call(this)},ss=function(){Wt(this,Z,null),this._uiManager.enableWaiting(!1),D(this,at)&&this.div.focus()},gs=function(){if(D(this,ut)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(D(this,ut)).then(Bt=>Rt(this,it,es).call(this,Bt,!0)).finally(()=>Rt(this,it,ss).call(this));return}if(D(this,bt)){const Bt=D(this,bt);Wt(this,bt,null),this._uiManager.enableWaiting(!0),Wt(this,Z,this._uiManager.imageManager.getFromUrl(Bt).then(Mt=>Rt(this,it,es).call(this,Mt)).finally(()=>Rt(this,it,ss).call(this)));return}if(D(this,Ct)){const Bt=D(this,Ct);Wt(this,Ct,null),this._uiManager.enableWaiting(!0),Wt(this,Z,this._uiManager.imageManager.getFromFile(Bt).then(Mt=>Rt(this,it,es).call(this,Mt)).finally(()=>Rt(this,it,ss).call(this)));return}const Lt=document.createElement("input");Lt.type="file",Lt.accept=pt.supportedTypesStr,Wt(this,Z,new Promise(Bt=>{Lt.addEventListener("change",async()=>{if(!Lt.files||Lt.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Mt=await this._uiManager.imageManager.getFromFile(Lt.files[0]);Rt(this,it,es).call(this,Mt)}Bt()}),Lt.addEventListener("cancel",()=>{this.remove(),Bt()})}).finally(()=>Rt(this,it,ss).call(this))),Lt.click()},Ks=function(){const{div:Lt}=this;let{width:Bt,height:Mt}=D(this,At);const[Vt,Et]=this.pageDimensions,Dt=.75;if(this.width)Bt=this.width*Vt,Mt=this.height*Et;else if(Bt>Dt*Vt||Mt>Dt*Et){const G=Math.min(Dt*Vt/Bt,Dt*Et/Mt);Bt*=G,Mt*=G}const[Nt,ht]=this.parentDimensions;this.setDims(Bt*Nt/Vt,Mt*ht/Et),this._uiManager.enableWaiting(!1);const q=Wt(this,at,document.createElement("canvas"));Lt.append(q),Lt.hidden=!1,Rt(this,it,Js).call(this,Bt,Mt),Rt(this,it,Ii).call(this),D(this,Q)||(this.parent.addUndoableEditor(this),Wt(this,Q,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Fi=function(Lt,Bt){const[Mt,Vt]=this.parentDimensions;this.width=Lt/Mt,this.height=Bt/Vt,this.setDims(Lt,Bt),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,D(this,gt)!==null&&clearTimeout(D(this,gt)),Wt(this,gt,setTimeout(()=>{Wt(this,gt,null),Rt(this,it,Js).call(this,Lt,Bt)},200))},Di=function(Lt,Bt){const{width:Mt,height:Vt}=D(this,At);let Et=Mt,Dt=Vt,Nt=D(this,At);for(;Et>2*Lt||Dt>2*Bt;){const ht=Et,q=Dt;Et>2*Lt&&(Et=Et>=16384?Math.floor(Et/2)-1:Math.ceil(Et/2)),Dt>2*Bt&&(Dt=Dt>=16384?Math.floor(Dt/2)-1:Math.ceil(Dt/2));const G=new OffscreenCanvas(Et,Dt);G.getContext("2d").drawImage(Nt,0,0,ht,q,0,0,Et,Dt),Nt=G.transferToImageBitmap()}return Nt},Js=function(Lt,Bt){Lt=Math.ceil(Lt),Bt=Math.ceil(Bt);const Mt=D(this,at);if(!Mt||Mt.width===Lt&&Mt.height===Bt)return;Mt.width=Lt,Mt.height=Bt;const Vt=D(this,et)?D(this,At):Rt(this,it,Di).call(this,Lt,Bt),Et=Mt.getContext("2d");Et.filter=this._uiManager.hcmFilter,Et.drawImage(Vt,0,0,Vt.width,Vt.height,0,0,Lt,Bt)},ms=function(Lt){if(Lt){if(D(this,et)){const Vt=this._uiManager.imageManager.getSvgUrl(D(this,ut));if(Vt)return Vt}const Bt=document.createElement("canvas");return{width:Bt.width,height:Bt.height}=D(this,At),Bt.getContext("2d").drawImage(D(this,At),0,0),Bt.toDataURL()}if(D(this,et)){const[Bt,Mt]=this.pageDimensions,Vt=Math.round(this.width*Bt*yt.PixelsPerInch.PDF_TO_CSS_UNITS),Et=Math.round(this.height*Mt*yt.PixelsPerInch.PDF_TO_CSS_UNITS),Dt=new OffscreenCanvas(Vt,Et);return Dt.getContext("2d").drawImage(D(this,At),0,0,D(this,At).width,D(this,At).height,0,0,Vt,Et),Dt.transferToImageBitmap()}return structuredClone(D(this,At))},Ii=function(){Wt(this,lt,new ResizeObserver(Lt=>{const Bt=Lt[0].contentRect;Bt.width&&Bt.height&&Rt(this,it,Fi).call(this,Bt.width,Bt.height)})),D(this,lt).observe(this.div)},Oe(pt,"_type","stamp");let Yt=pt;w.StampEditor=Yt}],__webpack_module_cache__={};function __w_pdfjs_require__(rt){var w=__webpack_module_cache__[rt];if(w!==void 0)return w.exports;var X=__webpack_module_cache__[rt]={exports:{}};return __webpack_modules__[rt](X,X.exports,__w_pdfjs_require__),X.exports}var __webpack_exports__={};return(()=>{var rt=__webpack_exports__;Object.defineProperty(rt,"__esModule",{value:!0}),Object.defineProperty(rt,"AbortException",{enumerable:!0,get:function(){return w.AbortException}}),Object.defineProperty(rt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return yt.AnnotationEditorLayer}}),Object.defineProperty(rt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return w.AnnotationEditorParamsType}}),Object.defineProperty(rt,"AnnotationEditorType",{enumerable:!0,get:function(){return w.AnnotationEditorType}}),Object.defineProperty(rt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return dt.AnnotationEditorUIManager}}),Object.defineProperty(rt,"AnnotationLayer",{enumerable:!0,get:function(){return Yt.AnnotationLayer}}),Object.defineProperty(rt,"AnnotationMode",{enumerable:!0,get:function(){return w.AnnotationMode}}),Object.defineProperty(rt,"CMapCompressionType",{enumerable:!0,get:function(){return w.CMapCompressionType}}),Object.defineProperty(rt,"DOMSVGFactory",{enumerable:!0,get:function(){return F.DOMSVGFactory}}),Object.defineProperty(rt,"FeatureTest",{enumerable:!0,get:function(){return w.FeatureTest}}),Object.defineProperty(rt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return At.GlobalWorkerOptions}}),Object.defineProperty(rt,"ImageKind",{enumerable:!0,get:function(){return w.ImageKind}}),Object.defineProperty(rt,"InvalidPDFException",{enumerable:!0,get:function(){return w.InvalidPDFException}}),Object.defineProperty(rt,"MissingPDFException",{enumerable:!0,get:function(){return w.MissingPDFException}}),Object.defineProperty(rt,"OPS",{enumerable:!0,get:function(){return w.OPS}}),Object.defineProperty(rt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return X.PDFDataRangeTransport}}),Object.defineProperty(rt,"PDFDateString",{enumerable:!0,get:function(){return F.PDFDateString}}),Object.defineProperty(rt,"PDFWorker",{enumerable:!0,get:function(){return X.PDFWorker}}),Object.defineProperty(rt,"PasswordResponses",{enumerable:!0,get:function(){return w.PasswordResponses}}),Object.defineProperty(rt,"PermissionFlag",{enumerable:!0,get:function(){return w.PermissionFlag}}),Object.defineProperty(rt,"PixelsPerInch",{enumerable:!0,get:function(){return F.PixelsPerInch}}),Object.defineProperty(rt,"PromiseCapability",{enumerable:!0,get:function(){return w.PromiseCapability}}),Object.defineProperty(rt,"RenderingCancelledException",{enumerable:!0,get:function(){return F.RenderingCancelledException}}),Object.defineProperty(rt,"SVGGraphics",{enumerable:!0,get:function(){return X.SVGGraphics}}),Object.defineProperty(rt,"UnexpectedResponseException",{enumerable:!0,get:function(){return w.UnexpectedResponseException}}),Object.defineProperty(rt,"Util",{enumerable:!0,get:function(){return w.Util}}),Object.defineProperty(rt,"VerbosityLevel",{enumerable:!0,get:function(){return w.VerbosityLevel}}),Object.defineProperty(rt,"XfaLayer",{enumerable:!0,get:function(){return ut.XfaLayer}}),Object.defineProperty(rt,"build",{enumerable:!0,get:function(){return X.build}}),Object.defineProperty(rt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return w.createValidAbsoluteUrl}}),Object.defineProperty(rt,"getDocument",{enumerable:!0,get:function(){return X.getDocument}}),Object.defineProperty(rt,"getFilenameFromUrl",{enumerable:!0,get:function(){return F.getFilenameFromUrl}}),Object.defineProperty(rt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return F.getPdfFilenameFromUrl}}),Object.defineProperty(rt,"getXfaPageViewport",{enumerable:!0,get:function(){return F.getXfaPageViewport}}),Object.defineProperty(rt,"isDataScheme",{enumerable:!0,get:function(){return F.isDataScheme}}),Object.defineProperty(rt,"isPdfFile",{enumerable:!0,get:function(){return F.isPdfFile}}),Object.defineProperty(rt,"loadScript",{enumerable:!0,get:function(){return F.loadScript}}),Object.defineProperty(rt,"noContextMenu",{enumerable:!0,get:function(){return F.noContextMenu}}),Object.defineProperty(rt,"normalizeUnicode",{enumerable:!0,get:function(){return w.normalizeUnicode}}),Object.defineProperty(rt,"renderTextLayer",{enumerable:!0,get:function(){return U.renderTextLayer}}),Object.defineProperty(rt,"setLayerDimensions",{enumerable:!0,get:function(){return F.setLayerDimensions}}),Object.defineProperty(rt,"shadow",{enumerable:!0,get:function(){return w.shadow}}),Object.defineProperty(rt,"updateTextLayer",{enumerable:!0,get:function(){return U.updateTextLayer}}),Object.defineProperty(rt,"version",{enumerable:!0,get:function(){return X.version}});var w=__w_pdfjs_require__(1),X=__w_pdfjs_require__(2),F=__w_pdfjs_require__(6),U=__w_pdfjs_require__(26),yt=__w_pdfjs_require__(27),dt=__w_pdfjs_require__(5),Yt=__w_pdfjs_require__(29),At=__w_pdfjs_require__(14),ut=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,__defProp$6=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc$6(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp$6(w,X,U),U};pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";let PdfViewer=class extends i{constructor(){super(...arguments),this.pdfUrl="",this.scale=1.5,this.numPages=0,this.loading=!0,this.error="",this.currentPage=1,this.renderingPages=new Set,this.renderTasks=new Map}async firstUpdated(){this.pdfUrl&&await this.loadPDF()}async updated(rt){rt.has("pdfUrl")&&this.pdfUrl&&await this.loadPDF(),rt.has("scale")&&this.pdf&&await this.rerenderVisiblePages()}async loadPDF(){this.loading=!0,this.error="";try{const rt=pdfExports.getDocument(this.pdfUrl);this.pdf=await rt.promise,this.numPages=this.pdf.numPages,this.loading=!1,await this.updateComplete,this.setupIntersectionObserver()}catch(rt){console.error("Error loading PDF:",rt),this.error="Failed to load PDF. Please try again.",this.loading=!1}}setupIntersectionObserver(){this.intersectionObserver&&this.intersectionObserver.disconnect(),this.intersectionObserver=new IntersectionObserver(w=>{w.forEach(X=>{if(X.isIntersecting){const F=parseInt(X.target.dataset.page||"0");F>0&&this.renderPage(F)}})},{root:this.shadowRoot?.querySelector(".pdf-container"),rootMargin:"500px",threshold:.01}),this.shadowRoot?.querySelectorAll(".page")?.forEach(w=>{this.intersectionObserver?.observe(w)})}async renderPage(rt){if(!this.pdf||this.renderingPages.has(rt))return;const w=this.renderTasks.get(rt);w&&(w.cancel(),this.renderTasks.delete(rt)),this.renderingPages.add(rt);try{const X=await this.pdf.getPage(rt),F=X.getViewport({scale:this.scale}),U=this.shadowRoot?.querySelector(`.page[data-page="${rt}"]`);if(!U)return;const yt=U.querySelector("canvas"),dt=U.querySelector(".textLayer");if(!yt||!dt)return;yt.width=F.width,yt.height=F.height;const Yt=yt.getContext("2d");if(Yt){const ut=X.render({canvasContext:Yt,viewport:F});this.renderTasks.set(rt,ut);try{await ut.promise}catch(Z){if(Z.name==="RenderingCancelledException")return;throw Z}}const At=await X.getTextContent();dt.innerHTML="",dt.style.width=F.width+"px",dt.style.height=F.height+"px",At.items.forEach(ut=>{if(ut.str){const Z=document.createElement("span");Z.textContent=ut.str;const bt=pdfExports.Util.transform(F.transform,ut.transform),Ct=Math.atan2(bt[1],bt[0]),at=Math.sqrt(bt[2]*bt[2]+bt[3]*bt[3]);Z.style.left=bt[4]+"px",Z.style.top=bt[5]-at+"px",Z.style.fontSize=at+"px",Z.style.fontFamily=ut.fontName||"sans-serif",Ct!==0&&(Z.style.transform=`rotate(${Ct}rad)`),dt.appendChild(Z)}}),dt.addEventListener("mouseup",()=>this.handleTextSelection(rt))}catch(X){console.error(`Error rendering page ${rt}:`,X)}finally{this.renderingPages.delete(rt),this.renderTasks.delete(rt)}}async rerenderVisiblePages(){this.renderTasks.forEach(w=>{w.cancel()}),this.renderTasks.clear(),this.renderingPages.clear(),this.shadowRoot?.querySelectorAll(".page")?.forEach(w=>{const X=parseInt(w.dataset.page||"0");X>0&&this.renderPage(X)})}handleTextSelection(rt){const X=window.getSelection()?.toString().trim();if(X){const F={text:X,page:rt};this.dispatchEvent(new CustomEvent("text-selected",{detail:F,bubbles:!0,composed:!0}))}}zoomIn(){this.scale=Math.min(this.scale+.25,3)}zoomOut(){this.scale=Math.max(this.scale-.25,.5)}resetZoom(){this.scale=1.5}goToPage(rt){if(rt<1||rt>this.numPages)return;const w=this.shadowRoot?.querySelector(`.page[data-page="${rt}"]`);w&&(w.scrollIntoView({behavior:"smooth",block:"start"}),this.currentPage=rt)}nextPage(){this.goToPage(this.currentPage+1)}prevPage(){this.goToPage(this.currentPage-1)}render(){return this.loading?x`<div class="loading">Loading PDF...</div>`:this.error?x`<div class="error">${this.error}</div>`:this.pdf?x`
      <div class="toolbar">
        <div class="toolbar-section">
          <button @click=${this.prevPage} ?disabled=${this.currentPage===1}>
            Previous
          </button>
          <span class="page-info">
            Page ${this.currentPage} / ${this.numPages}
          </span>
          <button @click=${this.nextPage} ?disabled=${this.currentPage===this.numPages}>
            Next
          </button>
        </div>

        <div class="toolbar-section">
          <button @click=${this.zoomOut} ?disabled=${this.scale<=.5}>
            Zoom Out
          </button>
          <span class="page-info">${Math.round(this.scale*100)}%</span>
          <button @click=${this.zoomIn} ?disabled=${this.scale>=3}>
            Zoom In
          </button>
          <button @click=${this.resetZoom}>
            Reset
          </button>
        </div>
      </div>

      <div class="pdf-container">
        <div class="pages">
          ${Array.from({length:this.numPages},(rt,w)=>w+1).map(rt=>x`
              <div class="page" data-page="${rt}">
                <canvas></canvas>
                <div class="textLayer"></div>
              </div>
            `)}
        </div>
      </div>
    `:x`<div class="loading">No PDF loaded</div>`}disconnectedCallback(){super.disconnectedCallback(),this.intersectionObserver&&this.intersectionObserver.disconnect()}};PdfViewer.styles=i$3`
    :host {
      display: flex;
      flex-direction: column;
      height: 100%;
      background: #525659;
    }

    .toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      background: #323639;
      color: white;
      border-bottom: 1px solid #000;
    }

    .toolbar-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .toolbar button {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .toolbar button:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .toolbar button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .page-info {
      font-size: 14px;
    }

    .pdf-container {
      flex: 1;
      overflow-y: auto;
      overflow-x: auto;
      padding: 20px;
    }

    .pages {
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      margin: 0 auto;
      width: fit-content;
      min-width: 100%;
    }

    .page {
      position: relative;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      background: white;
    }

    .page canvas {
      display: block;
    }

    .textLayer {
      position: absolute;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      opacity: 0.2;
      line-height: 1.0;
      user-select: text;
    }

    .textLayer > span {
      color: transparent;
      position: absolute;
      white-space: pre;
      cursor: text;
      transform-origin: 0% 0%;
    }

    .textLayer ::selection {
      background: rgba(26, 115, 232, 0.3);
    }

    .loading,
    .error {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: white;
      font-size: 16px;
    }

    .error {
      color: #ff6b6b;
    }

    .page-placeholder {
      width: 800px;
      height: 1100px;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255, 255, 255, 0.5);
    }
  `;__decorateClass$6([n({type:String})],PdfViewer.prototype,"pdfUrl",2);__decorateClass$6([n({type:Number})],PdfViewer.prototype,"scale",2);__decorateClass$6([r()],PdfViewer.prototype,"pdf",2);__decorateClass$6([r()],PdfViewer.prototype,"numPages",2);__decorateClass$6([r()],PdfViewer.prototype,"loading",2);__decorateClass$6([r()],PdfViewer.prototype,"error",2);__decorateClass$6([r()],PdfViewer.prototype,"currentPage",2);PdfViewer=__decorateClass$6([t("pdf-viewer")],PdfViewer);var __defProp$5=Object.defineProperty,__getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc$5(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp$5(w,X,U),U};let ConversationItem=class extends i{constructor(){super(...arguments),this.flagged=!1,this.expanded=!1}handleFlag(){this.dispatchEvent(new CustomEvent("flag-toggle",{detail:{exchangeId:this.assistantMessage.id},bubbles:!0,composed:!0}))}async handleCopy(){try{await navigator.clipboard.writeText(this.assistantMessage.content)}catch(rt){console.error("Failed to copy:",rt)}}formatTimestamp(rt){return new Date(rt).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}getModelName(rt){return rt?rt.includes("sonnet")?"Sonnet":rt.includes("haiku")?"Haiku":rt.includes("opus")?"Opus":"Claude":""}toggleExpand(){this.expanded=!this.expanded}renderUserQuery(){if(!this.userMessage)return"";const rt=this.userMessage.content,w=rt.split(`
`),X=w.length>1||rt.length>100;if(!X||this.expanded)return x`
        <div class="user-query user-query-full" @click=${this.toggleExpand}>
          ${rt}
        </div>
        ${X?x`
              <div class="expand-indicator" @click=${this.toggleExpand}>
                Click to collapse
              </div>
            `:""}
      `;const F=w[0],U=w.length>1?w[1]:rt.substring(F.length);return x`
      <div class="user-query user-query-preview" @click=${this.toggleExpand}>
        <span class="user-query-first-line">${F}</span>
        ${U?x`<span class="user-query-rest">${U}</span>`:""}
      </div>
      <div class="expand-indicator" @click=${this.toggleExpand}>
        Click to expand
      </div>
    `}render(){return!this.userMessage||!this.assistantMessage?x``:x`
      <div class="exchange">
        <div class="question-section">
          ${this.userMessage.highlighted_text?x`
                <div class="highlighted-text">
                  ${this.userMessage.highlighted_text}
                </div>
              `:""}
          <div class="question-label">Question:</div>
          ${this.renderUserQuery()}
          ${this.userMessage.page?x`
                <div class="page-indicator">Page ${this.userMessage.page}</div>
              `:""}
        </div>

        <div class="response-section">
          <div class="assistant-response">${this.assistantMessage.content}</div>

          <div class="message-footer">
            <div class="meta">
              ${this.assistantMessage.model?x`
                    <span class="model-badge">
                      ${this.getModelName(this.assistantMessage.model)}
                    </span>
                  `:""}
              <span class="timestamp">
                ${this.formatTimestamp(this.assistantMessage.timestamp)}
              </span>
            </div>
            <div class="actions">
              <button
                class="flag-btn ${this.flagged?"flagged":""}"
                @click=${this.handleFlag}
                title="${this.flagged?"Unflag":"Flag important"}"
              >
                ${this.flagged?"★":"☆"}
              </button>
              <button
                class="copy-btn"
                @click=${this.handleCopy}
                title="Copy response"
              >
                📋
              </button>
            </div>
          </div>
        </div>
      </div>
    `}};ConversationItem.styles=i$3`
    :host {
      display: block;
      margin-bottom: 16px;
    }

    .exchange {
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .question-section {
      background: #f5f0e6;
      padding: 12px;
      border-bottom: 1px solid #e8e0d0;
    }

    .question-label {
      font-weight: 700;
      color: #333;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .highlighted-text {
      background: rgba(255, 235, 59, 0.4);
      padding: 8px;
      border-radius: 4px;
      margin-bottom: 8px;
      font-size: 13px;
      color: #5d4e00;
      border-left: 3px solid #ffc107;
    }

    .highlighted-text::before {
      content: '"';
    }

    .highlighted-text::after {
      content: '"';
    }

    .user-query {
      color: #4a4a4a;
      font-weight: 500;
      font-size: 14px;
      line-height: 1.5;
    }

    .user-query-preview {
      cursor: pointer;
    }

    .user-query-first-line {
      display: block;
    }

    .user-query-rest {
      display: block;
      color: #6b7280;
      opacity: 0.6;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 400;
    }

    .user-query-full {
      white-space: pre-wrap;
    }

    .expand-indicator {
      font-size: 12px;
      color: #6b7280;
      margin-top: 4px;
      cursor: pointer;
    }

    .expand-indicator:hover {
      color: #1a73e8;
    }

    .page-indicator {
      color: #666;
      font-size: 12px;
      margin-top: 4px;
    }

    .response-section {
      padding: 12px;
    }

    .assistant-response {
      color: #333;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .message-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid #f0f0f0;
      font-size: 12px;
      color: #999;
    }

    .meta {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .model-badge {
      background: #ede9fe;
      color: #7c4dff;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 500;
    }

    .timestamp {
      color: #999;
    }

    .actions {
      display: flex;
      gap: 8px;
    }

    .flag-btn,
    .copy-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      padding: 4px;
      opacity: 0.6;
      transition: opacity 0.2s;
    }

    .flag-btn:hover,
    .copy-btn:hover {
      opacity: 1;
    }

    .flag-btn.flagged {
      opacity: 1;
      color: #f4b400;
    }

    .copy-btn {
      font-size: 14px;
    }
  `;__decorateClass$5([n({type:Object})],ConversationItem.prototype,"userMessage",2);__decorateClass$5([n({type:Object})],ConversationItem.prototype,"assistantMessage",2);__decorateClass$5([n({type:Boolean})],ConversationItem.prototype,"flagged",2);__decorateClass$5([r()],ConversationItem.prototype,"expanded",2);ConversationItem=__decorateClass$5([t("conversation-item")],ConversationItem);var __defProp$4=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc$4(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp$4(w,X,U),U};let QueryInput=class extends i{constructor(){super(...arguments),this.selectedText="",this.disabled=!1,this.loading=!1,this.queryText=""}handleClearSelection(){this.dispatchEvent(new CustomEvent("clear-selection",{bubbles:!0,composed:!0}))}handleSubmit(){const rt=this.queryText.trim();rt&&(this.dispatchEvent(new CustomEvent("submit-query",{detail:{query:rt,highlighted_text:this.selectedText||void 0,page:this.selectedPage},bubbles:!0,composed:!0})),this.queryText="",this.textarea&&(this.textarea.style.height="auto"))}handleKeyDown(rt){rt.key==="Enter"&&!rt.shiftKey&&(rt.preventDefault(),this.handleSubmit())}handleInput(rt){const w=rt.target;this.queryText=w.value,w.style.height="auto",w.style.height=w.scrollHeight+"px"}render(){const rt=this.queryText.length,w=rt>500;return x`
      ${this.selectedText?x`
            <div class="selected-text-preview">
              <div class="preview-content">
                <div class="preview-label">
                  Selected text${this.selectedPage?` (Page ${this.selectedPage})`:""}:
                </div>
                <div class="preview-text">"${this.selectedText}"</div>
              </div>
              <button
                class="clear-selection"
                @click=${this.handleClearSelection}
                title="Clear selection"
              >
                ×
              </button>
            </div>
          `:""}

      <div class="input-area">
        <textarea
          placeholder="Ask a question about the paper..."
          .value=${this.queryText}
          @input=${this.handleInput}
          @keydown=${this.handleKeyDown}
          ?disabled=${this.disabled||this.loading}
        ></textarea>
      </div>

      <div class="footer">
        <div class="hint">
          ${this.loading?"Thinking...":"Enter to send · Shift+Enter for new line"}
          ${rt>0?x`
                <span class="char-count ${w?"warning":""}">
                  · ${rt} chars
                </span>
              `:""}
        </div>
        <div class="actions">
          <button
            class="submit-btn"
            @click=${this.handleSubmit}
            ?disabled=${this.disabled||this.loading||!this.queryText.trim()}
          >
            ${this.loading?"Thinking...":"Ask"}
          </button>
        </div>
      </div>
    `}};QueryInput.styles=i$3`
    :host {
      display: block;
      background: white;
      border-top: 1px solid #e0e0e0;
      padding: 16px;
    }

    .selected-text-preview {
      background: rgba(255, 235, 59, 0.4);
      border: 1px solid #ffc107;
      border-radius: 4px;
      padding: 8px 12px;
      margin-bottom: 12px;
      font-size: 13px;
      color: #5d4e00;
      display: flex;
      justify-content: space-between;
      align-items: start;
      gap: 8px;
    }

    .preview-content {
      flex: 1;
      line-height: 1.4;
    }

    .preview-label {
      font-weight: 500;
      margin-bottom: 4px;
    }

    .preview-text {
      font-style: italic;
      max-height: 60px;
      overflow-y: auto;
    }

    .clear-selection {
      background: none;
      border: none;
      color: #5d4e00;
      cursor: pointer;
      font-size: 18px;
      padding: 0;
      opacity: 0.6;
      line-height: 1;
    }

    .clear-selection:hover {
      opacity: 1;
    }

    .input-area {
      position: relative;
    }

    textarea {
      width: 100%;
      min-height: 80px;
      max-height: 200px;
      padding: 12px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      box-sizing: border-box;
    }

    textarea:focus {
      outline: none;
      border-color: #1a73e8;
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.1);
    }

    textarea:disabled {
      background: #f5f5f5;
      cursor: not-allowed;
    }

    .footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    .hint {
      font-size: 12px;
      color: #999;
    }

    .actions {
      display: flex;
      gap: 8px;
    }

    .submit-btn {
      padding: 8px 20px;
      background: #1a73e8;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .submit-btn:hover:not(:disabled) {
      background: #1557b0;
    }

    .submit-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .model-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: #666;
    }

    .model-toggle input {
      cursor: pointer;
    }

    .char-count {
      font-size: 12px;
      color: #999;
    }

    .char-count.warning {
      color: #f4b400;
    }
  `;__decorateClass$4([n({type:String})],QueryInput.prototype,"selectedText",2);__decorateClass$4([n({type:Number})],QueryInput.prototype,"selectedPage",2);__decorateClass$4([n({type:Boolean})],QueryInput.prototype,"disabled",2);__decorateClass$4([n({type:Boolean})],QueryInput.prototype,"loading",2);__decorateClass$4([r()],QueryInput.prototype,"queryText",2);__decorateClass$4([e("textarea")],QueryInput.prototype,"textarea",2);QueryInput=__decorateClass$4([t("query-input")],QueryInput);var __defProp$3=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc$3(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp$3(w,X,U),U};let LoadingSpinner=class extends i{constructor(){super(...arguments),this.message="Loading...",this.size="medium",this.light=!1}render(){return x`
      <div class="spinner ${this.size}"></div>
      ${this.message?x`<div class="message ${this.light?"light":""}">${this.message}</div>`:""}
    `}};LoadingSpinner.styles=i$3`
    :host {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    .spinner {
      border: 3px solid rgba(26, 115, 232, 0.1);
      border-top-color: #1a73e8;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    .spinner.small {
      width: 20px;
      height: 20px;
      border-width: 2px;
    }

    .spinner.medium {
      width: 32px;
      height: 32px;
      border-width: 3px;
    }

    .spinner.large {
      width: 48px;
      height: 48px;
      border-width: 4px;
    }

    .message {
      color: #666;
      font-size: 14px;
    }

    .message.light {
      color: white;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  `;__decorateClass$3([n({type:String})],LoadingSpinner.prototype,"message",2);__decorateClass$3([n({type:String})],LoadingSpinner.prototype,"size",2);__decorateClass$3([n({type:Boolean})],LoadingSpinner.prototype,"light",2);LoadingSpinner=__decorateClass$3([t("loading-spinner")],LoadingSpinner);var __defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc$2(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp$2(w,X,U),U};let ErrorMessage=class extends i{constructor(){super(...arguments),this.message="An error occurred",this.dismissible=!1}handleDismiss(){this.dispatchEvent(new CustomEvent("dismiss",{bubbles:!0,composed:!0}))}render(){return x`
      <div class="error">
        <div class="icon">⚠️</div>
        <div class="content">${this.message}</div>
        ${this.dismissible?x`<button class="dismiss" @click=${this.handleDismiss}>×</button>`:""}
      </div>
    `}};ErrorMessage.styles=i$3`
    :host {
      display: block;
    }

    .error {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 6px;
      padding: 12px 16px;
      color: #991b1b;
      font-size: 14px;
      line-height: 1.5;
      display: flex;
      align-items: start;
      gap: 12px;
    }

    .icon {
      flex-shrink: 0;
      font-size: 18px;
    }

    .content {
      flex: 1;
    }

    .dismiss {
      background: none;
      border: none;
      color: #991b1b;
      cursor: pointer;
      font-size: 20px;
      padding: 0;
      line-height: 1;
      opacity: 0.6;
    }

    .dismiss:hover {
      opacity: 1;
    }
  `;__decorateClass$2([n({type:String})],ErrorMessage.prototype,"message",2);__decorateClass$2([n({type:Boolean})],ErrorMessage.prototype,"dismissible",2);ErrorMessage=__decorateClass$2([t("error-message")],ErrorMessage);var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc$1(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp$1(w,X,U),U};let AskTab=class extends i{constructor(){super(...arguments),this.sessionId="",this.conversation=[],this.flags=[],this.selectedText="",this.loading=!1,this.error=""}async handleSubmitQuery(rt){if(this.sessionId){this.loading=!0,this.error="";try{const w=await api.query(this.sessionId,rt.detail),X={id:w.exchange_id,role:"user",content:rt.detail.query,highlighted_text:rt.detail.highlighted_text,page:rt.detail.page,timestamp:new Date().toISOString()},F={id:w.exchange_id+1,role:"assistant",content:w.response,model:w.model_used,timestamp:new Date().toISOString()};this.conversation=[...this.conversation,X,F],this.dispatchEvent(new CustomEvent("conversation-updated",{detail:{conversation:this.conversation},bubbles:!0,composed:!0})),await this.updateComplete,this.scrollToBottom()}catch(w){w instanceof ApiError?this.error=w.message:this.error="Failed to send query. Please try again.",console.error("Query error:",w)}finally{this.loading=!1}}}async handleFlagToggle(rt){if(!this.sessionId)return;const{exchangeId:w}=rt.detail,X=this.flags.includes(w);try{X?(await api.unflag(this.sessionId,w),this.flags=this.flags.filter(F=>F!==w)):(await api.toggleFlag(this.sessionId,w),this.flags=[...this.flags,w]),this.dispatchEvent(new CustomEvent("flags-updated",{detail:{flags:this.flags},bubbles:!0,composed:!0})),this.requestUpdate()}catch(F){console.error("Flag toggle error:",F)}}handleClearSelection(){this.dispatchEvent(new CustomEvent("clear-selection",{bubbles:!0,composed:!0}))}scrollToBottom(){this.conversationContainer&&(this.conversationContainer.scrollTop=this.conversationContainer.scrollHeight)}renderConversation(){const rt=this.conversation.slice(2);if(rt.length===0)return x`
        <div class="empty-state">
          <h3>No questions yet</h3>
          <p>
            Type a question below, or select text in the PDF to ask about specific passages.
          </p>
        </div>
      `;const w=[];for(let X=0;X<rt.length;X+=2){const F=rt[X],U=rt[X+1];F&&U&&F.role==="user"&&U.role==="assistant"&&w.push({user:F,assistant:U})}return w.map(X=>x`
        <conversation-item
          .userMessage=${X.user}
          .assistantMessage=${X.assistant}
          .flagged=${this.flags.includes(X.assistant.id)}
          @flag-toggle=${this.handleFlagToggle}
        ></conversation-item>
      `)}renderInitialAnalysis(){const rt=this.conversation.find(yt=>yt.id===1&&yt.role==="assistant");if(!rt)return"";let w="Critical Review: 5-Bullet Summary",X=rt.content;const F=X.match(/^#\s*(.+?)[\r\n]/);F&&(w=F[1].trim(),X=X.substring(F[0].length).trim());const U=this.formatAnalysisContent(X);return x`
      <div class="initial-analysis">
        <div class="initial-analysis-title">${w}</div>
        <div class="initial-analysis-content">${U}</div>
      </div>
    `}formatAnalysisContent(rt){const w=rt.split(`
`),X=[];for(let F=0;F<w.length;F++){const U=w[F],yt=U.match(/^(•?\s*)\*\*([^*]+)\*\*(:.*)?$/),dt=U.match(/^(•?\s*)([A-Z][A-Za-z\s]+)(:)(.*)$/);if(yt){const[,Yt,At,ut]=yt;X.push(x`${Yt}<span class="section-header">${At}</span>${ut||""}`)}else if(dt&&dt[2].length<30){const[,Yt,At,ut,Z]=dt;X.push(x`${Yt}<span class="section-header">${At}</span>${ut}${Z}`)}else X.push(U);F<w.length-1&&X.push(`
`)}return X}render(){return this.sessionId?x`
      <div class="conversation-container">
        ${this.renderInitialAnalysis()} ${this.renderConversation()}
        ${this.loading?x`
              <div class="loading-overlay">
                <loading-spinner message="Thinking..."></loading-spinner>
              </div>
            `:""}
        ${this.error?x`
              <div class="error-container">
                <error-message
                  .message=${this.error}
                  dismissible
                  @dismiss=${()=>this.error=""}
                ></error-message>
              </div>
            `:""}
      </div>

      <query-input
        .selectedText=${this.selectedText}
        .selectedPage=${this.selectedPage}
        .loading=${this.loading}
        @submit-query=${this.handleSubmitQuery}
        @clear-selection=${this.handleClearSelection}
      ></query-input>
    `:x`
        <div class="empty-state">
          <h3>No paper loaded</h3>
          <p>Upload a PDF to start asking questions.</p>
        </div>
      `}};AskTab.styles=i$3`
    :host {
      display: flex;
      flex-direction: column;
      height: 100%;
      background: #f8f9fa;
    }

    .conversation-container {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px;
      text-align: center;
      color: #666;
    }

    .empty-state h3 {
      margin: 0 0 8px 0;
      font-size: 16px;
      color: #333;
    }

    .empty-state p {
      margin: 0;
      font-size: 14px;
      line-height: 1.5;
    }

    .initial-analysis {
      background: white;
      border: 1px solid #9e9e9e;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .initial-analysis-title {
      font-weight: 700;
      color: #333;
      margin-bottom: 12px;
      font-size: 15px;
    }

    .initial-analysis-content {
      color: #444;
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .initial-analysis-content .section-header {
      font-weight: 700;
      color: #333;
    }

    .error-container {
      padding: 16px;
    }

    .loading-overlay {
      display: flex;
      justify-content: center;
      padding: 20px;
    }

    query-input {
      flex-shrink: 0;
    }
  `;__decorateClass$1([n({type:String})],AskTab.prototype,"sessionId",2);__decorateClass$1([n({type:Array})],AskTab.prototype,"conversation",2);__decorateClass$1([n({type:Array})],AskTab.prototype,"flags",2);__decorateClass$1([n({type:String})],AskTab.prototype,"selectedText",2);__decorateClass$1([n({type:Number})],AskTab.prototype,"selectedPage",2);__decorateClass$1([r()],AskTab.prototype,"loading",2);__decorateClass$1([r()],AskTab.prototype,"error",2);__decorateClass$1([e(".conversation-container")],AskTab.prototype,"conversationContainer",2);AskTab=__decorateClass$1([t("ask-tab")],AskTab);var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(rt,w,X,F)=>{for(var U=F>1?void 0:F?__getOwnPropDesc(w,X):w,yt=rt.length-1,dt;yt>=0;yt--)(dt=rt[yt])&&(U=(F?dt(w,X,U):dt(U))||U);return F&&U&&__defProp(w,X,U),U};let AppRoot=class extends i{constructor(){super(...arguments),this.sessionId="",this.filename="",this.pdfUrl="",this.conversation=[],this.flags=[],this.selectedText="",this.loading=!1,this.error=""}async handleFileUpload(rt){const w=rt.target,X=w.files?.[0];if(!X||X.type!=="application/pdf"){this.error="Please select a valid PDF file";return}this.loading=!0,this.error="";try{const F=await api.createSession(X);this.sessionId=F.session_id,this.filename=F.filename,this.pdfUrl=URL.createObjectURL(X),this.conversation=[{id:0,role:"user",content:"Initial analysis",timestamp:F.created_at},{id:1,role:"assistant",content:F.initial_analysis,timestamp:F.created_at}],this.loading=!1}catch(F){console.error("Upload error:",F),F instanceof ApiError?this.error=F.message:this.error="Failed to upload PDF. Please try again.",this.loading=!1}w.value=""}handleTextSelection(rt){const{text:w,page:X}=rt.detail;this.selectedText=w,this.selectedPage=X}handleClearSelection(){this.selectedText="",this.selectedPage=void 0}renderEmptyState(){return x`
      <div class="empty-state">
        <h2>Paper Companion</h2>
        <p>
          Upload a PDF to get started.
        </p>
        <label class="upload-btn">
          Upload PDF
          <input type="file" accept=".pdf" @change=${this.handleFileUpload} />
        </label>
      </div>
    `}renderLoadingScreen(){return x`
      <div class="loading-screen">
        <loading-spinner
          size="large"
          message="Analyzing paper..."
          light
        ></loading-spinner>
      </div>
    `}renderErrorScreen(){return x`
      <div class="error-screen">
        <error-message .message=${this.error}></error-message>
        <label class="upload-btn">
          Try Again
          <input type="file" accept=".pdf" @change=${this.handleFileUpload} />
        </label>
      </div>
    `}render(){return x`
      <div class="left-panel">
        <div class="panel-header">
          <h1>Paper Companion</h1>
          ${this.filename?x`<p class="filename" title="${this.filename}">${this.filename}</p>`:""}
        </div>

        <ask-tab
          .sessionId=${this.sessionId}
          .conversation=${this.conversation}
          .flags=${this.flags}
          .selectedText=${this.selectedText}
          .selectedPage=${this.selectedPage}
          @conversation-updated=${rt=>this.conversation=rt.detail.conversation}
          @flags-updated=${rt=>this.flags=rt.detail.flags}
          @clear-selection=${this.handleClearSelection}
        ></ask-tab>
      </div>

      <div class="center-pane">
        ${this.loading?this.renderLoadingScreen():this.error?this.renderErrorScreen():this.pdfUrl?x`
              <pdf-viewer
                .pdfUrl=${this.pdfUrl}
                @text-selected=${this.handleTextSelection}
              ></pdf-viewer>
            `:this.renderEmptyState()}
      </div>
    `}};AppRoot.styles=i$3`
    :host {
      display: flex;
      height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    .left-panel {
      width: 450px;
      min-width: 450px;
      flex-shrink: 0;
      border-right: 1px solid #e0e0e0;
      display: flex;
      flex-direction: column;
      background: #f8f9fa;
    }

    .panel-header {
      padding: 16px;
      background: white;
      border-bottom: 1px solid #e0e0e0;
      flex-shrink: 0;
    }

    .panel-header h1 {
      margin: 0 0 4px 0;
      font-size: 18px;
      color: #333;
    }

    .panel-header .filename {
      margin: 0;
      font-size: 13px;
      color: #666;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .center-pane {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: #525659;
      color: white;
      padding: 40px;
      text-align: center;
    }

    .empty-state h2 {
      margin: 0 0 16px 0;
      font-size: 32px;
    }

    .empty-state p {
      margin: 0 0 32px 0;
      color: rgba(255, 255, 255, 0.8);
      font-size: 16px;
      max-width: 400px;
    }

    .upload-btn {
      padding: 14px 28px;
      background: #1a73e8;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: background 0.2s;
    }

    .upload-btn:hover {
      background: #1557b0;
    }

    input[type='file'] {
      display: none;
    }

    .loading-screen {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: #525659;
    }

    .error-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: #525659;
      padding: 40px;
    }

    .error-screen error-message {
      max-width: 500px;
      margin-bottom: 20px;
    }

    ask-tab {
      flex: 1;
      min-height: 0;
    }
  `;__decorateClass([r()],AppRoot.prototype,"sessionId",2);__decorateClass([r()],AppRoot.prototype,"filename",2);__decorateClass([r()],AppRoot.prototype,"pdfUrl",2);__decorateClass([r()],AppRoot.prototype,"conversation",2);__decorateClass([r()],AppRoot.prototype,"flags",2);__decorateClass([r()],AppRoot.prototype,"selectedText",2);__decorateClass([r()],AppRoot.prototype,"selectedPage",2);__decorateClass([r()],AppRoot.prototype,"loading",2);__decorateClass([r()],AppRoot.prototype,"error",2);AppRoot=__decorateClass([t("app-root")],AppRoot);
